<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="2339px" preserveAspectRatio="none" style="width:1681px;height:2339px;background:#FFFFFF;" version="1.1" viewBox="0 0 1681 2339" width="1681px" zoomAndPan="magnify"><defs><filter height="300%" id="fvup0qrx275hf" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#F5F5F5" height="2327.3281" style="stroke:#A80036;stroke-width:1.0;" width="461" x="221.5" y="6"/><text fill="#000000" font-family="sans-serif" font-size="18" font-weight="bold" lengthAdjust="spacing" textLength="93" x="405.5" y="22.708">Endgerät</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="0" x="454.5" y="39.02"/><rect fill="#F5F5F5" height="2327.3281" style="stroke:#A80036;stroke-width:1.0;" width="682" x="914.5" y="6"/><text fill="#000000" font-family="sans-serif" font-size="18" font-weight="bold" lengthAdjust="spacing" textLength="200" x="1153" y="22.708">VZD-FHIR-Directory</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="0" x="1358" y="23.8872"/><rect fill="#DCDCDC" filter="url(#fvup0qrx275hf)" height="1882.8906" style="stroke:#000000;stroke-width:1.0;" width="10" x="329.5" y="323.875"/><rect fill="#DCDCDC" filter="url(#fvup0qrx275hf)" height="291.3125" style="stroke:#000000;stroke-width:1.0;" width="10" x="564.5" y="768.3125"/><rect fill="#DCDCDC" filter="url(#fvup0qrx275hf)" height="350.1016" style="stroke:#000000;stroke-width:1.0;" width="10" x="793.5" y="768.3125"/><rect fill="#DCDCDC" filter="url(#fvup0qrx275hf)" height="33.7891" style="stroke:#000000;stroke-width:1.0;" width="10" x="793.5" y="1230.7813"/><rect fill="#DCDCDC" filter="url(#fvup0qrx275hf)" height="214.7344" style="stroke:#000000;stroke-width:1.0;" width="10" x="1022.5" y="1574.9297"/><rect fill="#DCDCDC" filter="url(#fvup0qrx275hf)" height="239.7344" style="stroke:#000000;stroke-width:1.0;" width="10" x="1022.5" y="1868.2422"/><rect fill="#DCDCDC" filter="url(#fvup0qrx275hf)" height="798.3594" style="stroke:#000000;stroke-width:1.0;" width="10" x="1250.5" y="613.3672"/><rect fill="#DCDCDC" filter="url(#fvup0qrx275hf)" height="80.5781" style="stroke:#000000;stroke-width:1.0;" width="10" x="1478.5" y="1675.2969"/><rect fill="#DCDCDC" filter="url(#fvup0qrx275hf)" height="80.5781" style="stroke:#000000;stroke-width:1.0;" width="10" x="1478.5" y="1993.6094"/><rect fill="#F0F8FF" filter="url(#fvup0qrx275hf)" height="994.4844" style="stroke:#000000;stroke-width:2.0;" width="1428.5" x="10" y="450.2422"/><rect fill="#FFFFFF" filter="url(#fvup0qrx275hf)" height="691.0391" style="stroke:#000000;stroke-width:2.0;" width="1657.5" x="10" y="1483.7266"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="116" x2="116" y1="134.9297" y2="2216.7656"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="334.5" x2="334.5" y1="134.9297" y2="2216.7656"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="569.5" x2="569.5" y1="134.9297" y2="2216.7656"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="798.5" x2="798.5" y1="134.9297" y2="2216.7656"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1027.5" x2="1027.5" y1="134.9297" y2="2216.7656"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1255.5" x2="1255.5" y1="134.9297" y2="2216.7656"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1483.5" x2="1483.5" y1="134.9297" y2="2216.7656"/><text fill="#000000" font-family="Aapex" font-size="20" lengthAdjust="spacing" textLength="187" x="20" y="106.9316">Akteur in der Rolle</text><text fill="#000000" font-family="Aapex" font-size="20" lengthAdjust="spacing" textLength="110" x="58.5" y="130.2129">Org-Admin</text><ellipse cx="116.5" cy="31.3672" fill="#DCDCDC" filter="url(#fvup0qrx275hf)" rx="8" ry="8" style="stroke:#000000;stroke-width:2.0;"/><path d="M116.5,39.3672 L116.5,66.3672 M103.5,47.3672 L129.5,47.3672 M116.5,66.3672 L103.5,81.3672 M116.5,66.3672 L129.5,81.3672 " fill="none" filter="url(#fvup0qrx275hf)" style="stroke:#000000;stroke-width:2.0;"/><text fill="#000000" font-family="Aapex" font-size="20" lengthAdjust="spacing" textLength="187" x="20" y="2234.3301">Akteur in der Rolle</text><text fill="#000000" font-family="Aapex" font-size="20" lengthAdjust="spacing" textLength="110" x="58.5" y="2257.6113">Org-Admin</text><ellipse cx="116.5" cy="2272.3281" fill="#DCDCDC" filter="url(#fvup0qrx275hf)" rx="8" ry="8" style="stroke:#000000;stroke-width:2.0;"/><path d="M116.5,2280.3281 L116.5,2307.3281 M103.5,2288.3281 L129.5,2288.3281 M116.5,2307.3281 L103.5,2322.3281 M116.5,2307.3281 L129.5,2322.3281 " fill="none" filter="url(#fvup0qrx275hf)" style="stroke:#000000;stroke-width:2.0;"/><rect fill="#EFEFFF" filter="url(#fvup0qrx275hf)" height="83.8438" style="stroke:#000000;stroke-width:1.5;" width="214" x="225.5" y="46.0859"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="198" x="233.5" y="71.6504">TI-Messenger-Client</text><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="150" x="257.5" y="94.9316">mit Org-Admin</text><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="141" x="262" y="118.2129">Funktionalität</text><rect fill="#EFEFFF" filter="url(#fvup0qrx275hf)" height="83.8438" style="stroke:#000000;stroke-width:1.5;" width="214" x="225.5" y="2215.7656"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="198" x="233.5" y="2241.3301">TI-Messenger-Client</text><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="150" x="257.5" y="2264.6113">mit Org-Admin</text><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="141" x="262" y="2287.8926">Funktionalität</text><rect fill="#EFEFFF" filter="url(#fvup0qrx275hf)" height="60.5625" style="stroke:#000000;stroke-width:1.5;" width="214" x="460.5" y="69.3672"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="138" x="495.5" y="94.9316">Authenticator</text><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="145" x="495" y="118.2129">des IDP-Dienst</text><rect fill="#EFEFFF" filter="url(#fvup0qrx275hf)" height="60.5625" style="stroke:#000000;stroke-width:1.5;" width="214" x="460.5" y="2215.7656"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="138" x="495.5" y="2241.3301">Authenticator</text><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="145" x="495" y="2264.6113">des IDP-Dienst</text><rect fill="#EFEFFF" filter="url(#fvup0qrx275hf)" height="37.2813" style="stroke:#000000;stroke-width:1.5;" width="214" x="689.5" y="92.6484"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="104" x="744.5" y="118.2129">IDP-Dienst</text><rect fill="#EFEFFF" filter="url(#fvup0qrx275hf)" height="37.2813" style="stroke:#000000;stroke-width:1.5;" width="214" x="689.5" y="2215.7656"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="104" x="744.5" y="2241.3301">IDP-Dienst</text><rect fill="#EFEFFF" filter="url(#fvup0qrx275hf)" height="37.2813" style="stroke:#000000;stroke-width:1.5;" width="214" x="918.5" y="92.6484"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="108" x="971.5" y="118.2129">FHIR-Proxy</text><rect fill="#EFEFFF" filter="url(#fvup0qrx275hf)" height="37.2813" style="stroke:#000000;stroke-width:1.5;" width="214" x="918.5" y="2215.7656"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="108" x="971.5" y="2241.3301">FHIR-Proxy</text><rect fill="#EFEFFF" filter="url(#fvup0qrx275hf)" height="37.2813" style="stroke:#000000;stroke-width:1.5;" width="214" x="1146.5" y="92.6484"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="128" x="1189.5" y="118.2129">Auth-Service</text><rect fill="#EFEFFF" filter="url(#fvup0qrx275hf)" height="37.2813" style="stroke:#000000;stroke-width:1.5;" width="214" x="1146.5" y="2215.7656"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="128" x="1189.5" y="2241.3301">Auth-Service</text><rect fill="#EFEFFF" filter="url(#fvup0qrx275hf)" height="37.2813" style="stroke:#000000;stroke-width:1.5;" width="214" x="1374.5" y="92.6484"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="145" x="1409" y="118.2129">FHIR-Directory</text><rect fill="#EFEFFF" filter="url(#fvup0qrx275hf)" height="37.2813" style="stroke:#000000;stroke-width:1.5;" width="214" x="1374.5" y="2215.7656"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="145" x="1409" y="2241.3301">FHIR-Directory</text><rect fill="#DCDCDC" filter="url(#fvup0qrx275hf)" height="1882.8906" style="stroke:#000000;stroke-width:1.0;" width="10" x="329.5" y="323.875"/><rect fill="#DCDCDC" filter="url(#fvup0qrx275hf)" height="291.3125" style="stroke:#000000;stroke-width:1.0;" width="10" x="564.5" y="768.3125"/><rect fill="#DCDCDC" filter="url(#fvup0qrx275hf)" height="350.1016" style="stroke:#000000;stroke-width:1.0;" width="10" x="793.5" y="768.3125"/><rect fill="#DCDCDC" filter="url(#fvup0qrx275hf)" height="33.7891" style="stroke:#000000;stroke-width:1.0;" width="10" x="793.5" y="1230.7813"/><rect fill="#DCDCDC" filter="url(#fvup0qrx275hf)" height="214.7344" style="stroke:#000000;stroke-width:1.0;" width="10" x="1022.5" y="1574.9297"/><rect fill="#DCDCDC" filter="url(#fvup0qrx275hf)" height="239.7344" style="stroke:#000000;stroke-width:1.0;" width="10" x="1022.5" y="1868.2422"/><rect fill="#DCDCDC" filter="url(#fvup0qrx275hf)" height="798.3594" style="stroke:#000000;stroke-width:1.0;" width="10" x="1250.5" y="613.3672"/><rect fill="#DCDCDC" filter="url(#fvup0qrx275hf)" height="80.5781" style="stroke:#000000;stroke-width:1.0;" width="10" x="1478.5" y="1675.2969"/><rect fill="#DCDCDC" filter="url(#fvup0qrx275hf)" height="80.5781" style="stroke:#000000;stroke-width:1.0;" width="10" x="1478.5" y="1993.6094"/><path d="M16,174.9297 L16,223.9297 L898,223.9297 L898,184.9297 L888,174.9297 L16,174.9297 " fill="#FBFB77" filter="url(#fvup0qrx275hf)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M888,174.9297 L888,184.9297 L898,184.9297 L888,174.9297 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="607" x="144.75" y="195.7095">Die Organisation hat einen Messenger-Service bereitgestellt bekommen,</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="214" x="144.75" y="215.4985">der Teil der Föderation ist</text><polygon fill="#000000" points="317.5,319.875,327.5,323.875,317.5,327.875,321.5,323.875" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="116.5" x2="323.5" y1="323.875" y2="323.875"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="168" x="123.5" y="278.2876">FHIR Ressourcen im</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="166" x="123.5" y="298.0767">VZD-FHIR-Directory</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="160" x="123.5" y="317.8657">hinzufügen (MXID)</text><line style="stroke:#000000;stroke-width:1.0;" x1="339.5" x2="381.5" y1="397.2422" y2="397.2422"/><line style="stroke:#000000;stroke-width:1.0;" x1="381.5" x2="381.5" y1="397.2422" y2="410.2422"/><line style="stroke:#000000;stroke-width:1.0;" x1="340.5" x2="381.5" y1="410.2422" y2="410.2422"/><polygon fill="#000000" points="350.5,406.2422,340.5,410.2422,350.5,414.2422,346.5,410.2422" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="167" x="346.5" y="351.6548">Prüfung, ob gültiges</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="159" x="346.5" y="371.4438">owner-accesstoken</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="64" x="346.5" y="391.2329">vorliegt</text><path d="M10,450.2422 L74,450.2422 L74,457.2422 L64,467.2422 L10,467.2422 L10,450.2422 " fill="#D3D3D3" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="994.4844" style="stroke:#000000;stroke-width:2.0;" width="1428.5" x="10" y="450.2422"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="25" y="463.3091">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="89" y="468.2729">[</text><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="305" x="94" y="467.0938">kein gültigess owner-accesstoken</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="399" y="468.2729">]</text><line style="stroke:#000000;stroke-width:1.0;" x1="339.5" x2="381.5" y1="541.5781" y2="541.5781"/><line style="stroke:#000000;stroke-width:1.0;" x1="381.5" x2="381.5" y1="541.5781" y2="554.5781"/><line style="stroke:#000000;stroke-width:1.0;" x1="340.5" x2="381.5" y1="554.5781" y2="554.5781"/><polygon fill="#000000" points="350.5,550.5781,340.5,554.5781,350.5,558.5781,346.5,554.5781" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="164" x="346.5" y="515.7798">Erzeuge PKCE Code</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="211" x="346.5" y="535.5688">für verifier und challenge</text><polygon fill="#000000" points="1238.5,609.3672,1248.5,613.3672,1238.5,617.3672,1242.5,613.3672" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="339.5" x2="1244.5" y1="613.3672" y2="613.3672"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="211" x="346.5" y="607.3579">GET /owner-authenticate</text><polygon fill="#000000" points="350.5,662.9453,340.5,666.9453,350.5,670.9453,346.5,666.9453" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="344.5" x2="1249.5" y1="666.9453" y2="666.9453"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="115" x="1123.5" y="641.147">Redirct to IDP</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="193" x="1050.5" y="660.936">Authorization Endpoint</text><polygon fill="#000000" points="127.5,696.7344,117.5,700.7344,127.5,704.7344,123.5,700.7344" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="121.5" x2="328.5" y1="700.7344" y2="700.7344"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="189" x="133.5" y="694.7251">Liste verfügbarer IDP's</text><polygon fill="#000000" points="317.5,730.5234,327.5,734.5234,317.5,738.5234,321.5,734.5234" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="116.5" x2="323.5" y1="734.5234" y2="734.5234"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="155" x="123.5" y="728.5142">ausgewählterr IDP</text><polygon fill="#000000" points="781.5,764.3125,791.5,768.3125,781.5,772.3125,785.5,768.3125" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="339.5" x2="787.5" y1="768.3125" y2="768.3125"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="124" x="346.5" y="762.3032">GET /authorize</text><polygon fill="#000000" points="350.5,817.8906,340.5,821.8906,350.5,825.8906,346.5,821.8906" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="344.5" x2="792.5" y1="821.8906" y2="821.8906"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="124" x="657.5" y="796.0923">Authentication</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="80" x="706.5" y="815.8813">challenge</text><polygon fill="#000000" points="127.5,896.4688,117.5,900.4688,127.5,904.4688,123.5,900.4688" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="121.5" x2="563.5" y1="900.4688" y2="900.4688"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="141" x="411.5" y="874.6704">Aufforderung zur</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="146" x="411.5" y="894.4595">Authentifizierung</text><polygon fill="#000000" points="552.5,930.2578,562.5,934.2578,552.5,938.2578,556.5,934.2578" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="116.5" x2="558.5" y1="934.2578" y2="934.2578"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="132" x="123.5" y="928.2485">Eingabe tätigen</text><line style="stroke:#000000;stroke-width:1.0;" x1="574.5" x2="616.5" y1="993.0469" y2="993.0469"/><line style="stroke:#000000;stroke-width:1.0;" x1="616.5" x2="616.5" y1="993.0469" y2="1006.0469"/><line style="stroke:#000000;stroke-width:1.0;" x1="575.5" x2="616.5" y1="1006.0469" y2="1006.0469"/><polygon fill="#000000" points="585.5,1002.0469,575.5,1006.0469,585.5,1010.0469,581.5,1006.0469" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="124" x="581.5" y="987.0376">Authentication</text><polygon fill="#000000" points="781.5,1055.625,791.5,1059.625,781.5,1063.625,785.5,1059.625" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="569.5" x2="787.5" y1="1059.625" y2="1059.625"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="124" x="576.5" y="1033.8267">Authentication</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="159" x="576.5" y="1053.6157">challenge response</text><polygon fill="#000000" points="350.5,1114.4141,340.5,1118.4141,350.5,1122.4141,346.5,1118.4141" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="344.5" x2="797.5" y1="1118.4141" y2="1118.4141"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="405" x="386.5" y="1112.4048">Authorization Response with Authorization Code</text><polygon fill="#000000" points="1238.5,1173.2031,1248.5,1177.2031,1238.5,1181.2031,1242.5,1177.2031" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="339.5" x2="1244.5" y1="1177.2031" y2="1177.2031"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="415" x="346.5" y="1171.1938">GET /owner-authenticate with Authorization code</text><polygon fill="#000000" points="814.5,1226.7813,804.5,1230.7813,814.5,1234.7813,810.5,1230.7813" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="808.5" x2="1249.5" y1="1230.7813" y2="1230.7813"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="178" x="1065.5" y="1204.9829">POST /tokenEndpoint</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="169" x="1074.5" y="1224.772">(authorization code)</text><polygon fill="#000000" points="1238.5,1260.5703,1248.5,1264.5703,1238.5,1268.5703,1242.5,1264.5703" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="798.5" x2="1244.5" y1="1264.5703" y2="1264.5703"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="72" x="805.5" y="1258.561">id_token</text><line style="stroke:#000000;stroke-width:1.0;" x1="1260.5" x2="1302.5" y1="1298.3594" y2="1298.3594"/><line style="stroke:#000000;stroke-width:1.0;" x1="1302.5" x2="1302.5" y1="1298.3594" y2="1311.3594"/><line style="stroke:#000000;stroke-width:1.0;" x1="1261.5" x2="1302.5" y1="1311.3594" y2="1311.3594"/><polygon fill="#000000" points="1271.5,1307.3594,1261.5,1311.3594,1271.5,1315.3594,1267.5,1311.3594" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="121" x="1267.5" y="1292.3501">prüfe id_token</text><line style="stroke:#000000;stroke-width:1.0;" x1="1260.5" x2="1302.5" y1="1364.9375" y2="1364.9375"/><line style="stroke:#000000;stroke-width:1.0;" x1="1302.5" x2="1302.5" y1="1364.9375" y2="1377.9375"/><line style="stroke:#000000;stroke-width:1.0;" x1="1261.5" x2="1302.5" y1="1377.9375" y2="1377.9375"/><polygon fill="#000000" points="1271.5,1373.9375,1261.5,1377.9375,1271.5,1381.9375,1267.5,1377.9375" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="66" x="1267.5" y="1339.1392">erzeuge</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="159" x="1267.5" y="1358.9282">owner-accesstoken</text><polygon fill="#000000" points="350.5,1407.7266,340.5,1411.7266,350.5,1415.7266,346.5,1411.7266" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="344.5" x2="1254.5" y1="1411.7266" y2="1411.7266"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="159" x="1089.5" y="1405.7173">owner-accesstoken</text><path d="M10,1483.7266 L337,1483.7266 L337,1493.7266 L327,1503.7266 L10,1503.7266 L10,1483.7266 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="691.0391" style="stroke:#000000;stroke-width:2.0;" width="1657.5" x="10" y="1483.7266"/><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="282" x="25" y="1499.5781">FHIR-Directory Eintrag erstellen</text><polygon fill="#000000" points="1010.5,1570.9297,1020.5,1574.9297,1010.5,1578.9297,1014.5,1574.9297" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="339.5" x2="1016.5" y1="1574.9297" y2="1574.9297"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="513" x="346.5" y="1549.1313">GET /owner/TIHealthCareService?providedBy.id=telematikID</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="173" x="346.5" y="1568.9204">(owner-accesstoken)</text><line style="stroke:#000000;stroke-width:1.0;" x1="1032.5" x2="1074.5" y1="1628.5078" y2="1628.5078"/><line style="stroke:#000000;stroke-width:1.0;" x1="1074.5" x2="1074.5" y1="1628.5078" y2="1641.5078"/><line style="stroke:#000000;stroke-width:1.0;" x1="1033.5" x2="1074.5" y1="1641.5078" y2="1641.5078"/><polygon fill="#000000" points="1043.5,1637.5078,1033.5,1641.5078,1043.5,1645.5078,1039.5,1641.5078" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="44" x="1039.5" y="1602.7095">prüfe</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="159" x="1039.5" y="1622.4985">owner-accesstoken</text><polygon fill="#000000" points="1466.5,1671.2969,1476.5,1675.2969,1466.5,1679.2969,1470.5,1675.2969" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="1032.5" x2="1472.5" y1="1675.2969" y2="1675.2969"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="117" x="1039.5" y="1669.2876">HTTP Forward</text><line style="stroke:#000000;stroke-width:1.0;" x1="1488.5" x2="1530.5" y1="1709.0859" y2="1709.0859"/><line style="stroke:#000000;stroke-width:1.0;" x1="1530.5" x2="1530.5" y1="1709.0859" y2="1722.0859"/><line style="stroke:#000000;stroke-width:1.0;" x1="1489.5" x2="1530.5" y1="1722.0859" y2="1722.0859"/><polygon fill="#000000" points="1499.5,1718.0859,1489.5,1722.0859,1499.5,1726.0859,1495.5,1722.0859" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="114" x="1495.5" y="1703.0767">suche Eintrag</text><polygon fill="#000000" points="1043.5,1751.875,1033.5,1755.875,1043.5,1759.875,1039.5,1755.875" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1037.5" x2="1482.5" y1="1755.875" y2="1755.875"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="132" x="1344.5" y="1749.8657">result body json</text><polygon fill="#000000" points="350.5,1785.6641,340.5,1789.6641,350.5,1793.6641,346.5,1789.6641" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="344.5" x2="1026.5" y1="1789.6641" y2="1789.6641"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="117" x="903.5" y="1783.6548">HTTP Forward</text><polygon fill="#000000" points="1010.5,1864.2422,1020.5,1868.2422,1010.5,1872.2422,1014.5,1868.2422" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="339.5" x2="1016.5" y1="1868.2422" y2="1868.2422"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="463" x="346.5" y="1842.4438">PUT /owner/TIHealthCareService?telecom.value=MXID</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="173" x="346.5" y="1862.2329">(owner-accesstoken)</text><line style="stroke:#000000;stroke-width:1.0;" x1="1032.5" x2="1074.5" y1="1946.8203" y2="1946.8203"/><line style="stroke:#000000;stroke-width:1.0;" x1="1074.5" x2="1074.5" y1="1946.8203" y2="1959.8203"/><line style="stroke:#000000;stroke-width:1.0;" x1="1033.5" x2="1074.5" y1="1959.8203" y2="1959.8203"/><polygon fill="#000000" points="1043.5,1955.8203,1033.5,1959.8203,1043.5,1963.8203,1039.5,1959.8203" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="44" x="1039.5" y="1921.022">prüfe</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="159" x="1039.5" y="1940.811">owner-accesstoken</text><polygon fill="#000000" points="1466.5,1989.6094,1476.5,1993.6094,1466.5,1997.6094,1470.5,1993.6094" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="1032.5" x2="1472.5" y1="1993.6094" y2="1993.6094"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="117" x="1039.5" y="1987.6001">HTTP Forward</text><line style="stroke:#000000;stroke-width:1.0;" x1="1488.5" x2="1530.5" y1="2027.3984" y2="2027.3984"/><line style="stroke:#000000;stroke-width:1.0;" x1="1530.5" x2="1530.5" y1="2027.3984" y2="2040.3984"/><line style="stroke:#000000;stroke-width:1.0;" x1="1489.5" x2="1530.5" y1="2040.3984" y2="2040.3984"/><polygon fill="#000000" points="1499.5,2036.3984,1489.5,2040.3984,1499.5,2044.3984,1495.5,2040.3984" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="160" x="1495.5" y="2021.3892">Eintrag hinzufügen</text><polygon fill="#000000" points="1043.5,2070.1875,1033.5,2074.1875,1043.5,2078.1875,1039.5,2074.1875" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1037.5" x2="1482.5" y1="2074.1875" y2="2074.1875"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="132" x="1344.5" y="2068.1782">result body json</text><polygon fill="#000000" points="350.5,2103.9766,340.5,2107.9766,350.5,2111.9766,346.5,2107.9766" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="344.5" x2="1026.5" y1="2107.9766" y2="2107.9766"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="117" x="903.5" y="2101.9673">HTTP Forward</text><polygon fill="#000000" points="127.5,2137.7656,117.5,2141.7656,127.5,2145.7656,123.5,2141.7656" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="121.5" x2="328.5" y1="2141.7656" y2="2141.7656"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="54" x="268.5" y="2135.7563">Status</text><!--MD5=[0a74ce420e9a02fb8e1a71a41112b5d0]
@startuml
skinparam sequenceMessageAlign direction
skinparam minClassWidth 200
skinparam BoxPadding 1
skinparam sequenceReferenceHeaderBackgroundColor palegreen
scale max 2048 width

skinparam sequence {
ArrowColor black
ArrowFontSize 17
ActorBorderColor black
LifeLineBorderColor black
LifeLineBackgroundColor Gainsboro

ParticipantBorderColor Motivation
ParticipantBackgroundColor Motivation
ParticipantFontName Impact
ParticipantFontSize 20
ParticipantFontColor black
ParticipantBorderColor Black
ParticipantBackgroundColor MOTIVATION

ActorBackgroundColor Gainsboro
ActorFontColor black
ActorFontSize 20
ActorFontName Aapex
}
    actor U as "Akteur in der Rolle\nOrg-Admin"
    box <size:18>Endgerät</size>\n #WhiteSmoke 
    participant C as "TI-Messenger-Client\n mit Org-Admin \nFunktionalität"
    participant A as "Authenticator \ndes IDP-Dienst"
    end box
    participant I as "IDP-Dienst" 
    box <size:18>VZD-FHIR-Directory</size> #WhiteSmoke
      participant FP as "FHIR-Proxy"
      participant Auth as "Auth-Service"
      participant VZD as "FHIR-Directory"
    end box

|||
note over U, I: <size:17>Die Organisation hat einen Messenger-Service bereitgestellt bekommen, \n<size:17>der Teil der Föderation ist</size>
|||

U->C: FHIR Ressourcen im \nVZD-FHIR-Directory \nhinzufügen (MXID)
  Activate C
C->C: Prüfung, ob gültiges \nowner-accesstoken \nvorliegt

|||
alt#LightGrey #AliceBlue <size:16>kein gültigess owner-accesstoken</size>
|||

  C->C: Erzeuge PKCE Code \nfür verifier und challenge
  |||
  C->Auth: GET /owner-authenticate
    Activate Auth
  Auth- ->C: Redirct to IDP \nAuthorization Endpoint

  C->U: Liste verfügbarer IDP's
  U->C: ausgewählterr IDP
    
  C->I: GET /authorize
    Activate A
    Activate I
  I- ->C: Authentication \nchallenge
  |||
  A->U: Aufforderung zur \nAuthentifizierung
  U->A: Eingabe tätigen
  |||
  A->A: Authentication
  A->I: Authentication \nchallenge response
    Deactivate A
  |||
  I- ->C: Authorization Response with Authorization Code
    Deactivate I
      
  |||    
  C->Auth: GET /owner-authenticate with Authorization code
  Auth- ->I: POST /tokenEndpoint\n(authorization code)
    Activate I
  I- ->Auth: id_token
    Deactivate I
  Auth->Auth: prüfe id_token
  Auth->Auth: erzeuge \nowner-accesstoken
  Auth- ->C: owner-accesstoken
  ||| 
    
    Deactivate Auth
end
      
|||

group <size:16>FHIR-Directory Eintrag erstellen</size>
  |||
  C->FP: GET /owner/TIHealthCareService?providedBy.id=telematikID \n(owner-accesstoken)
    Activate FP
  FP->FP: prüfe \nowner-accesstoken
  FP->VZD: HTTP Forward
    Activate VZD
  VZD->VZD: suche Eintrag
  VZD- ->FP: result body json
    Deactivate VZD
  FP- ->C: HTTP Forward
    Deactivate FP
  |||
  C->FP: PUT /owner/TIHealthCareService?telecom.value=MXID \n(owner-accesstoken)
  |||
    Activate FP
  FP->FP: prüfe \nowner-accesstoken
  FP->VZD: HTTP Forward
    Activate VZD
  VZD->VZD: Eintrag hinzufügen
  VZD- ->FP: result body json
    Deactivate VZD
  FP- ->C: HTTP Forward
    Deactivate FP
  C- ->U: Status    
  |||
end
|||

  Deactivate C
@enduml

PlantUML version 1.2021.16(Wed Dec 08 17:25:22 UTC 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>