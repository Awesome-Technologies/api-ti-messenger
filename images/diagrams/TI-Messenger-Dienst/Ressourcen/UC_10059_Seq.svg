<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="2324px" preserveAspectRatio="none" style="width:1657px;height:2324px;background:#FFFFFF;" version="1.1" viewBox="0 0 1657 2324" width="1657px" zoomAndPan="magnify"><defs/><g><rect fill="#F5F5F5" height="2312.3281" style="stroke:#181818;stroke-width:0.5;" width="457" x="223.5" y="6"/><text fill="#000000" font-family="sans-serif" font-size="18" font-weight="bold" lengthAdjust="spacing" textLength="93" x="405.5" y="22.708">Endgerät</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="5" x="405.5" y="39.02"> </text><rect fill="#F5F5F5" height="2312.3281" style="stroke:#181818;stroke-width:0.5;" width="670" x="908.5" y="6"/><text fill="#000000" font-family="sans-serif" font-size="18" font-weight="bold" lengthAdjust="spacing" textLength="200" x="1141" y="22.708">VZD-FHIR-Directory</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="5" x="1341" y="23.8872"> </text><rect fill="#DCDCDC" height="1882.8906" style="stroke:#000000;stroke-width:1.0;" width="10" x="329.5" y="315.875"/><rect fill="#DCDCDC" height="291.3125" style="stroke:#000000;stroke-width:1.0;" width="10" x="564.5" y="760.3125"/><rect fill="#DCDCDC" height="350.1016" style="stroke:#000000;stroke-width:1.0;" width="10" x="789.5" y="760.3125"/><rect fill="#DCDCDC" height="33.7891" style="stroke:#000000;stroke-width:1.0;" width="10" x="789.5" y="1222.7813"/><rect fill="#DCDCDC" height="214.7344" style="stroke:#000000;stroke-width:1.0;" width="10" x="1014.5" y="1566.9297"/><rect fill="#DCDCDC" height="239.7344" style="stroke:#000000;stroke-width:1.0;" width="10" x="1014.5" y="1860.2422"/><rect fill="#DCDCDC" height="798.3594" style="stroke:#000000;stroke-width:1.0;" width="10" x="1238.5" y="605.3672"/><rect fill="#DCDCDC" height="80.5781" style="stroke:#000000;stroke-width:1.0;" width="10" x="1462.5" y="1667.2969"/><rect fill="#DCDCDC" height="80.5781" style="stroke:#000000;stroke-width:1.0;" width="10" x="1462.5" y="1985.6094"/><rect fill="#F0F8FF" height="994.4844" style="stroke:#000000;stroke-width:1.5;" width="1416.5" x="10" y="442.2422"/><rect height="691.0391" style="stroke:#000000;stroke-width:1.5;fill:none;" width="1641.5" x="10" y="1475.7266"/><line style="stroke:#000000;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="116" x2="116" y1="130.9297" y2="2208.7656"/><line style="stroke:#000000;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="334.5" x2="334.5" y1="130.9297" y2="2208.7656"/><line style="stroke:#000000;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="569.5" x2="569.5" y1="130.9297" y2="2208.7656"/><line style="stroke:#000000;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="794.5" x2="794.5" y1="130.9297" y2="2208.7656"/><line style="stroke:#000000;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="1019.5" x2="1019.5" y1="130.9297" y2="2208.7656"/><line style="stroke:#000000;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="1243.5" x2="1243.5" y1="130.9297" y2="2208.7656"/><line style="stroke:#000000;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="1467.5" x2="1467.5" y1="130.9297" y2="2208.7656"/><text fill="#000000" font-family="Aapex" font-size="20" lengthAdjust="spacing" textLength="187" x="20" y="102.9316">Akteur in der Rolle</text><text fill="#000000" font-family="Aapex" font-size="20" lengthAdjust="spacing" textLength="110" x="58.5" y="126.2129">Org-Admin</text><ellipse cx="116.5" cy="32.8672" fill="#DCDCDC" rx="8" ry="8" style="stroke:#000000;stroke-width:0.5;"/><path d="M116.5,40.8672 L116.5,67.8672 M103.5,48.8672 L129.5,48.8672 M116.5,67.8672 L103.5,82.8672 M116.5,67.8672 L129.5,82.8672 " fill="none" style="stroke:#000000;stroke-width:0.5;"/><text fill="#000000" font-family="Aapex" font-size="20" lengthAdjust="spacing" textLength="187" x="20" y="2226.3301">Akteur in der Rolle</text><text fill="#000000" font-family="Aapex" font-size="20" lengthAdjust="spacing" textLength="110" x="58.5" y="2249.6113">Org-Admin</text><ellipse cx="116.5" cy="2262.8281" fill="#DCDCDC" rx="8" ry="8" style="stroke:#000000;stroke-width:0.5;"/><path d="M116.5,2270.8281 L116.5,2297.8281 M103.5,2278.8281 L129.5,2278.8281 M116.5,2297.8281 L103.5,2312.8281 M116.5,2297.8281 L129.5,2312.8281 " fill="none" style="stroke:#000000;stroke-width:0.5;"/><rect fill="#EFEFFF" height="83.8438" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="214" x="227.5" y="46.0859"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="198" x="235.5" y="71.6504">TI-Messenger-Client</text><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="150" x="259.5" y="94.9316">mit Org-Admin</text><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="141" x="264" y="118.2129">Funktionalität</text><rect fill="#EFEFFF" height="83.8438" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="214" x="227.5" y="2207.7656"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="198" x="235.5" y="2233.3301">TI-Messenger-Client</text><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="150" x="259.5" y="2256.6113">mit Org-Admin</text><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="141" x="264" y="2279.8926">Funktionalität</text><rect fill="#EFEFFF" height="60.5625" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="214" x="462.5" y="69.3672"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="138" x="497.5" y="94.9316">Authenticator</text><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="145" x="497" y="118.2129">des IDP-Dienst</text><rect fill="#EFEFFF" height="60.5625" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="214" x="462.5" y="2207.7656"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="138" x="497.5" y="2233.3301">Authenticator</text><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="145" x="497" y="2256.6113">des IDP-Dienst</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="214" x="687.5" y="92.6484"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="104" x="742.5" y="118.2129">IDP-Dienst</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="214" x="687.5" y="2207.7656"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="104" x="742.5" y="2233.3301">IDP-Dienst</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="214" x="912.5" y="92.6484"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="108" x="965.5" y="118.2129">FHIR-Proxy</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="214" x="912.5" y="2207.7656"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="108" x="965.5" y="2233.3301">FHIR-Proxy</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="214" x="1136.5" y="92.6484"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="128" x="1179.5" y="118.2129">Auth-Service</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="214" x="1136.5" y="2207.7656"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="128" x="1179.5" y="2233.3301">Auth-Service</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="214" x="1360.5" y="92.6484"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="145" x="1395" y="118.2129">FHIR-Directory</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="214" x="1360.5" y="2207.7656"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="145" x="1395" y="2233.3301">FHIR-Directory</text><rect fill="#DCDCDC" height="1882.8906" style="stroke:#000000;stroke-width:1.0;" width="10" x="329.5" y="315.875"/><rect fill="#DCDCDC" height="291.3125" style="stroke:#000000;stroke-width:1.0;" width="10" x="564.5" y="760.3125"/><rect fill="#DCDCDC" height="350.1016" style="stroke:#000000;stroke-width:1.0;" width="10" x="789.5" y="760.3125"/><rect fill="#DCDCDC" height="33.7891" style="stroke:#000000;stroke-width:1.0;" width="10" x="789.5" y="1222.7813"/><rect fill="#DCDCDC" height="214.7344" style="stroke:#000000;stroke-width:1.0;" width="10" x="1014.5" y="1566.9297"/><rect fill="#DCDCDC" height="239.7344" style="stroke:#000000;stroke-width:1.0;" width="10" x="1014.5" y="1860.2422"/><rect fill="#DCDCDC" height="798.3594" style="stroke:#000000;stroke-width:1.0;" width="10" x="1238.5" y="605.3672"/><rect fill="#DCDCDC" height="80.5781" style="stroke:#000000;stroke-width:1.0;" width="10" x="1462.5" y="1667.2969"/><rect fill="#DCDCDC" height="80.5781" style="stroke:#000000;stroke-width:1.0;" width="10" x="1462.5" y="1985.6094"/><path d="M17,170.9297 L17,219.9297 L893,219.9297 L893,180.9297 L883,170.9297 L17,170.9297 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M883,170.9297 L883,180.9297 L893,180.9297 L883,170.9297 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="607" x="144.75" y="191.7095">Die Organisation hat einen Messenger-Service bereitgestellt bekommen,</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="214" x="144.75" y="211.4985">der Teil der Föderation ist</text><polygon fill="#000000" points="317.5,311.875,327.5,315.875,317.5,319.875,321.5,315.875" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="116.5" x2="323.5" y1="315.875" y2="315.875"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="168" x="123.5" y="270.2876">FHIR Ressourcen im</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="166" x="123.5" y="290.0767">VZD-FHIR-Directory</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="160" x="123.5" y="309.8657">hinzufügen (MXID)</text><line style="stroke:#000000;stroke-width:1.0;" x1="339.5" x2="381.5" y1="389.2422" y2="389.2422"/><line style="stroke:#000000;stroke-width:1.0;" x1="381.5" x2="381.5" y1="389.2422" y2="402.2422"/><line style="stroke:#000000;stroke-width:1.0;" x1="340.5" x2="381.5" y1="402.2422" y2="402.2422"/><polygon fill="#000000" points="350.5,398.2422,340.5,402.2422,350.5,406.2422,346.5,402.2422" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="167" x="346.5" y="343.6548">Prüfung, ob gültiges</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="159" x="346.5" y="363.4438">owner-accesstoken</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="64" x="346.5" y="383.2329">vorliegt</text><path d="M10,442.2422 L74,442.2422 L74,449.375 L64,459.375 L10,459.375 L10,442.2422 " fill="#D3D3D3" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="994.4844" style="stroke:#000000;stroke-width:1.5;" width="1416.5" x="10" y="442.2422"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="25" y="455.3091">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="89" y="460.2729">[</text><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="305" x="94" y="459.0938">kein gültigess owner-accesstoken</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="399" y="460.2729">]</text><line style="stroke:#000000;stroke-width:1.0;" x1="339.5" x2="381.5" y1="533.5781" y2="533.5781"/><line style="stroke:#000000;stroke-width:1.0;" x1="381.5" x2="381.5" y1="533.5781" y2="546.5781"/><line style="stroke:#000000;stroke-width:1.0;" x1="340.5" x2="381.5" y1="546.5781" y2="546.5781"/><polygon fill="#000000" points="350.5,542.5781,340.5,546.5781,350.5,550.5781,346.5,546.5781" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="164" x="346.5" y="507.7798">Erzeuge PKCE Code</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="211" x="346.5" y="527.5688">für verifier und challenge</text><polygon fill="#000000" points="1226.5,601.3672,1236.5,605.3672,1226.5,609.3672,1230.5,605.3672" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="339.5" x2="1232.5" y1="605.3672" y2="605.3672"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="211" x="346.5" y="599.3579">GET /owner-authenticate</text><polygon fill="#000000" points="350.5,654.9453,340.5,658.9453,350.5,662.9453,346.5,658.9453" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="344.5" x2="1237.5" y1="658.9453" y2="658.9453"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="115" x="1038.5" y="633.147">Redirct to IDP</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="193" x="1038.5" y="652.936">Authorization Endpoint</text><polygon fill="#000000" points="127.5,688.7344,117.5,692.7344,127.5,696.7344,123.5,692.7344" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="121.5" x2="328.5" y1="692.7344" y2="692.7344"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="189" x="133.5" y="686.7251">Liste verfügbarer IDP's</text><polygon fill="#000000" points="317.5,722.5234,327.5,726.5234,317.5,730.5234,321.5,726.5234" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="116.5" x2="323.5" y1="726.5234" y2="726.5234"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="155" x="123.5" y="720.5142">ausgewählterr IDP</text><polygon fill="#000000" points="777.5,756.3125,787.5,760.3125,777.5,764.3125,781.5,760.3125" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="339.5" x2="783.5" y1="760.3125" y2="760.3125"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="124" x="346.5" y="754.3032">GET /authorize</text><polygon fill="#000000" points="350.5,809.8906,340.5,813.8906,350.5,817.8906,346.5,813.8906" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="344.5" x2="788.5" y1="813.8906" y2="813.8906"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="124" x="653.5" y="788.0923">Authentication</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="80" x="653.5" y="807.8813">challenge</text><polygon fill="#000000" points="127.5,888.4688,117.5,892.4688,127.5,896.4688,123.5,892.4688" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="121.5" x2="563.5" y1="892.4688" y2="892.4688"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="141" x="411.5" y="866.6704">Aufforderung zur</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="146" x="411.5" y="886.4595">Authentifizierung</text><polygon fill="#000000" points="552.5,922.2578,562.5,926.2578,552.5,930.2578,556.5,926.2578" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="116.5" x2="558.5" y1="926.2578" y2="926.2578"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="132" x="123.5" y="920.2485">Eingabe tätigen</text><line style="stroke:#000000;stroke-width:1.0;" x1="574.5" x2="616.5" y1="985.0469" y2="985.0469"/><line style="stroke:#000000;stroke-width:1.0;" x1="616.5" x2="616.5" y1="985.0469" y2="998.0469"/><line style="stroke:#000000;stroke-width:1.0;" x1="575.5" x2="616.5" y1="998.0469" y2="998.0469"/><polygon fill="#000000" points="585.5,994.0469,575.5,998.0469,585.5,1002.0469,581.5,998.0469" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="124" x="581.5" y="979.0376">Authentication</text><polygon fill="#000000" points="777.5,1047.625,787.5,1051.625,777.5,1055.625,781.5,1051.625" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="569.5" x2="783.5" y1="1051.625" y2="1051.625"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="124" x="576.5" y="1025.8267">Authentication</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="159" x="576.5" y="1045.6157">challenge response</text><polygon fill="#000000" points="350.5,1106.4141,340.5,1110.4141,350.5,1114.4141,346.5,1110.4141" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="344.5" x2="793.5" y1="1110.4141" y2="1110.4141"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="405" x="382.5" y="1104.4048">Authorization Response with Authorization Code</text><polygon fill="#000000" points="1226.5,1165.2031,1236.5,1169.2031,1226.5,1173.2031,1230.5,1169.2031" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="339.5" x2="1232.5" y1="1169.2031" y2="1169.2031"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="415" x="346.5" y="1163.1938">GET /owner-authenticate with Authorization code</text><polygon fill="#000000" points="810.5,1218.7813,800.5,1222.7813,810.5,1226.7813,806.5,1222.7813" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="804.5" x2="1237.5" y1="1222.7813" y2="1222.7813"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="178" x="1053.5" y="1196.9829">POST /tokenEndpoint</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="169" x="1053.5" y="1216.772">(authorization code)</text><polygon fill="#000000" points="1226.5,1252.5703,1236.5,1256.5703,1226.5,1260.5703,1230.5,1256.5703" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="794.5" x2="1232.5" y1="1256.5703" y2="1256.5703"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="72" x="801.5" y="1250.561">id_token</text><line style="stroke:#000000;stroke-width:1.0;" x1="1248.5" x2="1290.5" y1="1290.3594" y2="1290.3594"/><line style="stroke:#000000;stroke-width:1.0;" x1="1290.5" x2="1290.5" y1="1290.3594" y2="1303.3594"/><line style="stroke:#000000;stroke-width:1.0;" x1="1249.5" x2="1290.5" y1="1303.3594" y2="1303.3594"/><polygon fill="#000000" points="1259.5,1299.3594,1249.5,1303.3594,1259.5,1307.3594,1255.5,1303.3594" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="121" x="1255.5" y="1284.3501">prüfe id_token</text><line style="stroke:#000000;stroke-width:1.0;" x1="1248.5" x2="1290.5" y1="1356.9375" y2="1356.9375"/><line style="stroke:#000000;stroke-width:1.0;" x1="1290.5" x2="1290.5" y1="1356.9375" y2="1369.9375"/><line style="stroke:#000000;stroke-width:1.0;" x1="1249.5" x2="1290.5" y1="1369.9375" y2="1369.9375"/><polygon fill="#000000" points="1259.5,1365.9375,1249.5,1369.9375,1259.5,1373.9375,1255.5,1369.9375" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="66" x="1255.5" y="1331.1392">erzeuge</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="159" x="1255.5" y="1350.9282">owner-accesstoken</text><polygon fill="#000000" points="350.5,1399.7266,340.5,1403.7266,350.5,1407.7266,346.5,1403.7266" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="344.5" x2="1242.5" y1="1403.7266" y2="1403.7266"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="159" x="1077.5" y="1397.7173">owner-accesstoken</text><path d="M10,1475.7266 L337,1475.7266 L337,1486.3516 L327,1496.3516 L10,1496.3516 L10,1475.7266 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="691.0391" style="stroke:#000000;stroke-width:1.5;" width="1641.5" x="10" y="1475.7266"/><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="282" x="25" y="1491.5781">FHIR-Directory Eintrag erstellen</text><polygon fill="#000000" points="1002.5,1562.9297,1012.5,1566.9297,1002.5,1570.9297,1006.5,1566.9297" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="339.5" x2="1008.5" y1="1566.9297" y2="1566.9297"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="513" x="346.5" y="1541.1313">GET /owner/TIHealthCareService?providedBy.id=telematikID</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="173" x="346.5" y="1560.9204">(owner-accesstoken)</text><line style="stroke:#000000;stroke-width:1.0;" x1="1024.5" x2="1066.5" y1="1620.5078" y2="1620.5078"/><line style="stroke:#000000;stroke-width:1.0;" x1="1066.5" x2="1066.5" y1="1620.5078" y2="1633.5078"/><line style="stroke:#000000;stroke-width:1.0;" x1="1025.5" x2="1066.5" y1="1633.5078" y2="1633.5078"/><polygon fill="#000000" points="1035.5,1629.5078,1025.5,1633.5078,1035.5,1637.5078,1031.5,1633.5078" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="44" x="1031.5" y="1594.7095">prüfe</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="159" x="1031.5" y="1614.4985">owner-accesstoken</text><polygon fill="#000000" points="1450.5,1663.2969,1460.5,1667.2969,1450.5,1671.2969,1454.5,1667.2969" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="1024.5" x2="1456.5" y1="1667.2969" y2="1667.2969"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="117" x="1031.5" y="1661.2876">HTTP Forward</text><line style="stroke:#000000;stroke-width:1.0;" x1="1472.5" x2="1514.5" y1="1701.0859" y2="1701.0859"/><line style="stroke:#000000;stroke-width:1.0;" x1="1514.5" x2="1514.5" y1="1701.0859" y2="1714.0859"/><line style="stroke:#000000;stroke-width:1.0;" x1="1473.5" x2="1514.5" y1="1714.0859" y2="1714.0859"/><polygon fill="#000000" points="1483.5,1710.0859,1473.5,1714.0859,1483.5,1718.0859,1479.5,1714.0859" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="114" x="1479.5" y="1695.0767">suche Eintrag</text><polygon fill="#000000" points="1035.5,1743.875,1025.5,1747.875,1035.5,1751.875,1031.5,1747.875" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1029.5" x2="1466.5" y1="1747.875" y2="1747.875"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="132" x="1328.5" y="1741.8657">result body json</text><polygon fill="#000000" points="350.5,1777.6641,340.5,1781.6641,350.5,1785.6641,346.5,1781.6641" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="344.5" x2="1018.5" y1="1781.6641" y2="1781.6641"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="117" x="895.5" y="1775.6548">HTTP Forward</text><polygon fill="#000000" points="1002.5,1856.2422,1012.5,1860.2422,1002.5,1864.2422,1006.5,1860.2422" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="339.5" x2="1008.5" y1="1860.2422" y2="1860.2422"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="463" x="346.5" y="1834.4438">PUT /owner/TIHealthCareService?telecom.value=MXID</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="173" x="346.5" y="1854.2329">(owner-accesstoken)</text><line style="stroke:#000000;stroke-width:1.0;" x1="1024.5" x2="1066.5" y1="1938.8203" y2="1938.8203"/><line style="stroke:#000000;stroke-width:1.0;" x1="1066.5" x2="1066.5" y1="1938.8203" y2="1951.8203"/><line style="stroke:#000000;stroke-width:1.0;" x1="1025.5" x2="1066.5" y1="1951.8203" y2="1951.8203"/><polygon fill="#000000" points="1035.5,1947.8203,1025.5,1951.8203,1035.5,1955.8203,1031.5,1951.8203" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="44" x="1031.5" y="1913.022">prüfe</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="159" x="1031.5" y="1932.811">owner-accesstoken</text><polygon fill="#000000" points="1450.5,1981.6094,1460.5,1985.6094,1450.5,1989.6094,1454.5,1985.6094" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="1024.5" x2="1456.5" y1="1985.6094" y2="1985.6094"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="117" x="1031.5" y="1979.6001">HTTP Forward</text><line style="stroke:#000000;stroke-width:1.0;" x1="1472.5" x2="1514.5" y1="2019.3984" y2="2019.3984"/><line style="stroke:#000000;stroke-width:1.0;" x1="1514.5" x2="1514.5" y1="2019.3984" y2="2032.3984"/><line style="stroke:#000000;stroke-width:1.0;" x1="1473.5" x2="1514.5" y1="2032.3984" y2="2032.3984"/><polygon fill="#000000" points="1483.5,2028.3984,1473.5,2032.3984,1483.5,2036.3984,1479.5,2032.3984" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="160" x="1479.5" y="2013.3892">Eintrag hinzufügen</text><polygon fill="#000000" points="1035.5,2062.1875,1025.5,2066.1875,1035.5,2070.1875,1031.5,2066.1875" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1029.5" x2="1466.5" y1="2066.1875" y2="2066.1875"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="132" x="1328.5" y="2060.1782">result body json</text><polygon fill="#000000" points="350.5,2095.9766,340.5,2099.9766,350.5,2103.9766,346.5,2099.9766" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="344.5" x2="1018.5" y1="2099.9766" y2="2099.9766"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="117" x="895.5" y="2093.9673">HTTP Forward</text><polygon fill="#000000" points="127.5,2129.7656,117.5,2133.7656,127.5,2137.7656,123.5,2133.7656" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="121.5" x2="328.5" y1="2133.7656" y2="2133.7656"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="54" x="268.5" y="2127.7563">Status</text><!--MD5=[9bf2e0f62ead9f9030850a08146851aa]
@startuml
skinparam sequenceMessageAlign direction
skinparam minClassWidth 200
skinparam BoxPadding 1
skinparam sequenceReferenceHeaderBackgroundColor palegreen
scale max 2048 width

skinparam sequence {
ArrowColor black
ArrowFontSize 17
ActorBorderColor black
LifeLineBorderColor black
LifeLineBackgroundColor Gainsboro

ParticipantBorderColor Motivation
ParticipantBackgroundColor Motivation
ParticipantFontName Impact
ParticipantFontSize 20
ParticipantFontColor black
ParticipantBorderColor Black
ParticipantBackgroundColor MOTIVATION

ActorBackgroundColor Gainsboro
ActorFontColor black
ActorFontSize 20
ActorFontName Aapex
}
    actor U as "Akteur in der Rolle\nOrg-Admin"
    box <size:18>Endgerät</size>\n #WhiteSmoke 
    participant C as "TI-Messenger-Client\n mit Org-Admin \nFunktionalität"
    participant A as "Authenticator \ndes IDP-Dienst"
    end box
    participant I as "IDP-Dienst" 
    box <size:18>VZD-FHIR-Directory</size> #WhiteSmoke
      participant FP as "FHIR-Proxy"
      participant Auth as "Auth-Service"
      participant VZD as "FHIR-Directory"
    end box

|||
note over U, I: <size:17>Die Organisation hat einen Messenger-Service bereitgestellt bekommen, \n<size:17>der Teil der Föderation ist</size>
|||

U->C: FHIR Ressourcen im \nVZD-FHIR-Directory \nhinzufügen (MXID)
  Activate C
C->C: Prüfung, ob gültiges \nowner-accesstoken \nvorliegt

|||
alt#LightGrey #AliceBlue <size:16>kein gültigess owner-accesstoken</size>
|||

  C->C: Erzeuge PKCE Code \nfür verifier und challenge
  |||
  C->Auth: GET /owner-authenticate
    Activate Auth
  Auth- ->C: Redirct to IDP \nAuthorization Endpoint

  C->U: Liste verfügbarer IDP's
  U->C: ausgewählterr IDP
    
  C->I: GET /authorize
    Activate A
    Activate I
  I- ->C: Authentication \nchallenge
  |||
  A->U: Aufforderung zur \nAuthentifizierung
  U->A: Eingabe tätigen
  |||
  A->A: Authentication
  A->I: Authentication \nchallenge response
    Deactivate A
  |||
  I- ->C: Authorization Response with Authorization Code
    Deactivate I
      
  |||    
  C->Auth: GET /owner-authenticate with Authorization code
  Auth- ->I: POST /tokenEndpoint\n(authorization code)
    Activate I
  I- ->Auth: id_token
    Deactivate I
  Auth->Auth: prüfe id_token
  Auth->Auth: erzeuge \nowner-accesstoken
  Auth- ->C: owner-accesstoken
  ||| 
    
    Deactivate Auth
end
      
|||

group <size:16>FHIR-Directory Eintrag erstellen</size>
  |||
  C->FP: GET /owner/TIHealthCareService?providedBy.id=telematikID \n(owner-accesstoken)
    Activate FP
  FP->FP: prüfe \nowner-accesstoken
  FP->VZD: HTTP Forward
    Activate VZD
  VZD->VZD: suche Eintrag
  VZD- ->FP: result body json
    Deactivate VZD
  FP- ->C: HTTP Forward
    Deactivate FP
  |||
  C->FP: PUT /owner/TIHealthCareService?telecom.value=MXID \n(owner-accesstoken)
  |||
    Activate FP
  FP->FP: prüfe \nowner-accesstoken
  FP->VZD: HTTP Forward
    Activate VZD
  VZD->VZD: Eintrag hinzufügen
  VZD- ->FP: result body json
    Deactivate VZD
  FP- ->C: HTTP Forward
    Deactivate FP
  C- ->U: Status    
  |||
end
|||

  Deactivate C
@enduml

PlantUML version 1.2022.5(Sat Apr 30 10:55:52 UTC 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>