<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="2060px" preserveAspectRatio="none" style="width:1654px;height:2060px;background:#FFFFFF;" version="1.1" viewBox="0 0 1654 2060" width="1654px" zoomAndPan="magnify"><defs/><g><rect fill="#F5F5F5" height="2048.1563" style="stroke:#181818;stroke-width:0.5;" width="587.5" x="290" y="6"/><text fill="#000000" font-family="sans-serif" font-size="19" font-weight="bold" lengthAdjust="spacing" textLength="99" x="531.75" y="23.6362">Endgerät</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="5" x="630.75" y="25.0513"> </text><rect fill="#DCDCDC" height="1116.375" style="stroke:#000000;stroke-width:1.0;" width="10" x="415.5" y="225.1094"/><rect fill="#DCDCDC" height="423.6953" style="stroke:#000000;stroke-width:1.0;" width="10" x="415.5" y="1445.8984"/><rect fill="#DCDCDC" height="345.1172" style="stroke:#000000;stroke-width:1.0;" width="10" x="786.5" y="374.9375"/><rect fill="#DCDCDC" height="101.3672" style="stroke:#000000;stroke-width:1.0;" width="10" x="961.5" y="442.5156"/><rect fill="#DCDCDC" height="14" style="stroke:#000000;stroke-width:1.0;" width="10" x="1135.5" y="476.3047"/><rect fill="#DCDCDC" height="45.5195" style="stroke:#000000;stroke-width:1.0;" width="10" x="1343" y="270.6289"/><rect fill="#DCDCDC" height="495.0625" style="stroke:#000000;stroke-width:1.0;" width="10" x="1343" y="812.6328"/><rect fill="#DCDCDC" height="191.9453" style="stroke:#000000;stroke-width:1.0;" width="10" x="1343" y="1643.8594"/><rect fill="#DCDCDC" height="378.9063" style="stroke:#000000;stroke-width:1.0;" width="10" x="1550.5" y="374.9375"/><rect fill="#DCDCDC" height="33.7891" style="stroke:#000000;stroke-width:1.0;" width="10" x="1550.5" y="866.2109"/><rect fill="#F0F8FF" height="1749.0313" style="stroke:#000000;stroke-width:1.5;" width="1637.5" x="10" y="153.5625"/><rect fill="#FFE4E1" height="78.3828" style="stroke:#000000;stroke-width:1.5;" width="863.5" x="20" y="583.8828"/><rect fill="#FFE4E1" height="112.1719" style="stroke:#000000;stroke-width:1.5;" width="1453.5" x="20" y="1071.1563"/><rect fill="#F0F8FF" height="528.1094" style="stroke:none;stroke-width:1.0;" width="1637.5" x="10" y="1374.4844"/><rect fill="#FFE4E1" height="78.3828" style="stroke:#000000;stroke-width:1.5;" width="537" x="20" y="1507.6875"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="126" x2="126" y1="111.5625" y2="1944.5938"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="420" x2="420" y1="111.5625" y2="1944.5938"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="791.5" x2="791.5" y1="111.5625" y2="1944.5938"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="966.5" x2="966.5" y1="111.5625" y2="1944.5938"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1140.5" x2="1140.5" y1="111.5625" y2="1944.5938"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1347.5" x2="1347.5" y1="111.5625" y2="1944.5938"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1555.5" x2="1555.5" y1="111.5625" y2="1944.5938"/><text fill="#000000" font-family="Aapex" font-size="20" lengthAdjust="spacing" textLength="187" x="30" y="83.5645">Akteur in der Rolle</text><text fill="#000000" font-family="Aapex" font-size="20" lengthAdjust="spacing" textLength="110" x="68.5" y="106.8457">Org-Admin</text><ellipse cx="126.5" cy="13.5" fill="#DCDCDC" rx="8" ry="8" style="stroke:#000000;stroke-width:0.5;"/><path d="M126.5,21.5 L126.5,48.5 M113.5,29.5 L139.5,29.5 M126.5,48.5 L113.5,63.5 M126.5,48.5 L139.5,63.5 " fill="none" style="stroke:#000000;stroke-width:0.5;"/><text fill="#000000" font-family="Aapex" font-size="20" lengthAdjust="spacing" textLength="187" x="30" y="1962.1582">Akteur in der Rolle</text><text fill="#000000" font-family="Aapex" font-size="20" lengthAdjust="spacing" textLength="110" x="68.5" y="1985.4395">Org-Admin</text><ellipse cx="126.5" cy="1998.6563" fill="#DCDCDC" rx="8" ry="8" style="stroke:#000000;stroke-width:0.5;"/><path d="M126.5,2006.6563 L126.5,2033.6563 M113.5,2014.6563 L139.5,2014.6563 M126.5,2033.6563 L113.5,2048.6563 M126.5,2033.6563 L139.5,2048.6563 " fill="none" style="stroke:#000000;stroke-width:0.5;"/><rect fill="#EFEFFF" height="60.5625" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="253" x="294" y="50"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="132" x="351.5" y="75.5645">Frontend des</text><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="239" x="301" y="98.8457">Registrierungs-Dienstes</text><rect fill="#EFEFFF" height="60.5625" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="253" x="294" y="1943.5938"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="132" x="351.5" y="1969.1582">Frontend des</text><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="239" x="301" y="1992.4395">Registrierungs-Dienstes</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="164" x="709.5" y="73.2813"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="138" x="722.5" y="98.8457">Authenticator</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="164" x="709.5" y="1943.5938"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="138" x="722.5" y="1969.1582">Authenticator</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="164" x="884.5" y="73.2813"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="103" x="915" y="98.8457">Konnektor</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="164" x="884.5" y="1943.5938"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="103" x="915" y="1969.1582">Konnektor</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="164" x="1058.5" y="73.2813"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="109" x="1086" y="98.8457">eHealth KT</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="164" x="1058.5" y="1943.5938"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="109" x="1086" y="1969.1582">eHealth KT</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="231" x="1232.5" y="73.2813"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="217" x="1239.5" y="98.8457">Registrierungs-Dienst</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="231" x="1232.5" y="1943.5938"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="217" x="1239.5" y="1969.1582">Registrierungs-Dienst</text><rect fill="#EFEFFF" height="60.5625" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="164" x="1473.5" y="50"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="90" x="1507.5" y="75.5645">zentraler</text><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="104" x="1503.5" y="98.8457">IDP-Dienst</text><rect fill="#EFEFFF" height="60.5625" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="164" x="1473.5" y="1943.5938"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="90" x="1507.5" y="1969.1582">zentraler</text><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="104" x="1503.5" y="1992.4395">IDP-Dienst</text><rect fill="#DCDCDC" height="1116.375" style="stroke:#000000;stroke-width:1.0;" width="10" x="415.5" y="225.1094"/><rect fill="#DCDCDC" height="423.6953" style="stroke:#000000;stroke-width:1.0;" width="10" x="415.5" y="1445.8984"/><rect fill="#DCDCDC" height="345.1172" style="stroke:#000000;stroke-width:1.0;" width="10" x="786.5" y="374.9375"/><rect fill="#DCDCDC" height="101.3672" style="stroke:#000000;stroke-width:1.0;" width="10" x="961.5" y="442.5156"/><rect fill="#DCDCDC" height="14" style="stroke:#000000;stroke-width:1.0;" width="10" x="1135.5" y="476.3047"/><rect fill="#DCDCDC" height="45.5195" style="stroke:#000000;stroke-width:1.0;" width="10" x="1343" y="270.6289"/><rect fill="#DCDCDC" height="495.0625" style="stroke:#000000;stroke-width:1.0;" width="10" x="1343" y="812.6328"/><rect fill="#DCDCDC" height="191.9453" style="stroke:#000000;stroke-width:1.0;" width="10" x="1343" y="1643.8594"/><rect fill="#DCDCDC" height="378.9063" style="stroke:#000000;stroke-width:1.0;" width="10" x="1550.5" y="374.9375"/><rect fill="#DCDCDC" height="33.7891" style="stroke:#000000;stroke-width:1.0;" width="10" x="1550.5" y="866.2109"/><path d="M10,153.5625 L74,153.5625 L74,160.6953 L64,170.6953 L10,170.6953 L10,153.5625 " fill="#D3D3D3" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="1749.0313" style="stroke:#000000;stroke-width:1.5;" width="1637.5" x="10" y="153.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="25" y="166.6294">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="89" y="171.5933">[</text><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="515" x="94" y="170.4141">Organisation nicht am Registrierungs-Dienst authentisiert</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="609" y="171.5933">]</text><polygon fill="#000000" points="403.5,221.1094,413.5,225.1094,403.5,229.1094,407.5,225.1094" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="126.5" x2="409.5" y1="225.1094" y2="225.1094"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="206" x="133.5" y="219.1001">Organisation verifizieren</text><polygon fill="#000000" points="1331,266.6289,1341,270.6289,1331,274.6289,1335,270.6289" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="425.5" x2="1337" y1="270.6289" y2="270.6289"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="119" x="432.5" y="264.6196">POST /register</text><path d="M1358,238.1094 L1358,285.1094 L1606,285.1094 L1606,248.1094 L1596,238.1094 L1358,238.1094 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1596,238.1094 L1596,248.1094 L1606,248.1094 L1596,238.1094 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="16" lengthAdjust="spacing" textLength="174" x="1364" y="257.9609">Schnittstelle wird nicht</text><text fill="#000000" font-family="sans-serif" font-size="16" lengthAdjust="spacing" textLength="227" x="1364" y="276.5859">durch die gematik spezifiziert</text><polygon fill="#000000" points="436.5,312.1484,426.5,316.1484,436.5,320.1484,432.5,316.1484" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="430.5" x2="1347" y1="316.1484" y2="316.1484"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="323" x="1018" y="310.1392">Redirect to IDP Authorization Endpoint</text><polygon fill="#000000" points="1538.5,370.9375,1548.5,374.9375,1538.5,378.9375,1542.5,374.9375" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="425.5" x2="1544.5" y1="374.9375" y2="374.9375"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="124" x="432.5" y="368.9282">GET /authorize</text><polygon fill="#000000" points="807.5,404.7266,797.5,408.7266,807.5,412.7266,803.5,408.7266" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="801.5" x2="1549.5" y1="408.7266" y2="408.7266"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="209" x="1334.5" y="402.7173">Authentication challenge</text><polygon fill="#000000" points="949.5,438.5156,959.5,442.5156,949.5,446.5156,953.5,442.5156" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="796.5" x2="955.5" y1="442.5156" y2="442.5156"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="124" x="803.5" y="436.5063">SignDocument</text><polygon fill="#000000" points="1123.5,472.3047,1133.5,476.3047,1123.5,480.3047,1127.5,476.3047" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="971.5" x2="1129.5" y1="476.3047" y2="476.3047"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="139" x="978.5" y="470.2954">SICCT command</text><polygon fill="#000000" points="982.5,486.3047,972.5,490.3047,982.5,494.3047,978.5,490.3047" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="976.5" x2="1139.5" y1="490.3047" y2="490.3047"/><polygon fill="#000000" points="807.5,539.8828,797.5,543.8828,807.5,547.8828,803.5,543.8828" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="801.5" x2="965.5" y1="543.8828" y2="543.8828"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="79" x="818.5" y="518.0845">Response</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="141" x="818.5" y="537.8735">signedDocument</text><path d="M20,583.8828 L90,583.8828 L90,591.0156 L80,601.0156 L20,601.0156 L20,583.8828 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="78.3828" style="stroke:#000000;stroke-width:1.5;" width="863.5" x="20" y="583.8828"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="25" x="35" y="596.9497">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="105" y="600.7495">[</text><text fill="#000000" font-family="sans-serif" font-size="15" font-weight="bold" lengthAdjust="spacing" textLength="67" x="110" y="599.8062">Abbruch</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="177" y="600.7495">]</text><polygon fill="#000000" points="137.5,625.2656,127.5,629.2656,137.5,633.2656,133.5,629.2656" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="131.5" x2="785.5" y1="629.2656" y2="629.2656"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="222" x="557.5" y="623.2563">SMC-B nicht freigeschaltet</text><polygon fill="#000000" points="1538.5,716.0547,1548.5,720.0547,1538.5,724.0547,1542.5,720.0547" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="791.5" x2="1544.5" y1="720.0547" y2="720.0547"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="203" x="798.5" y="714.0454">Authentication response</text><polygon fill="#000000" points="436.5,749.8438,426.5,753.8438,436.5,757.8438,432.5,753.8438" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="430.5" x2="1554.5" y1="753.8438" y2="753.8438"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="156" x="1392.5" y="747.8345">Authorization code</text><polygon fill="#000000" points="1331,808.6328,1341,812.6328,1331,816.6328,1335,812.6328" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="425.5" x2="1337" y1="812.6328" y2="812.6328"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="294" x="432.5" y="806.6235">POST /register (Authorization code)</text><polygon fill="#000000" points="1538.5,862.2109,1548.5,866.2109,1538.5,870.2109,1542.5,866.2109" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="1353" x2="1544.5" y1="866.2109" y2="866.2109"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="178" x="1360" y="840.4126">POST /tokenEndpoint</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="177" x="1360" y="860.2017">{authorization code}</text><polygon fill="#000000" points="1364,896,1354,900,1364,904,1360,900" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1358" x2="1554.5" y1="900" y2="900"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="72" x="1476.5" y="893.9907">id_token</text><line style="stroke:#000000;stroke-width:1.0;" x1="1353" x2="1395" y1="1018.1563" y2="1018.1563"/><line style="stroke:#000000;stroke-width:1.0;" x1="1395" x2="1395" y1="1018.1563" y2="1031.1563"/><line style="stroke:#000000;stroke-width:1.0;" x1="1354" x2="1395" y1="1031.1563" y2="1031.1563"/><polygon fill="#000000" points="1364,1027.1563,1354,1031.1563,1364,1035.1563,1360,1031.1563" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="92" x="1360" y="952.7798">enthaltene</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="149" x="1360" y="972.5688">ProfessionOID auf</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="170" x="1360" y="992.3579">gültige Organisation</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="55" x="1360" y="1012.147">prüfen</text><path d="M20,1071.1563 L90,1071.1563 L90,1078.2891 L80,1088.2891 L20,1088.2891 L20,1071.1563 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="112.1719" style="stroke:#000000;stroke-width:1.5;" width="1453.5" x="20" y="1071.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="25" x="35" y="1084.2231">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="105" y="1088.0229">[</text><text fill="#000000" font-family="sans-serif" font-size="15" font-weight="bold" lengthAdjust="spacing" textLength="67" x="110" y="1087.0796">Abbruch</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="177" y="1088.0229">]</text><polygon fill="#000000" points="436.5,1112.5391,426.5,1116.5391,436.5,1120.5391,432.5,1116.5391" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="430.5" x2="1342" y1="1116.5391" y2="1116.5391"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="315" x="1021" y="1110.5298">keine gültige ProfessionOID gefunden</text><polygon fill="#000000" points="137.5,1146.3281,127.5,1150.3281,137.5,1154.3281,133.5,1150.3281" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="131.5" x2="414.5" y1="1150.3281" y2="1150.3281"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="265" x="143.5" y="1144.3188">Authentisierung fehlgeschlagen</text><line style="stroke:#000000;stroke-width:1.0;" x1="1353" x2="1395" y1="1260.9063" y2="1260.9063"/><line style="stroke:#000000;stroke-width:1.0;" x1="1395" x2="1395" y1="1260.9063" y2="1273.9063"/><line style="stroke:#000000;stroke-width:1.0;" x1="1354" x2="1395" y1="1273.9063" y2="1273.9063"/><polygon fill="#000000" points="1364,1269.9063,1354,1273.9063,1364,1277.9063,1360,1273.9063" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="107" x="1360" y="1235.1079">Organisation</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="134" x="1360" y="1254.897">authentifizieren</text><polygon fill="#000000" points="436.5,1303.6953,426.5,1307.6953,436.5,1311.6953,432.5,1307.6953" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="430.5" x2="1347" y1="1307.6953" y2="1307.6953"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="133" x="1208" y="1301.686">status, id_token</text><polygon fill="#000000" points="137.5,1337.4844,127.5,1341.4844,137.5,1345.4844,133.5,1341.4844" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="131.5" x2="419.5" y1="1341.4844" y2="1341.4844"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="200" x="213.5" y="1335.4751">Verifizierung erfolgreich</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="10" x2="1647.5" y1="1375.4844" y2="1375.4844"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="15" y="1391.5151">[</text><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="465" x="20" y="1390.3359">Organisation am Registrierungs-Dienst authentisiert</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="485" y="1391.5151">]</text><polygon fill="#000000" points="403.5,1441.8984,413.5,1445.8984,403.5,1449.8984,407.5,1445.8984" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="126.5" x2="409.5" y1="1445.8984" y2="1445.8984"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="197" x="133.5" y="1439.8892">Admin Account anlegen</text><line style="stroke:#000000;stroke-width:1.0;" x1="425.5" x2="467.5" y1="1479.6875" y2="1479.6875"/><line style="stroke:#000000;stroke-width:1.0;" x1="467.5" x2="467.5" y1="1479.6875" y2="1492.6875"/><line style="stroke:#000000;stroke-width:1.0;" x1="426.5" x2="467.5" y1="1492.6875" y2="1492.6875"/><polygon fill="#000000" points="436.5,1488.6875,426.5,1492.6875,436.5,1496.6875,432.5,1492.6875" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="347" x="432.5" y="1473.6782">Prüfung auf existierenden Admin Account</text><path d="M20,1507.6875 L90,1507.6875 L90,1514.8203 L80,1524.8203 L20,1524.8203 L20,1507.6875 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="78.3828" style="stroke:#000000;stroke-width:1.5;" width="537" x="20" y="1507.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="25" x="35" y="1520.7544">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="105" y="1524.5542">[</text><text fill="#000000" font-family="sans-serif" font-size="15" font-weight="bold" lengthAdjust="spacing" textLength="67" x="110" y="1523.6108">Abbruch</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="177" y="1524.5542">]</text><polygon fill="#000000" points="137.5,1549.0703,127.5,1553.0703,137.5,1557.0703,133.5,1553.0703" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="131.5" x2="414.5" y1="1553.0703" y2="1553.0703"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="261" x="147.5" y="1547.061">Admin Account existiert bereits</text><polygon fill="#000000" points="1331,1639.8594,1341,1643.8594,1331,1647.8594,1335,1643.8594" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="425.5" x2="1337" y1="1643.8594" y2="1643.8594"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="371" x="432.5" y="1637.8501">POST /register (id_token, Client-Credentials)</text><line style="stroke:#000000;stroke-width:1.0;" x1="1353" x2="1395" y1="1677.6484" y2="1677.6484"/><line style="stroke:#000000;stroke-width:1.0;" x1="1395" x2="1395" y1="1677.6484" y2="1690.6484"/><line style="stroke:#000000;stroke-width:1.0;" x1="1354" x2="1395" y1="1690.6484" y2="1690.6484"/><polygon fill="#000000" points="1364,1686.6484,1354,1690.6484,1364,1694.6484,1360,1690.6484" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="132" x="1360" y="1671.6392">id_token prüfen</text><line style="stroke:#000000;stroke-width:1.0;" x1="1353" x2="1395" y1="1789.0156" y2="1789.0156"/><line style="stroke:#000000;stroke-width:1.0;" x1="1395" x2="1395" y1="1789.0156" y2="1802.0156"/><line style="stroke:#000000;stroke-width:1.0;" x1="1354" x2="1395" y1="1802.0156" y2="1802.0156"/><polygon fill="#000000" points="1364,1798.0156,1354,1802.0156,1364,1806.0156,1360,1802.0156" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="125" x="1360" y="1743.4282">Admin Account</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="166" x="1360" y="1763.2173">für die Organisation</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="67" x="1360" y="1783.0063">anlegen</text><polygon fill="#000000" points="436.5,1831.8047,426.5,1835.8047,436.5,1839.8047,432.5,1835.8047" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="430.5" x2="1347" y1="1835.8047" y2="1835.8047"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="187" x="1154" y="1829.7954">status, Admin-Account</text><polygon fill="#000000" points="137.5,1865.5938,127.5,1869.5938,137.5,1873.5938,133.5,1869.5938" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="131.5" x2="419.5" y1="1869.5938" y2="1869.5938"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="144" x="269.5" y="1863.5845">Account angelegt</text><!--MD5=[ac196f93481712d6741a6cb8cccd8f8d]
@startuml
skinparam sequenceMessageAlign direction
skinparam WrapWidth 300
skinparam minClassWidth 150
skinparam BoxPadding 1
scale max 2048 width

skinparam sequence {
ArrowColor black
ArrowFontSize 17
ActorBorderColor black
LifeLineBorderColor black
LifeLineBackgroundColor Gainsboro

ParticipantBorderColor Motivation
ParticipantBackgroundColor Motivation
ParticipantFontName Impact
ParticipantFontSize 20
ParticipantFontColor black
ParticipantBorderColor Black
ParticipantBackgroundColor MOTIVATION

ActorBackgroundColor Gainsboro
ActorFontColor black
ActorFontSize 20
ActorFontName Aapex
}

  actor oa as "Akteur in der Rolle\nOrg-Admin"
    box <size:19>Endgerät</size> #WhiteSmoke
    participant wb as "Frontend des \nRegistrierungs-Dienstes"
    participant au as "Authenticator"
    end box
  participant ko as "Konnektor"
  participant kt as "eHealth KT"
  participant rd as "Registrierungs-Dienst"
  participant ip as "zentraler \nIDP-Dienst"

|||
alt#LightGrey #AliceBlue <size:16>Organisation nicht am Registrierungs-Dienst authentisiert</size>
|||
      oa -> wb: Organisation verifizieren
        activate wb
      wb -> rd:POST /register 
      note right: <size:16>Schnittstelle wird nicht \n<size:16>durch die gematik spezifiziert</size>
        activate rd
      rd - -> wb: Redirect to IDP Authorization Endpoint
        deactivate rd
      |||
      wb -> ip: GET /authorize
        activate au
        activate ip
      ip -> au: Authentication challenge
      au -> ko: SignDocument
        activate ko
      ko -> kt: SICCT command
        activate kt
      kt - -> ko
        deactivate kt
      ko - -> au: Response \nsignedDocument
      |||
        deactivate ko
    
    opt #MistyRose <size:15>Abbruch</size>
      au -> oa: SMC-B nicht freigeschaltet 
      |||
    end
      |||
      au - ->ip: Authentication response
        deactivate au
      ip - -> wb: Authorization code
        deactivate ip
      |||
      wb -> rd: POST /register (Authorization code)
        activate rd
      rd -> ip: POST /tokenEndpoint\n{authorization code}
        activate ip
      ip - -> rd: id_token
        deactivate ip
      |||
      rd -> rd: enthaltene \nProfessionOID auf \ngültige Organisation \nprüfen
      |||
      
    opt #MistyRose <size:15>Abbruch</size>
      rd -> wb: keine gültige ProfessionOID gefunden
      wb -> oa: Authentisierung fehlgeschlagen
      |||
    end  
    
      |||
      rd-> rd: Organisation \nauthentifizieren
      rd - -> wb: status, id_token
        deactivate rd
      wb - -> oa: Verifizierung erfolgreich
        deactivate wb
      |||  
      
      else <size:16>Organisation am Registrierungs-Dienst authentisiert</size>
        |||
        oa -> wb: Admin Account anlegen
          activate wb
        wb -> wb: Prüfung auf existierenden Admin Account
         opt #MistyRose <size:15>Abbruch</size>
         wb -> oa: Admin Account existiert bereits
         |||
        end  
         |||
        wb -> rd: POST /register (id_token, Client-Credentials)
          activate rd
        rd -> rd: id_token prüfen
        |||
        rd -> rd: Admin Account \nfür die Organisation \nanlegen
        rd - -> wb: status, Admin-Account
          deactivate rd
        wb - -> oa: Account angelegt
          deactivate wb
        |||
end
|||
@enduml

PlantUML version 1.2022.5(Sat Apr 30 10:55:52 UTC 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>