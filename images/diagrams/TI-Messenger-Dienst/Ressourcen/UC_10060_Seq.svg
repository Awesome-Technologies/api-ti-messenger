<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1661px" preserveAspectRatio="none" style="width:1640px;height:1661px;background:#FFFFFF;" version="1.1" viewBox="0 0 1640 1661" width="1640px" zoomAndPan="magnify"><defs/><g><rect fill="#F5F5F5" height="1649.6094" style="stroke:#181818;stroke-width:0.5;" width="261" x="243" y="6"/><text fill="#000000" font-family="sans-serif" font-size="18" font-weight="bold" lengthAdjust="spacing" textLength="93" x="324.5" y="22.708">Endgerät</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="5" x="417.5" y="23.8872"> </text><rect fill="#F5F5F5" height="1649.6094" style="stroke:#181818;stroke-width:0.5;" width="531" x="875.5" y="6"/><text fill="#000000" font-family="sans-serif" font-size="18" font-weight="bold" lengthAdjust="spacing" textLength="200" x="1038.5" y="22.708">VZD-FHIR-Directory</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="5" x="1238.5" y="23.8872"> </text><rect fill="#DCDCDC" height="1157.0469" style="stroke:#000000;stroke-width:1.0;" width="10" x="368.5" y="314"/><rect fill="#DCDCDC" height="1049.8906" style="stroke:#000000;stroke-width:1.0;" width="10" x="621.5" y="387.3672"/><rect fill="#DCDCDC" height="100.3672" style="stroke:#000000;stroke-width:1.0;" width="10" x="956.5" y="893.4219"/><rect fill="#DCDCDC" height="254.3125" style="stroke:#000000;stroke-width:1.0;" width="10" x="1141.5" y="1092.1563"/><rect fill="#DCDCDC" height="186.7344" style="stroke:#000000;stroke-width:1.0;" width="10" x="1315.5" y="1125.9453"/><rect fill="#DCDCDC" height="129.8594" style="stroke:#000000;stroke-width:1.0;" width="10" x="1509" y="575.3594"/><rect height="1261.5938" style="stroke:#000000;stroke-width:1.5;fill:none;" width="1624.5" x="10" y="242.4531"/><rect height="335.8516" style="stroke:#000000;stroke-width:1.5;fill:none;" width="1123.5" x="501" y="427.3672"/><rect height="577.25" style="stroke:#000000;stroke-width:1.5;fill:none;" width="980.5" x="501" y="802.2188"/><line style="stroke:#000000;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="116" x2="116" y1="111.5625" y2="1546.0469"/><line style="stroke:#000000;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="373" x2="373" y1="111.5625" y2="1546.0469"/><line style="stroke:#000000;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="626" x2="626" y1="111.5625" y2="1546.0469"/><line style="stroke:#000000;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="961.5" x2="961.5" y1="111.5625" y2="1546.0469"/><line style="stroke:#000000;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="1146.5" x2="1146.5" y1="111.5625" y2="1546.0469"/><line style="stroke:#000000;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="1320.5" x2="1320.5" y1="111.5625" y2="1546.0469"/><line style="stroke:#000000;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="1513.5" x2="1513.5" y1="573.7109" y2="1546.0469"/><text fill="#000000" font-family="Aapex" font-size="20" lengthAdjust="spacing" textLength="187" x="20" y="83.5645">Akteur in der Rolle</text><text fill="#000000" font-family="Aapex" font-size="20" lengthAdjust="spacing" textLength="110" x="58.5" y="106.8457">Org-Admin</text><ellipse cx="116.5" cy="13.5" fill="#DCDCDC" rx="8" ry="8" style="stroke:#000000;stroke-width:0.5;"/><path d="M116.5,21.5 L116.5,48.5 M103.5,29.5 L129.5,29.5 M116.5,48.5 L103.5,63.5 M116.5,48.5 L129.5,63.5 " fill="none" style="stroke:#000000;stroke-width:0.5;"/><text fill="#000000" font-family="Aapex" font-size="20" lengthAdjust="spacing" textLength="187" x="20" y="1563.6113">Akteur in der Rolle</text><text fill="#000000" font-family="Aapex" font-size="20" lengthAdjust="spacing" textLength="110" x="58.5" y="1586.8926">Org-Admin</text><ellipse cx="116.5" cy="1600.1094" fill="#DCDCDC" rx="8" ry="8" style="stroke:#000000;stroke-width:0.5;"/><path d="M116.5,1608.1094 L116.5,1635.1094 M103.5,1616.1094 L129.5,1616.1094 M116.5,1635.1094 L103.5,1650.1094 M116.5,1635.1094 L129.5,1650.1094 " fill="none" style="stroke:#000000;stroke-width:0.5;"/><rect fill="#EFEFFF" height="60.5625" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="253" x="247" y="50"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="132" x="307.5" y="75.5645">Frontend des</text><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="239" x="254" y="98.8457">Registrierungs-Dienstes</text><rect fill="#EFEFFF" height="60.5625" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="253" x="247" y="1545.0469"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="132" x="307.5" y="1570.6113">Frontend des</text><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="239" x="254" y="1593.8926">Registrierungs-Dienstes</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="231" x="511" y="73.2813"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="217" x="518" y="98.8457">Registrierungs-Dienst</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="231" x="511" y="1545.0469"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="217" x="518" y="1570.6113">Registrierungs-Dienst</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="164" x="879.5" y="73.2813"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="128" x="897.5" y="98.8457">Auth-Service</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="164" x="879.5" y="1545.0469"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="128" x="897.5" y="1570.6113">Auth-Service</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="164" x="1064.5" y="73.2813"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="108" x="1092.5" y="98.8457">FHIR-Proxy</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="164" x="1064.5" y="1545.0469"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="108" x="1092.5" y="1570.6113">FHIR-Proxy</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="164" x="1238.5" y="73.2813"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="145" x="1248" y="98.8457">FHIR-Directory</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="164" x="1238.5" y="1545.0469"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="145" x="1248" y="1570.6113">FHIR-Directory</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="201" x="1413.5" y="1545.0469"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="187" x="1420.5" y="1570.6113">Messenger-Service</text><rect fill="#DCDCDC" height="1157.0469" style="stroke:#000000;stroke-width:1.0;" width="10" x="368.5" y="314"/><rect fill="#DCDCDC" height="1049.8906" style="stroke:#000000;stroke-width:1.0;" width="10" x="621.5" y="387.3672"/><rect fill="#DCDCDC" height="100.3672" style="stroke:#000000;stroke-width:1.0;" width="10" x="956.5" y="893.4219"/><rect fill="#DCDCDC" height="254.3125" style="stroke:#000000;stroke-width:1.0;" width="10" x="1141.5" y="1092.1563"/><rect fill="#DCDCDC" height="186.7344" style="stroke:#000000;stroke-width:1.0;" width="10" x="1315.5" y="1125.9453"/><rect fill="#DCDCDC" height="129.8594" style="stroke:#000000;stroke-width:1.0;" width="10" x="1509" y="575.3594"/><rect height="58.8906" style="stroke:#000000;stroke-width:1.5;fill:none;" width="728" x="17" y="146.5625"/><path d="M17,146.5625 L83,146.5625 L83,153.5625 L73,163.5625 L17,163.5625 L17,146.5625 " fill="#98FB98" style="stroke:#000000;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21" x="30" y="160.6294">ref</text><text fill="#000000" font-family="sans-serif" font-size="17" font-weight="bold" lengthAdjust="spacing" textLength="98" x="78" y="183.3423">AF: 10103</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="503" x="181" y="183.3423">- Authentisieren einer Organisation am TI-Messenger-Dienst</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="379" y="198.4902"> </text><path d="M10,242.4531 L87,242.4531 L87,249.5859 L77,259.5859 L10,259.5859 L10,242.4531 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="1261.5938" style="stroke:#000000;stroke-width:1.5;" width="1624.5" x="10" y="242.4531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32" x="25" y="255.52">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="102" y="260.4839">[</text><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="34" x="107" y="259.3047">1..n</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="141" y="260.4839">]</text><polygon fill="#000000" points="356.5,310,366.5,314,356.5,318,360.5,314" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="116.5" x2="362.5" y1="314" y2="314"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="233" x="123.5" y="307.9907">Messenger Service erstellen</text><polygon fill="#000000" points="609.5,383.3672,619.5,387.3672,609.5,391.3672,613.5,387.3672" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="378.5" x2="615.5" y1="387.3672" y2="387.3672"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="196" x="385.5" y="341.7798">POST /create (id_token,</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="114" x="385.5" y="361.5688">access_token,</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="133" x="385.5" y="381.3579">Matrix-Domain)</text><path d="M501,427.3672 L796,427.3672 L796,437.9922 L786,447.9922 L501,447.9922 L501,427.3672 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="335.8516" style="stroke:#000000;stroke-width:1.5;" width="1123.5" x="501" y="427.3672"/><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="250" x="516" y="443.2188">Messaging-Service erstellen</text><line style="stroke:#000000;stroke-width:1.0;" x1="631.5" x2="673.5" y1="518.5703" y2="518.5703"/><line style="stroke:#000000;stroke-width:1.0;" x1="673.5" x2="673.5" y1="518.5703" y2="531.5703"/><line style="stroke:#000000;stroke-width:1.0;" x1="632.5" x2="673.5" y1="531.5703" y2="531.5703"/><polygon fill="#000000" points="642.5,527.5703,632.5,531.5703,642.5,535.5703,638.5,531.5703" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="271" x="638.5" y="492.772">Starte neuen Messenger-Service</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="311" x="638.5" y="512.561">für die Organisation (Matrix-Domain)</text><polygon fill="#000000" points="1401.5,561.3594,1411.5,565.3594,1401.5,569.3594,1405.5,565.3594" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="631.5" x2="1407.5" y1="565.3594" y2="565.3594"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="234" x="638.5" y="559.3501">Messenger-Service erstellen</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="201" x="1413.5" y="539.5703"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="187" x="1420.5" y="565.1348">Messenger-Service</text><line style="stroke:#000000;stroke-width:1.0;" x1="1519" x2="1561" y1="658.4297" y2="658.4297"/><line style="stroke:#000000;stroke-width:1.0;" x1="1561" x2="1561" y1="658.4297" y2="671.4297"/><line style="stroke:#000000;stroke-width:1.0;" x1="1520" x2="1561" y1="671.4297" y2="671.4297"/><polygon fill="#000000" points="1530,667.4297,1520,671.4297,1530,675.4297,1526,671.4297" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="66" x="1526" y="632.6313">Account</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="73" x="1526" y="652.4204">erstellen</text><polygon fill="#000000" points="642.5,701.2188,632.5,705.2188,642.5,709.2188,638.5,705.2188" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="636.5" x2="1513" y1="705.2188" y2="705.2188"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="186" x="1321" y="699.2095">Status, Account Daten</text><path d="M501,802.2188 L828,802.2188 L828,812.8438 L818,822.8438 L501,822.8438 L501,802.2188 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="577.25" style="stroke:#000000;stroke-width:1.5;" width="980.5" x="501" y="802.2188"/><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="282" x="516" y="818.0703">FHIR-Directory Eintrag erstellen</text><polygon fill="#000000" points="944.5,889.4219,954.5,893.4219,944.5,897.4219,948.5,893.4219" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="631.5" x2="950.5" y1="893.4219" y2="893.4219"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="297" x="638.5" y="867.6235">GET /token (client_id, client_secret)</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="259" x="638.5" y="887.4126">(OAuth Client credentials flow)</text><line style="stroke:#000000;stroke-width:1.0;" x1="966.5" x2="1008.5" y1="947" y2="947"/><line style="stroke:#000000;stroke-width:1.0;" x1="1008.5" x2="1008.5" y1="947" y2="960"/><line style="stroke:#000000;stroke-width:1.0;" x1="967.5" x2="1008.5" y1="960" y2="960"/><polygon fill="#000000" points="977.5,956,967.5,960,977.5,964,973.5,960" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="156" x="973.5" y="921.2017">prüfe client_id und</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="105" x="973.5" y="940.9907">client_secret</text><polygon fill="#000000" points="642.5,989.7891,632.5,993.7891,642.5,997.7891,638.5,993.7891" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="636.5" x2="960.5" y1="993.7891" y2="993.7891"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="165" x="789.5" y="987.7798">admin-access-token</text><polygon fill="#000000" points="1129.5,1088.1563,1139.5,1092.1563,1129.5,1096.1563,1133.5,1092.1563" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="631.5" x2="1135.5" y1="1092.1563" y2="1092.1563"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="114" x="638.5" y="1046.5688">FHIR Request</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="315" x="638.5" y="1066.3579">(admin-access-token, Matrix-Domain)</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="192" x="638.5" y="1086.147">Endpoint (tim-domain)</text><polygon fill="#000000" points="1303.5,1121.9453,1313.5,1125.9453,1303.5,1129.9453,1307.5,1125.9453" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="1151.5" x2="1309.5" y1="1125.9453" y2="1125.9453"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="117" x="1158.5" y="1119.936">HTTP Forward</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1325.5" x2="1367.5" y1="1199.3125" y2="1199.3125"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1367.5" x2="1367.5" y1="1199.3125" y2="1212.3125"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1326.5" x2="1367.5" y1="1212.3125" y2="1212.3125"/><polygon fill="#000000" points="1336.5,1208.3125,1326.5,1212.3125,1336.5,1216.3125,1332.5,1212.3125" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="131" x="1332.5" y="1153.7251">FHIR-Ressource</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="77" x="1332.5" y="1173.5142">erzeugen</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="137" x="1332.5" y="1193.3032">(TIOrganisation)</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1325.5" x2="1367.5" y1="1265.8906" y2="1265.8906"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1367.5" x2="1367.5" y1="1265.8906" y2="1278.8906"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1326.5" x2="1367.5" y1="1278.8906" y2="1278.8906"/><polygon fill="#000000" points="1336.5,1274.8906,1326.5,1278.8906,1336.5,1282.8906,1332.5,1278.8906" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="133" x="1332.5" y="1240.0923">Föderationsliste</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="109" x="1332.5" y="1259.8813">aktualisieren</text><polygon fill="#000000" points="1162.5,1308.6797,1152.5,1312.6797,1162.5,1316.6797,1158.5,1312.6797" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1156.5" x2="1319.5" y1="1312.6797" y2="1312.6797"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="54" x="1259.5" y="1306.6704">Status</text><polygon fill="#000000" points="642.5,1342.4688,632.5,1346.4688,642.5,1350.4688,638.5,1346.4688" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="636.5" x2="1145.5" y1="1346.4688" y2="1346.4688"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="117" x="1022.5" y="1340.4595">HTTP Forward</text><polygon fill="#000000" points="389.5,1433.2578,379.5,1437.2578,389.5,1441.2578,385.5,1437.2578" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="383.5" x2="625.5" y1="1437.2578" y2="1437.2578"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="186" x="433.5" y="1431.2485">Status, Account Daten</text><polygon fill="#000000" points="127.5,1467.0469,117.5,1471.0469,127.5,1475.0469,123.5,1471.0469" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="121.5" x2="372.5" y1="1471.0469" y2="1471.0469"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="186" x="180.5" y="1465.0376">Status, Account Daten</text><!--MD5=[066b761302f15b6c2992a15da50f04b3]
@startuml
skinparam sequenceMessageAlign direction
skinparam WrapWidth 300
skinparam minClassWidth 150
skinparam BoxPadding 1
skinparam sequenceReferenceHeaderBackgroundColor palegreen
scale max 2048 width

skinparam sequence {
ArrowColor black
ArrowFontSize 17
ActorBorderColor black
LifeLineBorderColor black
LifeLineBackgroundColor Gainsboro

ParticipantBorderColor Motivation
ParticipantBackgroundColor Motivation
ParticipantFontName Impact
ParticipantFontSize 20
ParticipantFontColor black
ParticipantBorderColor Black
ParticipantBackgroundColor MOTIVATION

ActorBackgroundColor Gainsboro
ActorFontColor black
ActorFontSize 20
ActorFontName Aapex
}
    actor U as "Akteur in der Rolle\nOrg-Admin"
    box <size:18>Endgerät</size> #WhiteSmoke
      participant C as "Frontend des\nRegistrierungs-Dienstes"
    end box
    participant R as "Registrierungs-Dienst"
    box <size:18>VZD-FHIR-Directory</size> #WhiteSmoke
    participant Auth as "Auth-Service"
    participant FP as "FHIR-Proxy"
    participant VZD as "FHIR-Directory"
    end box

|||
ref over U, R: <size:17>**AF: 10103** - Authentisieren einer Organisation am TI-Messenger-Dienst</size>\n 
|||

loop <size:16>1..n</size>
  |||
  U->C: Messenger Service erstellen
  Activate C
  C->R: POST /create (id_token, \naccess_token, \nMatrix-Domain)
    Activate R
    
    |||
    group <size:16>Messaging-Service erstellen</size>
    |||
      R->R: Starte neuen Messenger-Service \nfür die Organisation (Matrix-Domain)
        create "Messenger-Service"
          R- ->"Messenger-Service" : Messenger-Service erstellen 
        Activate "Messenger-Service"
      |||
      "Messenger-Service"->"Messenger-Service": Account \nerstellen
      "Messenger-Service"- ->R: Status, Account Daten
      |||
        Deactivate "Messenger-Service"
    |||
    end
    
    |||
    
    group <size:16>FHIR-Directory Eintrag erstellen</size>
    |||
      R->Auth: GET /token (client_id, client_secret) \n(OAuth Client credentials flow)
        Activate Auth
      Auth->Auth: prüfe client_id und \nclient_secret
      Auth- ->R: admin-access-token
        Deactivate Auth
      |||
      R->FP: FHIR Request \n(admin-access-token, Matrix-Domain)\nEndpoint (tim-domain)
        Activate FP
      FP->VZD: HTTP Forward
        Activate VZD
      VZD- ->VZD: FHIR-Ressource \nerzeugen \n(TIOrganisation)
      VZD- ->VZD: Föderationsliste\naktualisieren
      VZD- ->FP: Status
        Deactivate VZD
      FP- ->R: HTTP Forward
        Deactivate FP

    |||
    end

  |||
  R->C: Status, Account Daten
    Deactivate R
  C->U: Status, Account Daten
    Deactivate C
  |||
end
|||
@enduml

PlantUML version 1.2022.5(Sat Apr 30 10:55:52 UTC 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>