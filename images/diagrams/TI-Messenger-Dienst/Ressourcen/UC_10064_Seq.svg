<<<<<<< HEAD
<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="771.1902px" preserveAspectRatio="none" style="width:850px;height:771px;background:#FFFFFF;" version="1.1" viewBox="0 0 850 771" width="850.2727px" zoomAndPan="magnify"><defs/><g><rect fill="#F5F5F5" height="764.7478" style="stroke:#181818;stroke-width:0.27269810715431503;" width="322.3292" x="14.1803" y="3.2724"/><text fill="#000000" font-family="sans-serif" font-size="9.8171" font-weight="bold" lengthAdjust="spacing" textLength="105.2615" x="121.3507" y="12.3849">Messenger-Service</text><text fill="#000000" font-family="sans-serif" font-size="7.0902" font-weight="bold" lengthAdjust="spacing" textLength="2.727" x="226.6121" y="13.028"> </text><rect fill="#F5F5F5" height="764.7478" style="stroke:#181818;stroke-width:0.27269810715431503;" width="257.9724" x="552.7591" y="3.2724"/><text fill="#000000" font-family="sans-serif" font-size="9.8171" font-weight="bold" lengthAdjust="spacing" textLength="109.0792" x="625.8422" y="12.3849">VZD-FHIR-Directory</text><text fill="#000000" font-family="sans-serif" font-size="7.0902" font-weight="bold" lengthAdjust="spacing" textLength="2.727" x="734.9214" y="13.028"> </text><rect fill="#DCDCDC" height="675.0216" style="stroke:#000000;stroke-width:0.5453962143086301;" width="5.454" x="71.9923" y="43.2141"/><rect fill="#DCDCDC" height="18.4284" style="stroke:#000000;stroke-width:0.5453962143086301;" width="5.454" x="273.2435" y="699.8073"/><rect fill="#DCDCDC" height="544.8338" style="stroke:#000000;stroke-width:0.5453962143086301;" width="5.454" x="400.5935" y="195.7632"/><rect fill="#DCDCDC" height="128.4536" style="stroke:#000000;stroke-width:0.5453962143086301;" width="5.454" x="610.5711" y="303.7047"/><rect fill="#DCDCDC" height="43.947" style="stroke:#000000;stroke-width:0.5453962143086301;" width="5.454" x="747.4655" y="322.1332"/><rect fill="#F0F8FF" height="422.5542" style="stroke:#000000;stroke-width:0.818094321462945;" width="841.8191" x="5.454" y="156.7418"/><rect fill="#FFE4E1" height="258.0065" style="stroke:#000000;stroke-width:0.818094321462945;" width="830.9111" x="10.9079" y="253.8905"/><rect fill="#FFE4E1" height="43.3121" style="stroke:none;stroke-width:0.5453962143086301;" width="830.9111" x="10.9079" y="468.5848"/><rect fill="#F0F8FF" height="135.6673" style="stroke:#000000;stroke-width:0.818094321462945;" width="328.8739" x="10.9079" y="600.5665"/><rect fill="#F0F8FF" height="75.3755" style="stroke:none;stroke-width:0.5453962143086301;" width="328.8739" x="10.9079" y="660.8583"/><line style="stroke:#000000;stroke-width:0.27269810715431503;stroke-dasharray:5.0,5.0;" x1="74.7193" x2="74.7193" y1="37.7602" y2="745.5055"/><line style="stroke:#000000;stroke-width:0.27269810715431503;stroke-dasharray:5.0,5.0;" x1="275.9705" x2="275.9705" y1="37.7602" y2="745.5055"/><line style="stroke:#000000;stroke-width:0.27269810715431503;stroke-dasharray:5.0,5.0;" x1="403.0478" x2="403.0478" y1="37.7602" y2="745.5055"/><line style="stroke:#000000;stroke-width:0.27269810715431503;stroke-dasharray:5.0,5.0;" x1="613.298" x2="613.298" y1="37.7602" y2="745.5055"/><line style="stroke:#000000;stroke-width:0.27269810715431503;stroke-dasharray:5.0,5.0;" x1="750.1925" x2="750.1925" y1="37.7602" y2="745.5055"/><rect fill="#EFEFFF" height="20.3331" rx="1.3635" ry="1.3635" style="stroke:#000000;stroke-width:0.27269810715431503;" width="116.7148" x="16.3619" y="16.8817"/><text fill="#000000" font-family="Impact" font-size="10.9079" lengthAdjust="spacing" textLength="91.6266" x="28.906" y="30.8245">Messenger-Proxy</text><rect fill="#EFEFFF" height="20.3331" rx="1.3635" ry="1.3635" style="stroke:#000000;stroke-width:0.27269810715431503;" width="116.7148" x="16.3619" y="744.9601"/><text fill="#000000" font-family="Impact" font-size="10.9079" lengthAdjust="spacing" textLength="91.6266" x="28.906" y="758.9029">Messenger-Proxy</text><rect fill="#EFEFFF" height="20.3331" rx="1.3635" ry="1.3635" style="stroke:#000000;stroke-width:0.27269810715431503;" width="116.7148" x="217.6131" y="16.8817"/><text fill="#000000" font-family="Impact" font-size="10.9079" lengthAdjust="spacing" textLength="103.0799" x="224.4305" y="30.8245">Matrix-Homeserver</text><rect fill="#EFEFFF" height="20.3331" rx="1.3635" ry="1.3635" style="stroke:#000000;stroke-width:0.27269810715431503;" width="116.7148" x="217.6131" y="744.9601"/><text fill="#000000" font-family="Impact" font-size="10.9079" lengthAdjust="spacing" textLength="103.0799" x="224.4305" y="758.9029">Matrix-Homeserver</text><rect fill="#EFEFFF" height="20.3331" rx="1.3635" ry="1.3635" style="stroke:#000000;stroke-width:0.27269810715431503;" width="125.9865" x="340.3272" y="16.8817"/><text fill="#000000" font-family="Impact" font-size="10.9079" lengthAdjust="spacing" textLength="118.351" x="344.145" y="30.8245">Registrierungs-Dienst</text><rect fill="#EFEFFF" height="20.3331" rx="1.3635" ry="1.3635" style="stroke:#000000;stroke-width:0.27269810715431503;" width="125.9865" x="340.3272" y="744.9601"/><text fill="#000000" font-family="Impact" font-size="10.9079" lengthAdjust="spacing" textLength="118.351" x="344.145" y="758.9029">Registrierungs-Dienst</text><rect fill="#EFEFFF" height="20.3331" rx="1.3635" ry="1.3635" style="stroke:#000000;stroke-width:0.27269810715431503;" width="116.7148" x="554.9406" y="16.8817"/><text fill="#000000" font-family="Impact" font-size="10.9079" lengthAdjust="spacing" textLength="58.9028" x="583.8466" y="30.8245">FHIR-Proxy</text><rect fill="#EFEFFF" height="20.3331" rx="1.3635" ry="1.3635" style="stroke:#000000;stroke-width:0.27269810715431503;" width="116.7148" x="554.9406" y="744.9601"/><text fill="#000000" font-family="Impact" font-size="10.9079" lengthAdjust="spacing" textLength="58.9028" x="583.8466" y="758.9029">FHIR-Proxy</text><rect fill="#EFEFFF" height="20.3331" rx="1.3635" ry="1.3635" style="stroke:#000000;stroke-width:0.27269810715431503;" width="116.7148" x="691.8351" y="16.8817"/><text fill="#000000" font-family="Impact" font-size="10.9079" lengthAdjust="spacing" textLength="77.9917" x="711.1967" y="30.8245">OAuth Service</text><rect fill="#EFEFFF" height="20.3331" rx="1.3635" ry="1.3635" style="stroke:#000000;stroke-width:0.27269810715431503;" width="116.7148" x="691.8351" y="744.9601"/><text fill="#000000" font-family="Impact" font-size="10.9079" lengthAdjust="spacing" textLength="77.9917" x="711.1967" y="758.9029">OAuth Service</text><rect fill="#DCDCDC" height="675.0216" style="stroke:#000000;stroke-width:0.5453962143086301;" width="5.454" x="71.9923" y="43.2141"/><rect fill="#DCDCDC" height="18.4284" style="stroke:#000000;stroke-width:0.5453962143086301;" width="5.454" x="273.2435" y="699.8073"/><rect fill="#DCDCDC" height="544.8338" style="stroke:#000000;stroke-width:0.5453962143086301;" width="5.454" x="400.5935" y="195.7632"/><rect fill="#DCDCDC" height="128.4536" style="stroke:#000000;stroke-width:0.5453962143086301;" width="5.454" x="610.5711" y="303.7047"/><rect fill="#DCDCDC" height="43.947" style="stroke:#000000;stroke-width:0.5453962143086301;" width="5.454" x="747.4655" y="322.1332"/><path d="M17.4527,59.576 L17.4527,86.3004 L332.6917,86.3004 L332.6917,65.03 L327.2377,59.576 L17.4527,59.576 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.27269810715431503;"/><path d="M327.2377,59.576 L327.2377,65.03 L332.6917,65.03 L327.2377,59.576 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.27269810715431503;"/><text fill="#000000" font-family="sans-serif" font-size="9.2717" lengthAdjust="spacing" textLength="228.521" x="56.9939" y="70.9092">Überprüfe, ob eingehender Matrix-Request an den</text><text fill="#000000" font-family="sans-serif" font-size="9.2717" lengthAdjust="spacing" textLength="213.2499" x="56.9939" y="81.7021">Matrix-Homeserver weitergeleitet werden darf</text><line style="stroke:#000000;stroke-width:0.5453962143086301;" x1="77.4463" x2="100.3529" y1="127.8358" y2="127.8358"/><line style="stroke:#000000;stroke-width:0.5453962143086301;" x1="100.3529" x2="100.3529" y1="127.8358" y2="134.9259"/><line style="stroke:#000000;stroke-width:0.5453962143086301;" x1="77.9917" x2="100.3529" y1="134.9259" y2="134.9259"/><polygon fill="#000000" points="83.4456,132.7443,77.9917,134.9259,83.4456,137.1075,81.264,134.9259" style="stroke:#000000;stroke-width:0.5453962143086301;"/><text fill="#000000" font-family="sans-serif" font-size="9.2717" lengthAdjust="spacing" textLength="164.7097" x="81.264" y="113.7654">prüfe Föderationsliste auf Aktualität</text><text fill="#000000" font-family="sans-serif" font-size="9.2717" lengthAdjust="spacing" textLength="188.1617" x="81.264" y="124.5583">und ob Domain in der Liste vorhanden ist</text><path d="M5.454,156.7418 L43.6317,156.7418 L43.6317,160.632 L38.1777,166.0859 L5.454,166.0859 L5.454,156.7418 " fill="#D3D3D3" style="stroke:#000000;stroke-width:0.818094321462945;"/><rect fill="none" height="422.5542" style="stroke:#000000;stroke-width:0.818094321462945;" width="841.8191" x="5.454" y="156.7418"/><text fill="#000000" font-family="sans-serif" font-size="7.0902" font-weight="bold" lengthAdjust="spacing" textLength="13.6349" x="13.6349" y="163.8684">opt</text><text fill="#000000" font-family="sans-serif" font-size="5.9994" font-weight="bold" lengthAdjust="spacing" textLength="2.727" x="51.8126" y="166.5757">[</text><text fill="#000000" font-family="sans-serif" font-size="8.7263" font-weight="bold" lengthAdjust="spacing" textLength="433.0446" x="54.5396" y="165.9325">Föderationsliste des Messenger-Proxy nicht aktuell || Domain nicht in der Liste enthalten</text><text fill="#000000" font-family="sans-serif" font-size="5.9994" font-weight="bold" lengthAdjust="spacing" textLength="2.727" x="487.5842" y="166.5757">]</text><polygon fill="#000000" points="394.0488,193.5816,399.5027,195.7632,394.0488,197.9447,396.2303,195.7632" style="stroke:#000000;stroke-width:0.5453962143086301;"/><line style="stroke:#000000;stroke-width:0.5453962143086301;" x1="77.4463" x2="397.3211" y1="195.7632" y2="195.7632"/><text fill="#000000" font-family="sans-serif" font-size="9.2717" lengthAdjust="spacing" textLength="89.445" x="81.264" y="192.4857">GET /FederationList</text><line style="stroke:#000000;stroke-width:0.5453962143086301;" x1="406.0475" x2="428.9541" y1="224.9845" y2="224.9845"/><line style="stroke:#000000;stroke-width:0.5453962143086301;" x1="428.9541" x2="428.9541" y1="224.9845" y2="232.0746"/><line style="stroke:#000000;stroke-width:0.5453962143086301;" x1="406.5929" x2="428.9541" y1="232.0746" y2="232.0746"/><polygon fill="#000000" points="412.0468,229.893,406.5929,232.0746,412.0468,234.2562,409.8653,232.0746" style="stroke:#000000;stroke-width:0.5453962143086301;"/><text fill="#000000" font-family="sans-serif" font-size="9.2717" lengthAdjust="spacing" textLength="71.9923" x="409.8653" y="210.9141">prüfe Aktualität</text><text fill="#000000" font-family="sans-serif" font-size="9.2717" lengthAdjust="spacing" textLength="89.9904" x="409.8653" y="221.707">der Föderationsliste</text><path d="M10.9079,253.8905 L45.8133,253.8905 L45.8133,257.7807 L40.3593,263.2346 L10.9079,263.2346 L10.9079,253.8905 " fill="#D3D3D3" style="stroke:#000000;stroke-width:0.818094321462945;"/><rect fill="none" height="258.0065" style="stroke:#000000;stroke-width:0.818094321462945;" width="830.9111" x="10.9079" y="253.8905"/><text fill="#000000" font-family="sans-serif" font-size="7.0902" font-weight="bold" lengthAdjust="spacing" textLength="10.3625" x="19.0889" y="261.0171">alt</text><text fill="#000000" font-family="sans-serif" font-size="5.9994" font-weight="bold" lengthAdjust="spacing" textLength="2.727" x="53.9942" y="263.7244">[</text><text fill="#000000" font-family="sans-serif" font-size="8.7263" font-weight="bold" lengthAdjust="spacing" textLength="278.6975" x="56.7212" y="263.0812">Föderationsliste im Registrierungs-Dienst ist nicht aktuell</text><text fill="#000000" font-family="sans-serif" font-size="5.9994" font-weight="bold" lengthAdjust="spacing" textLength="2.727" x="335.4187" y="263.7244">]</text><polygon fill="#000000" points="604.0263,301.5231,609.4803,303.7047,604.0263,305.8863,606.2079,303.7047" style="stroke:#000000;stroke-width:0.5453962143086301;"/><line style="stroke:#000000;stroke-width:0.5453962143086301;" x1="406.0475" x2="607.2987" y1="303.7047" y2="303.7047"/><text fill="#000000" font-family="sans-serif" font-size="9.2717" lengthAdjust="spacing" textLength="145.0754" x="409.8653" y="289.6344">OAuth Client Credentional Flow</text><text fill="#000000" font-family="sans-serif" font-size="9.2717" lengthAdjust="spacing" textLength="59.4482" x="409.8653" y="300.4273">(Credentials)</text><polygon fill="#000000" points="740.9208,319.9516,746.3747,322.1332,740.9208,324.3147,743.1023,322.1332" style="stroke:#000000;stroke-width:0.5453962143086301;"/><line style="stroke:#000000;stroke-width:0.5453962143086301;" x1="616.025" x2="744.1931" y1="322.1332" y2="322.1332"/><text fill="#000000" font-family="sans-serif" font-size="9.2717" lengthAdjust="spacing" textLength="63.8114" x="619.8428" y="318.8557">HTTP Forward</text><line style="stroke:#000000;stroke-width:0.5453962143086301;" x1="752.9195" x2="775.8261" y1="340.5616" y2="340.5616"/><line style="stroke:#000000;stroke-width:0.5453962143086301;" x1="775.8261" x2="775.8261" y1="340.5616" y2="347.6517"/><line style="stroke:#000000;stroke-width:0.5453962143086301;" x1="753.4649" x2="775.8261" y1="347.6517" y2="347.6517"/><polygon fill="#000000" points="758.9188,345.4702,753.4649,347.6517,758.9188,349.8333,756.7372,347.6517" style="stroke:#000000;stroke-width:0.5453962143086301;"/><text fill="#000000" font-family="sans-serif" font-size="9.2717" lengthAdjust="spacing" textLength="78.5371" x="756.7372" y="337.2842">prüfe Credentials</text><polygon fill="#000000" points="622.0244,363.8986,616.5704,366.0802,622.0244,368.2618,619.8428,366.0802" style="stroke:#000000;stroke-width:0.5453962143086301;"/><line style="stroke:#000000;stroke-width:0.5453962143086301;stroke-dasharray:2.0,2.0;" x1="618.752" x2="749.6471" y1="366.0802" y2="366.0802"/><text fill="#000000" font-family="sans-serif" font-size="9.2717" lengthAdjust="spacing" textLength="118.351" x="628.0237" y="362.8027">Accesstoken (30 Minuten)</text><polygon fill="#000000" points="412.0468,382.327,406.5929,384.5086,412.0468,386.6902,409.8653,384.5086" style="stroke:#000000;stroke-width:0.5453962143086301;"/><line style="stroke:#000000;stroke-width:0.5453962143086301;stroke-dasharray:2.0,2.0;" x1="408.7745" x2="610.0257" y1="384.5086" y2="384.5086"/><text fill="#000000" font-family="sans-serif" font-size="9.2717" lengthAdjust="spacing" textLength="153.2563" x="453.497" y="381.2312">Status, Accesstoken (30 Minuten)</text><polygon fill="#000000" points="604.0263,411.5483,609.4803,413.7299,604.0263,415.9115,606.2079,413.7299" style="stroke:#000000;stroke-width:0.5453962143086301;"/><line style="stroke:#000000;stroke-width:0.5453962143086301;" x1="406.0475" x2="607.2987" y1="413.7299" y2="413.7299"/><text fill="#000000" font-family="sans-serif" font-size="9.2717" lengthAdjust="spacing" textLength="188.7071" x="409.8653" y="399.6596">GET /tim-provider-services/FederationList</text><text fill="#000000" font-family="sans-serif" font-size="9.2717" lengthAdjust="spacing" textLength="62.7206" x="409.8653" y="410.4525">(Accesstoken)</text><polygon fill="#000000" points="412.0468,429.9767,406.5929,432.1583,412.0468,434.3399,409.8653,432.1583" style="stroke:#000000;stroke-width:0.5453962143086301;"/><line style="stroke:#000000;stroke-width:0.5453962143086301;stroke-dasharray:2.0,2.0;" x1="408.7745" x2="612.7526" y1="432.1583" y2="432.1583"/><text fill="#000000" font-family="sans-serif" font-size="9.2717" lengthAdjust="spacing" textLength="80.1732" x="529.307" y="428.8809">Föderationsliste[]</text><polygon fill="#000000" points="83.4456,448.4052,77.9917,450.5868,83.4456,452.7683,81.264,450.5868" style="stroke:#000000;stroke-width:0.5453962143086301;"/><line style="stroke:#000000;stroke-width:0.5453962143086301;stroke-dasharray:2.0,2.0;" x1="80.1732" x2="400.0481" y1="450.5868" y2="450.5868"/><text fill="#000000" font-family="sans-serif" font-size="9.2717" lengthAdjust="spacing" textLength="80.1732" x="316.6025" y="447.3093">Föderationsliste[]</text><line style="stroke:#000000;stroke-width:0.5453962143086301;stroke-dasharray:2.0,2.0;" x1="10.9079" x2="841.8191" y1="469.1302" y2="469.1302"/><text fill="#000000" font-family="sans-serif" font-size="5.9994" font-weight="bold" lengthAdjust="spacing" textLength="2.727" x="13.6349" y="477.8733">[</text><text fill="#000000" font-family="sans-serif" font-size="8.7263" font-weight="bold" lengthAdjust="spacing" textLength="251.4277" x="16.3619" y="477.2302">Föderationsliste im Registrierungs-Dienst ist aktuell</text><text fill="#000000" font-family="sans-serif" font-size="5.9994" font-weight="bold" lengthAdjust="spacing" textLength="2.727" x="267.7895" y="477.8733">]</text><polygon fill="#000000" points="83.4456,505.3522,77.9917,507.5338,83.4456,509.7154,81.264,507.5338" style="stroke:#000000;stroke-width:0.5453962143086301;"/><line style="stroke:#000000;stroke-width:0.5453962143086301;stroke-dasharray:2.0,2.0;" x1="80.1732" x2="400.0481" y1="507.5338" y2="507.5338"/><text fill="#000000" font-family="sans-serif" font-size="9.2717" lengthAdjust="spacing" textLength="80.1732" x="316.6025" y="504.2563">Föderationsliste[]</text><line style="stroke:#000000;stroke-width:0.5453962143086301;" x1="77.4463" x2="100.3529" y1="554.2078" y2="554.2078"/><line style="stroke:#000000;stroke-width:0.5453962143086301;" x1="100.3529" x2="100.3529" y1="554.2078" y2="561.2979"/><line style="stroke:#000000;stroke-width:0.5453962143086301;" x1="77.9917" x2="100.3529" y1="561.2979" y2="561.2979"/><polygon fill="#000000" points="83.4456,559.1163,77.9917,561.2979,83.4456,563.4795,81.264,561.2979" style="stroke:#000000;stroke-width:0.5453962143086301;"/><text fill="#000000" font-family="sans-serif" font-size="9.2717" lengthAdjust="spacing" textLength="124.8957" x="81.264" y="540.1375">prüfe Domainzugehörigkeit</text><text fill="#000000" font-family="sans-serif" font-size="9.2717" lengthAdjust="spacing" textLength="105.2615" x="81.264" y="550.9303">der beteiligten Akteure</text><path d="M10.9079,600.5665 L45.8133,600.5665 L45.8133,604.4567 L40.3593,609.9106 L10.9079,609.9106 L10.9079,600.5665 " fill="#D3D3D3" style="stroke:#000000;stroke-width:0.818094321462945;"/><rect fill="none" height="135.6673" style="stroke:#000000;stroke-width:0.818094321462945;" width="328.8739" x="10.9079" y="600.5665"/><text fill="#000000" font-family="sans-serif" font-size="7.0902" font-weight="bold" lengthAdjust="spacing" textLength="10.3625" x="19.0889" y="607.6931">alt</text><text fill="#000000" font-family="sans-serif" font-size="5.9994" font-weight="bold" lengthAdjust="spacing" textLength="2.727" x="53.9942" y="610.4004">[</text><text fill="#000000" font-family="sans-serif" font-size="8.7263" font-weight="bold" lengthAdjust="spacing" textLength="116.7148" x="56.7212" y="609.7572">Domain nicht berechtigt</text><text fill="#000000" font-family="sans-serif" font-size="5.9994" font-weight="bold" lengthAdjust="spacing" textLength="2.727" x="173.436" y="610.4004">]</text><path d="M17.4527,628.2496 L17.4527,644.0661 L332.6917,644.0661 L332.6917,633.7035 L327.2377,628.2496 L17.4527,628.2496 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.27269810715431503;"/><path d="M327.2377,628.2496 L327.2377,633.7035 L332.6917,633.7035 L327.2377,628.2496 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.27269810715431503;"/><text fill="#000000" font-family="sans-serif" font-size="9.2717" lengthAdjust="spacing" textLength="166.3458" x="89.445" y="639.5828">Abbruch, Verbindung wird abgelehnt</text><line style="stroke:#000000;stroke-width:0.5453962143086301;stroke-dasharray:2.0,2.0;" x1="10.9079" x2="339.7818" y1="661.4037" y2="661.4037"/><text fill="#000000" font-family="sans-serif" font-size="5.9994" font-weight="bold" lengthAdjust="spacing" textLength="2.727" x="13.6349" y="670.1468">[</text><text fill="#000000" font-family="sans-serif" font-size="8.7263" font-weight="bold" lengthAdjust="spacing" textLength="89.445" x="16.3619" y="669.5037">Domain berechtigt</text><text fill="#000000" font-family="sans-serif" font-size="5.9994" font-weight="bold" lengthAdjust="spacing" textLength="2.727" x="105.8069" y="670.1468">]</text><polygon fill="#000000" points="266.6987,697.6257,272.1527,699.8073,266.6987,701.9888,268.8803,699.8073" style="stroke:#000000;stroke-width:0.5453962143086301;"/><line style="stroke:#000000;stroke-width:0.5453962143086301;" x1="77.4463" x2="269.9711" y1="699.8073" y2="699.8073"/><text fill="#000000" font-family="sans-serif" font-size="9.2717" lengthAdjust="spacing" textLength="63.8114" x="81.264" y="696.5298">HTTP Forward</text><polygon fill="#000000" points="80.7186,716.0541,75.2647,718.2357,80.7186,720.4173,78.5371,718.2357" style="stroke:#000000;stroke-width:0.5453962143086301;"/><line style="stroke:#000000;stroke-width:0.5453962143086301;stroke-dasharray:2.0,2.0;" x1="77.4463" x2="275.4251" y1="718.2357" y2="718.2357"/><text fill="#000000" font-family="sans-serif" font-size="9.2717" lengthAdjust="spacing" textLength="29.4514" x="242.7013" y="714.9582">Status</text><!--MD5=[0381cb2b5829ce9893f69909e8355822]
=======
<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1160px" preserveAspectRatio="none" style="width:1056px;height:1160px;background:#FFFFFF;" version="1.1" viewBox="0 0 1056 1160" width="1056px" zoomAndPan="magnify"><defs/><g><rect fill="#F5F5F5" height="1148.4063" style="stroke:#181818;stroke-width:0.5;" width="792" x="26" y="6"/><text fill="#000000" font-family="sans-serif" font-size="18" font-weight="bold" lengthAdjust="spacing" textLength="193" x="325.5" y="22.708">Messenger-Service</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="5" x="325.5" y="39.02"> </text><rect fill="#DCDCDC" height="943.7578" style="stroke:#000000;stroke-width:1.0;" width="10" x="132" y="94.3672"/><rect fill="#DCDCDC" height="33.7891" style="stroke:#000000;stroke-width:1.0;" width="10" x="461" y="834.1328"/><rect fill="#DCDCDC" height="33.7891" style="stroke:#000000;stroke-width:1.0;" width="10" x="461" y="1004.3359"/><rect fill="#F0F8FF" height="698.7578" style="stroke:#000000;stroke-width:1.5;" width="1039" x="10" y="372.3672"/><rect fill="#ADD8E6" height="255.75" style="stroke:#000000;stroke-width:1.5;" width="596" x="20" y="645.1719"/><rect fill="#ADD8E6" height="138.2031" style="stroke:none;stroke-width:1.0;" width="596" x="20" y="762.7188"/><rect fill="#F0F8FF" height="138.2031" style="stroke:none;stroke-width:1.0;" width="1039" x="10" y="932.9219"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="137" x2="137" y1="84.3672" y2="1113.125"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="466" x2="466" y1="84.3672" y2="1113.125"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="698" x2="698" y1="84.3672" y2="1113.125"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="932" x2="932" y1="84.3672" y2="1113.125"/><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="214" x="30" y="46.0859"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="168" x="53" y="71.6504">Messenger-Proxy</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="214" x="30" y="1112.125"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="168" x="53" y="1137.6895">Messenger-Proxy</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="214" x="359" y="46.0859"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="189" x="371.5" y="71.6504">Matrix-Homeserver</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="214" x="359" y="1112.125"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="189" x="371.5" y="1137.6895">Matrix-Homeserver</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="231" x="583" y="46.0859"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="217" x="590" y="71.6504">Registrierungs-Dienst</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="231" x="583" y="1112.125"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="217" x="590" y="1137.6895">Registrierungs-Dienst</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="214" x="825" y="46.0859"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="195" x="834.5" y="71.6504">VZD-FHIR-Directory</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="214" x="825" y="1112.125"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="195" x="834.5" y="1137.6895">VZD-FHIR-Directory</text><rect fill="#DCDCDC" height="943.7578" style="stroke:#000000;stroke-width:1.0;" width="10" x="132" y="94.3672"/><rect fill="#DCDCDC" height="33.7891" style="stroke:#000000;stroke-width:1.0;" width="10" x="461" y="834.1328"/><rect fill="#DCDCDC" height="33.7891" style="stroke:#000000;stroke-width:1.0;" width="10" x="461" y="1004.3359"/><path d="M32,124.3672 L32,203.3672 L570,203.3672 L570,134.3672 L560,124.3672 L32,124.3672 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M560,124.3672 L560,134.3672 L570,134.3672 L560,124.3672 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="66.5" y="141.4341"> </text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="455" x="66.5" y="160.2798">Überprüfe, ob eingehender Matrix-Invite-Event an den</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="391" x="66.5" y="180.0688">Matrix-Homeserver weitergeleitet werden darf</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="66.5" y="196.145"> </text><line style="stroke:#000000;stroke-width:1.0;" x1="142" x2="184" y1="319.3672" y2="319.3672"/><line style="stroke:#000000;stroke-width:1.0;" x1="184" x2="184" y1="319.3672" y2="332.3672"/><line style="stroke:#000000;stroke-width:1.0;" x1="143" x2="184" y1="332.3672" y2="332.3672"/><polygon fill="#000000" points="153,328.3672,143,332.3672,153,336.3672,149,332.3672" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="200" x="149" y="253.9907">prüfe ob Matrix-Domain</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="79" x="149" y="273.7798">der MXID</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="186" x="149" y="293.5688">in der Föderationsliste</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="115" x="149" y="313.3579">vorhanden ist</text><path d="M10,372.3672 L74,372.3672 L74,379.5 L64,389.5 L10,389.5 L10,372.3672 " fill="#D3D3D3" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="698.7578" style="stroke:#000000;stroke-width:1.5;" width="1039" x="10" y="372.3672"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="25" y="385.4341">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="89" y="390.3979">[</text><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="502" x="94" y="389.2188">Matrix-Domain ist nicht in der Föderationsliste enthalten</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="596" y="390.3979">]</text><rect height="58.8906" style="stroke:#000000;stroke-width:1.5;fill:none;" width="1015" x="27" y="418.125"/><path d="M27,418.125 L93,418.125 L93,425.125 L83,435.125 L27,435.125 L27,418.125 " fill="#98FB98" style="stroke:#000000;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21" x="40" y="432.1919">ref</text><text fill="#000000" font-family="sans-serif" font-size="17" font-weight="bold" lengthAdjust="spacing" textLength="88" x="337" y="454.9048">Anhang B</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="302" x="430" y="454.9048">- Aktualisierung der Föderationsliste</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="532.5" y="470.0527"> </text><line style="stroke:#000000;stroke-width:1.0;" x1="142" x2="184" y1="592.1719" y2="592.1719"/><line style="stroke:#000000;stroke-width:1.0;" x1="184" x2="184" y1="592.1719" y2="605.1719"/><line style="stroke:#000000;stroke-width:1.0;" x1="143" x2="184" y1="605.1719" y2="605.1719"/><polygon fill="#000000" points="153,601.1719,143,605.1719,153,609.1719,149,605.1719" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="200" x="149" y="526.7954">prüfe ob Matrix-Domain</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="79" x="149" y="546.5845">der MXID</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="48" x="149" y="566.3735">in der</text><text fill="#000000" font-family="sans-serif" font-size="17" font-weight="bold" lengthAdjust="spacing" textLength="128" x="202" y="566.3735">aktualisierten</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="5" x="330" y="566.3735"> </text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="253" x="149" y="586.1626">Föderationsliste vorhanden ist</text><path d="M20,645.1719 L84,645.1719 L84,652.3047 L74,662.3047 L20,662.3047 L20,645.1719 " fill="#D3D3D3" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="255.75" style="stroke:#000000;stroke-width:1.5;" width="596" x="20" y="645.1719"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="35" y="658.2388">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="99" y="663.2026">[</text><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="502" x="104" y="662.0234">Matrix-Domain ist nicht in der Föderationsliste enthalten</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="606" y="663.2026">]</text><line style="stroke:#000000;stroke-width:1.0;" x1="142" x2="184" y1="716.7188" y2="716.7188"/><line style="stroke:#000000;stroke-width:1.0;" x1="184" x2="184" y1="716.7188" y2="729.7188"/><line style="stroke:#000000;stroke-width:1.0;" x1="143" x2="184" y1="729.7188" y2="729.7188"/><polygon fill="#000000" points="153,725.7188,143,729.7188,153,733.7188,149,729.7188" style="stroke:#000000;stroke-width:1.0;"/><text fill="#FF0000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="305" x="149" y="710.7095">Abbruch, Verbindung wird abgelehnt</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="20" x2="616" y1="763.7188" y2="763.7188"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="25" y="779.7495">[</text><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="452" x="30" y="778.5703">Matrix-Domain ist in der Föderationsliste enthalten</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="482" y="779.7495">]</text><polygon fill="#000000" points="449,830.1328,459,834.1328,449,838.1328,453,834.1328" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="142" x2="455" y1="834.1328" y2="834.1328"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="142" x="149" y="828.1235">HTTP(S) Forward</text><polygon fill="#000000" points="153,863.9219,143,867.9219,153,871.9219,149,867.9219" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="147" x2="465" y1="867.9219" y2="867.9219"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="54" x="405" y="861.9126">Status</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="10" x2="1049" y1="933.9219" y2="933.9219"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="15" y="949.9526">[</text><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="452" x="20" y="948.7734">Matrix-Domain ist in der Föderationsliste enthalten</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="472" y="949.9526">]</text><polygon fill="#000000" points="449,1000.3359,459,1004.3359,449,1008.3359,453,1004.3359" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="142" x2="455" y1="1004.3359" y2="1004.3359"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="142" x="149" y="998.3267">HTTP(S) Forward</text><polygon fill="#000000" points="148,1034.125,138,1038.125,148,1042.125,144,1038.125" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="142" x2="465" y1="1038.125" y2="1038.125"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="54" x="405" y="1032.1157">Status</text><!--MD5=[7476f5e718d8b2d1db83ab05c6c0ad41]
>>>>>>> master
@startuml
skinparam sequenceMessageAlign direction
skinparam minClassWidth 200
skinparam BoxPadding 1
skinparam sequenceReferenceHeaderBackgroundColor palegreen
<<<<<<< HEAD
scale max 850 width
=======
scale max 2048 width
>>>>>>> master

skinparam sequence {
ArrowColor black
ArrowFontSize 17
ActorBorderColor black
LifeLineBorderColor black
LifeLineBackgroundColor Gainsboro

ParticipantBorderColor Motivation
ParticipantBackgroundColor Motivation
ParticipantFontName Impact
ParticipantFontSize 20
ParticipantFontColor black
ParticipantBorderColor Black
ParticipantBackgroundColor MOTIVATION

ActorBackgroundColor Gainsboro
ActorFontColor black
ActorFontSize 20
ActorFontName Aapex
}
<<<<<<< HEAD
    box <size:18>Messenger-Service</size> #WhiteSmoke
    participant MP as "Messenger-Proxy"
    participant MH as "Matrix-Homeserver"
    end box
    participant RD as "Registrierungs-Dienst"
    box <size:18>VZD-FHIR-Directory</size> #WhiteSmoke
      participant FP as "FHIR-Proxy"
      participant AS as "OAuth Service"
    end box

|||
note over MP, MH: <size:17>Überprüfe, ob eingehender Matrix-Request an den \n<size:17>Matrix-Homeserver weitergeleitet werden darf</size>
|||

    Activate MP
  MP->MP: prüfe Föderationsliste auf Aktualität \nund ob Domain in der Liste vorhanden ist

|||
opt#LightGrey #AliceBlue <size:16>Föderationsliste des Messenger-Proxy nicht aktuell || Domain nicht in der Liste enthalten</size>
|||  

  MP->RD: GET /FederationList
    Activate RD
  RD->RD: prüfe Aktualität \nder Föderationsliste
  
  |||
  alt#LightGrey #MistyRose <size:16>Föderationsliste im Registrierungs-Dienst ist nicht aktuell</size>
  ||| 
  
    RD->FP: OAuth Client Credentional Flow \n(Credentials)
        Activate FP
    FP->AS: HTTP Forward
      Activate AS
    AS->AS: prüfe Credentials
    AS- ->FP: Accesstoken (30 Minuten)
      Deactivate AS
    FP- ->RD: Status, Accesstoken (30 Minuten)
    RD->FP: GET /tim-provider-services/FederationList \n(Accesstoken)
    FP- ->RD: Föderationsliste[]
      Deactivate FP
    RD- ->MP: Föderationsliste[]

      |||
      else <size:16>Föderationsliste im Registrierungs-Dienst ist aktuell</size>
      |||
        RD- ->MP: Föderationsliste[]
  end
  
  |||
  MP->MP: prüfe Domainzugehörigkeit \nder beteiligten Akteure
  |||
  
end

|||
alt#LightGrey #AliceBlue <size:16>Domain nicht berechtigt</size>
|||  

  note over MP, MH: <size:17>Abbruch, Verbindung wird abgelehnt</size>
  ||| 
  
  else <size:16>Domain berechtigt</size>
    ||| 
    MP->MH: HTTP Forward
=======
    box <size:18>Messenger-Service\n#WhiteSmoke
    participant MP as "Messenger-Proxy"
    participant MH as "Matrix-Homeserver"
    participant RD as "Registrierungs-Dienst"
    end box
    participant VZD as "VZD-FHIR-Directory"

|||
note over MP, MH: \n<size:17>Überprüfe, ob eingehender Matrix-Invite-Event an den \n<size:17>Matrix-Homeserver weitergeleitet werden darf</size>\n
|||

    Activate MP
  MP->MP: prüfe ob Matrix-Domain \nder MXID \nin der Föderationsliste \nvorhanden ist

|||
alt#LightGrey #AliceBlue <size:16>Matrix-Domain ist nicht in der Föderationsliste enthalten</size>
|||  

  ref over MP, VZD: <size:17>**Anhang B** - Aktualisierung der Föderationsliste</size>\n 
  |||
  MP->MP: prüfe ob Matrix-Domain \nder MXID \nin der **aktualisierten** \nFöderationsliste vorhanden ist
  |||

    alt#LightGrey #LightBlue <size:16>Matrix-Domain ist nicht in der Föderationsliste enthalten</size>
      |||
      MP->MP: <font color=red>Abbruch, Verbindung wird abgelehnt</font>
      ||| 
      else <size:16>Matrix-Domain ist in der Föderationsliste enthalten</size>
      |||
         MP->MH: HTTP(S) Forward
          Activate MH
        MH- ->MP: Status
          Deactivate MH
      |||
    end

  |||
  else <size:16>Matrix-Domain ist in der Föderationsliste enthalten</size>
    ||| 
    MP->MH: HTTP(S) Forward
>>>>>>> master
      Activate MH
    MH- ->MP: Status
      Deactivate MH
      Deactivate MP
    ||| 

end
<<<<<<< HEAD
=======
|||
>>>>>>> master
@enduml

PlantUML version 1.2022.5(Sat Apr 30 10:55:52 UTC 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>