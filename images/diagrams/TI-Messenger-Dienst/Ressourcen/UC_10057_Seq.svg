<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="2849px" preserveAspectRatio="none" style="width:1265px;height:2849px;background:#FFFFFF;" version="1.1" viewBox="0 0 1265 2849" width="1265px" zoomAndPan="magnify"><defs><filter height="300%" id="f1j8q0vltx84ck" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#F5F5F5" height="2837.5703" style="stroke:#A80036;stroke-width:1.0;" width="466" x="513.5" y="6"/><text fill="#000000" font-family="sans-serif" font-size="18" font-weight="bold" lengthAdjust="spacing" textLength="193" x="647.5" y="22.708">Messenger-Service</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="0" x="845.5" y="23.8872"/><rect fill="#F5F5F5" height="2837.5703" style="stroke:#A80036;stroke-width:1.0;" width="226" x="983.5" y="6"/><text fill="#000000" font-family="sans-serif" font-size="18" font-weight="bold" lengthAdjust="spacing" textLength="200" x="994" y="22.708">VZD-FHIR-Directory</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="0" x="1199" y="23.8872"/><rect fill="#DCDCDC" filter="url(#f1j8q0vltx84ck)" height="2440.6563" style="stroke:#000000;stroke-width:1.0;" width="10" x="373.5" y="179.3516"/><rect fill="#DCDCDC" filter="url(#f1j8q0vltx84ck)" height="628.6406" style="stroke:#000000;stroke-width:1.0;" width="10" x="621.5" y="213.1406"/><rect fill="#DCDCDC" filter="url(#f1j8q0vltx84ck)" height="633.1719" style="stroke:#000000;stroke-width:1.0;" width="10" x="621.5" y="1034.7266"/><rect fill="#DCDCDC" filter="url(#f1j8q0vltx84ck)" height="167.9453" style="stroke:#000000;stroke-width:1.0;" width="10" x="621.5" y="1857.8438"/><rect fill="#DCDCDC" filter="url(#f1j8q0vltx84ck)" height="186.9453" style="stroke:#000000;stroke-width:1.0;" width="10" x="861.5" y="621.0469"/><rect fill="#DCDCDC" filter="url(#f1j8q0vltx84ck)" height="565.5938" style="stroke:#000000;stroke-width:1.0;" width="10" x="861.5" y="1068.5156"/><rect fill="#DCDCDC" filter="url(#f1j8q0vltx84ck)" height="100.3672" style="stroke:#000000;stroke-width:1.0;" width="10" x="861.5" y="1891.6328"/><rect fill="#DCDCDC" filter="url(#f1j8q0vltx84ck)" height="481.8516" style="stroke:#000000;stroke-width:1.0;" width="10" x="1091.5" y="2084.5781"/><rect fill="#F0F8FF" filter="url(#f1j8q0vltx84ck)" height="2293.5" style="stroke:#000000;stroke-width:2.0;" width="1241.5" x="10" y="391.5078"/><rect fill="#F0F8FF" height="2135.375" style="stroke:none;stroke-width:1.0;" width="1241.5" x="10" y="549.6328"/><rect fill="#FFE4E1" filter="url(#f1j8q0vltx84ck)" height="186.7031" style="stroke:#000000;stroke-width:2.0;" width="965.5" x="20" y="1175.0938"/><rect fill="#ADD8E6" filter="url(#f1j8q0vltx84ck)" height="422.2734" style="stroke:#000000;stroke-width:2.0;" width="1195.5" x="20" y="2230.7344"/><rect fill="#ADD8E6" height="157.9922" style="stroke:none;stroke-width:1.0;" width="1195.5" x="20" y="2495.0156"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="126" x2="126" y1="118.5625" y2="2727.0078"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="378.5" x2="378.5" y1="118.5625" y2="2727.0078"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="626.5" x2="626.5" y1="118.5625" y2="2727.0078"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="866.5" x2="866.5" y1="118.5625" y2="2727.0078"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1096.5" x2="1096.5" y1="118.5625" y2="2727.0078"/><text fill="#000000" font-family="Aapex" font-size="20" lengthAdjust="spacing" textLength="187" x="30" y="90.5645">Akteur in der Rolle</text><text fill="#000000" font-family="Aapex" font-size="20" lengthAdjust="spacing" textLength="159" x="44" y="113.8457">User / User-HBA</text><ellipse cx="126.5" cy="15" fill="#DCDCDC" filter="url(#f1j8q0vltx84ck)" rx="8" ry="8" style="stroke:#000000;stroke-width:2.0;"/><path d="M126.5,23 L126.5,50 M113.5,31 L139.5,31 M126.5,50 L113.5,65 M126.5,50 L139.5,65 " fill="none" filter="url(#f1j8q0vltx84ck)" style="stroke:#000000;stroke-width:2.0;"/><text fill="#000000" font-family="Aapex" font-size="20" lengthAdjust="spacing" textLength="187" x="30" y="2744.5723">Akteur in der Rolle</text><text fill="#000000" font-family="Aapex" font-size="20" lengthAdjust="spacing" textLength="159" x="44" y="2767.8535">User / User-HBA</text><ellipse cx="126.5" cy="2782.5703" fill="#DCDCDC" filter="url(#f1j8q0vltx84ck)" rx="8" ry="8" style="stroke:#000000;stroke-width:2.0;"/><path d="M126.5,2790.5703 L126.5,2817.5703 M113.5,2798.5703 L139.5,2798.5703 M126.5,2817.5703 L113.5,2832.5703 M126.5,2817.5703 L139.5,2832.5703 " fill="none" filter="url(#f1j8q0vltx84ck)" style="stroke:#000000;stroke-width:2.0;"/><rect fill="#EFEFFF" filter="url(#f1j8q0vltx84ck)" height="37.2813" style="stroke:#000000;stroke-width:1.5;" width="214" x="269.5" y="76.2813"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="198" x="277.5" y="101.8457">TI-Messenger-Client</text><rect fill="#EFEFFF" filter="url(#f1j8q0vltx84ck)" height="37.2813" style="stroke:#000000;stroke-width:1.5;" width="214" x="269.5" y="2726.0078"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="198" x="277.5" y="2751.5723">TI-Messenger-Client</text><rect fill="#EFEFFF" filter="url(#f1j8q0vltx84ck)" height="37.2813" style="stroke:#000000;stroke-width:1.5;" width="214" x="517.5" y="76.2813"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="167" x="541" y="101.8457">Messenger Proxy</text><rect fill="#EFEFFF" filter="url(#f1j8q0vltx84ck)" height="37.2813" style="stroke:#000000;stroke-width:1.5;" width="214" x="517.5" y="2726.0078"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="167" x="541" y="2751.5723">Messenger Proxy</text><rect fill="#EFEFFF" filter="url(#f1j8q0vltx84ck)" height="37.2813" style="stroke:#000000;stroke-width:1.5;" width="214" x="757.5" y="76.2813"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="189" x="770" y="101.8457">Matrix-Homeserver</text><rect fill="#EFEFFF" filter="url(#f1j8q0vltx84ck)" height="37.2813" style="stroke:#000000;stroke-width:1.5;" width="214" x="757.5" y="2726.0078"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="189" x="770" y="2751.5723">Matrix-Homeserver</text><rect fill="#EFEFFF" filter="url(#f1j8q0vltx84ck)" height="37.2813" style="stroke:#000000;stroke-width:1.5;" width="214" x="987.5" y="76.2813"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="128" x="1030.5" y="101.8457">Auth-Service</text><rect fill="#EFEFFF" filter="url(#f1j8q0vltx84ck)" height="37.2813" style="stroke:#000000;stroke-width:1.5;" width="214" x="987.5" y="2726.0078"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="128" x="1030.5" y="2751.5723">Auth-Service</text><rect fill="#DCDCDC" filter="url(#f1j8q0vltx84ck)" height="2440.6563" style="stroke:#000000;stroke-width:1.0;" width="10" x="373.5" y="179.3516"/><rect fill="#DCDCDC" filter="url(#f1j8q0vltx84ck)" height="628.6406" style="stroke:#000000;stroke-width:1.0;" width="10" x="621.5" y="213.1406"/><rect fill="#DCDCDC" filter="url(#f1j8q0vltx84ck)" height="633.1719" style="stroke:#000000;stroke-width:1.0;" width="10" x="621.5" y="1034.7266"/><rect fill="#DCDCDC" filter="url(#f1j8q0vltx84ck)" height="167.9453" style="stroke:#000000;stroke-width:1.0;" width="10" x="621.5" y="1857.8438"/><rect fill="#DCDCDC" filter="url(#f1j8q0vltx84ck)" height="186.9453" style="stroke:#000000;stroke-width:1.0;" width="10" x="861.5" y="621.0469"/><rect fill="#DCDCDC" filter="url(#f1j8q0vltx84ck)" height="565.5938" style="stroke:#000000;stroke-width:1.0;" width="10" x="861.5" y="1068.5156"/><rect fill="#DCDCDC" filter="url(#f1j8q0vltx84ck)" height="100.3672" style="stroke:#000000;stroke-width:1.0;" width="10" x="861.5" y="1891.6328"/><rect fill="#DCDCDC" filter="url(#f1j8q0vltx84ck)" height="481.8516" style="stroke:#000000;stroke-width:1.0;" width="10" x="1091.5" y="2084.5781"/><polygon fill="#000000" points="361.5,175.3516,371.5,179.3516,361.5,183.3516,365.5,179.3516" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="126.5" x2="367.5" y1="179.3516" y2="179.3516"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="228" x="133.5" y="173.3423">Eingabe Messenger-Service</text><polygon fill="#000000" points="609.5,209.1406,619.5,213.1406,609.5,217.1406,613.5,213.1406" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="383.5" x2="615.5" y1="213.1406" y2="213.1406"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="209" x="390.5" y="207.1313">GET /_matrix/client/login</text><line style="stroke:#000000;stroke-width:1.0;" x1="631.5" x2="673.5" y1="246.9297" y2="246.9297"/><line style="stroke:#000000;stroke-width:1.0;" x1="673.5" x2="673.5" y1="246.9297" y2="259.9297"/><line style="stroke:#000000;stroke-width:1.0;" x1="632.5" x2="673.5" y1="259.9297" y2="259.9297"/><polygon fill="#000000" points="642.5,255.9297,632.5,259.9297,642.5,263.9297,638.5,259.9297" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="150" x="638.5" y="240.9204">TLS-Terminierung</text><line style="stroke:#000000;stroke-width:1.0;" x1="631.5" x2="673.5" y1="338.5078" y2="338.5078"/><line style="stroke:#000000;stroke-width:1.0;" x1="673.5" x2="673.5" y1="338.5078" y2="351.5078"/><line style="stroke:#000000;stroke-width:1.0;" x1="632.5" x2="673.5" y1="351.5078" y2="351.5078"/><polygon fill="#000000" points="642.5,347.5078,632.5,351.5078,642.5,355.5078,638.5,351.5078" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="162" x="638.5" y="312.7095">überprüfe client_id,</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="105" x="638.5" y="332.4985">client_secret</text><path d="M10,391.5078 L74,391.5078 L74,398.5078 L64,408.5078 L10,408.5078 L10,391.5078 " fill="#D3D3D3" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="2293.5" style="stroke:#000000;stroke-width:2.0;" width="1241.5" x="10" y="391.5078"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="25" y="404.5747">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="89" y="409.5386">[</text><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="762" x="94" y="408.3594">TI-Messenger Client wird vom Anbieter nicht unterstützt (kein gültiges Client-Secret)</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="856" y="409.5386">]</text><polygon fill="#000000" points="394.5,459.0547,384.5,463.0547,394.5,467.0547,390.5,463.0547" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="388.5" x2="620.5" y1="463.0547" y2="463.0547"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="199" x="415.5" y="457.0454">HTTP 401 Unauthroized</text><polygon fill="#000000" points="137.5,512.6328,127.5,516.6328,137.5,520.6328,133.5,516.6328" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="131.5" x2="372.5" y1="516.6328" y2="516.6328"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="96" x="265.5" y="490.8345">Anmeldung</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="136" x="230.5" y="510.6235">nicht erfolgreich</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="10" x2="1251.5" y1="550.6328" y2="550.6328"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="15" y="566.6636">[</text><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="675" x="20" y="565.4844">TI-Messenger Client wird vom Anbieter unterstützt  (gültiges Client-Secret)</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="695" y="566.6636">]</text><polygon fill="#000000" points="849.5,617.0469,859.5,621.0469,849.5,625.0469,853.5,621.0469" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="631.5" x2="855.5" y1="621.0469" y2="621.0469"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="142" x="638.5" y="615.0376">HTTP(S) Forward</text><path d="M26,659.0469 L26,708.0469 L966,708.0469 L966,669.0469 L956,659.0469 L26,659.0469 " fill="#FBFB77" filter="url(#f1j8q0vltx84ck)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M956,659.0469 L956,669.0469 L966,669.0469 L956,659.0469 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="417" x="270.75" y="679.8267">Die Authentifizierungsverfahren werden für jeden</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="438" x="270.75" y="699.6157">Messenger-Service durch die Organisation festgelegt</text><polygon fill="#000000" points="642.5,803.9922,632.5,807.9922,642.5,811.9922,638.5,807.9922" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="636.5" x2="865.5" y1="807.9922" y2="807.9922"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="104" x="750.5" y="762.4048">unterstützte</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="160" x="699.5" y="782.1938">Authentifizierungs-</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="82" x="777.5" y="801.9829">verfahren</text><polygon fill="#000000" points="394.5,837.7813,384.5,841.7813,394.5,845.7813,390.5,841.7813" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="388.5" x2="625.5" y1="841.7813" y2="841.7813"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="142" x="477.5" y="835.772">HTTP(S) Forward</text><polygon fill="#000000" points="137.5,891.3594,127.5,895.3594,137.5,899.3594,133.5,895.3594" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="131.5" x2="372.5" y1="895.3594" y2="895.3594"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="47" x="314.5" y="869.561">Zeige</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="209" x="157.5" y="889.3501">Authentifizierungsmaske</text><line style="stroke:#000000;stroke-width:1.0;" x1="126.5" x2="168.5" y1="954.1484" y2="954.1484"/><line style="stroke:#000000;stroke-width:1.0;" x1="168.5" x2="168.5" y1="954.1484" y2="967.1484"/><line style="stroke:#000000;stroke-width:1.0;" x1="127.5" x2="168.5" y1="967.1484" y2="967.1484"/><polygon fill="#000000" points="137.5,963.1484,127.5,967.1484,137.5,971.1484,133.5,967.1484" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="203" x="133.5" y="948.1392">Starte Authentifizierung</text><polygon fill="#000000" points="361.5,996.9375,371.5,1000.9375,361.5,1004.9375,365.5,1000.9375" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="126.5" x2="367.5" y1="1000.9375" y2="1000.9375"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="96" x="133.5" y="994.9282">Anmeldung</text><polygon fill="#000000" points="609.5,1030.7266,619.5,1034.7266,609.5,1038.7266,613.5,1034.7266" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="383.5" x2="615.5" y1="1034.7266" y2="1034.7266"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="219" x="390.5" y="1028.7173">POST /_matrix/client/login</text><polygon fill="#000000" points="849.5,1064.5156,859.5,1068.5156,849.5,1072.5156,853.5,1068.5156" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="631.5" x2="855.5" y1="1068.5156" y2="1068.5156"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="142" x="638.5" y="1062.5063">HTTP(S) Forward</text><line style="stroke:#000000;stroke-width:1.0;" x1="871.5" x2="913.5" y1="1122.0938" y2="1122.0938"/><line style="stroke:#000000;stroke-width:1.0;" x1="913.5" x2="913.5" y1="1122.0938" y2="1135.0938"/><line style="stroke:#000000;stroke-width:1.0;" x1="872.5" x2="913.5" y1="1135.0938" y2="1135.0938"/><polygon fill="#000000" points="882.5,1131.0938,872.5,1135.0938,882.5,1139.0938,878.5,1135.0938" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="143" x="878.5" y="1096.2954">überprüfe Client-</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="95" x="878.5" y="1116.0845">Credentials</text><path d="M20,1175.0938 L90,1175.0938 L90,1182.0938 L80,1192.0938 L20,1192.0938 L20,1175.0938 " fill="#D3D3D3" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="186.7031" style="stroke:#000000;stroke-width:2.0;" width="965.5" x="20" y="1175.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="25" x="35" y="1188.1606">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="105" y="1193.1245">[</text><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="74" x="110" y="1191.9453">Abbruch</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="184" y="1193.1245">]</text><polygon fill="#000000" points="642.5,1237.4297,632.5,1241.4297,642.5,1245.4297,638.5,1241.4297" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="636.5" x2="860.5" y1="1241.4297" y2="1241.4297"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="97" x="752.5" y="1215.6313">Fehlerhafte</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="122" x="732.5" y="1235.4204">Anmeldedaten</text><polygon fill="#000000" points="394.5,1271.2188,384.5,1275.2188,394.5,1279.2188,390.5,1275.2188" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="388.5" x2="620.5" y1="1275.2188" y2="1275.2188"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="142" x="472.5" y="1269.2095">HTTP(S) Forward</text><polygon fill="#000000" points="137.5,1324.7969,127.5,1328.7969,137.5,1332.7969,133.5,1328.7969" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="131.5" x2="372.5" y1="1328.7969" y2="1328.7969"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="122" x="239.5" y="1302.9985">Anmeldedaten</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="147" x="219.5" y="1322.7876">sind nicht korrekt</text><path d="M689,1398.7969 L689,1447.7969 L1040,1447.7969 L1040,1408.7969 L1030,1398.7969 L689,1398.7969 " fill="#FBFB77" filter="url(#f1j8q0vltx84ck)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M1030,1398.7969 L1030,1408.7969 L1040,1408.7969 L1030,1398.7969 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="288" x="695" y="1419.5767">Die Überprüfung ist abhängig vom</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="330" x="695" y="1439.3657">gewählten Authentifizierungsverfahren</text><line style="stroke:#000000;stroke-width:1.0;" x1="871.5" x2="913.5" y1="1567.5313" y2="1567.5313"/><line style="stroke:#000000;stroke-width:1.0;" x1="913.5" x2="913.5" y1="1567.5313" y2="1580.5313"/><line style="stroke:#000000;stroke-width:1.0;" x1="872.5" x2="913.5" y1="1580.5313" y2="1580.5313"/><polygon fill="#000000" points="882.5,1576.5313,872.5,1580.5313,882.5,1584.5313,878.5,1580.5313" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="62" x="878.5" y="1502.1548">erstelle</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="201" x="878.5" y="1521.9438">Matrix-ACCESS_TOKEN,</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="82" x="878.5" y="1541.7329">device_id,</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="47" x="878.5" y="1561.522">MXID</text><polygon fill="#000000" points="642.5,1630.1094,632.5,1634.1094,642.5,1638.1094,638.5,1634.1094" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="636.5" x2="865.5" y1="1634.1094" y2="1634.1094"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="201" x="653.5" y="1608.311">Matrix-ACCESS_TOKEN,</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="138" x="721.5" y="1628.1001">device_ID, MXID</text><polygon fill="#000000" points="394.5,1663.8984,384.5,1667.8984,394.5,1671.8984,390.5,1667.8984" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="388.5" x2="625.5" y1="1667.8984" y2="1667.8984"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="142" x="477.5" y="1661.8892">HTTP(S) Forward</text><line style="stroke:#000000;stroke-width:1.0;" x1="383.5" x2="425.5" y1="1746.4766" y2="1746.4766"/><line style="stroke:#000000;stroke-width:1.0;" x1="425.5" x2="425.5" y1="1746.4766" y2="1759.4766"/><line style="stroke:#000000;stroke-width:1.0;" x1="384.5" x2="425.5" y1="1759.4766" y2="1759.4766"/><polygon fill="#000000" points="394.5,1755.4766,384.5,1759.4766,394.5,1763.4766,390.5,1759.4766" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="82" x="390.5" y="1720.6782">Speichere</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="196" x="390.5" y="1740.4673">Matrix-ACCESS_TOKEN</text><polygon fill="#000000" points="609.5,1853.8438,619.5,1857.8438,609.5,1861.8438,613.5,1857.8438" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="383.5" x2="615.5" y1="1857.8438" y2="1857.8438"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="172" x="390.5" y="1812.2563">POST /_matrix/client</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="128" x="390.5" y="1832.0454">/user/{userId}/</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="182" x="390.5" y="1851.8345">openid/request_token</text><polygon fill="#000000" points="849.5,1887.6328,859.5,1891.6328,849.5,1895.6328,853.5,1891.6328" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="631.5" x2="855.5" y1="1891.6328" y2="1891.6328"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="142" x="638.5" y="1885.6235">HTTP(S) Forward</text><line style="stroke:#000000;stroke-width:1.0;" x1="871.5" x2="913.5" y1="1945.2109" y2="1945.2109"/><line style="stroke:#000000;stroke-width:1.0;" x1="913.5" x2="913.5" y1="1945.2109" y2="1958.2109"/><line style="stroke:#000000;stroke-width:1.0;" x1="872.5" x2="913.5" y1="1958.2109" y2="1958.2109"/><polygon fill="#000000" points="882.5,1954.2109,872.5,1958.2109,882.5,1962.2109,878.5,1958.2109" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="63" x="878.5" y="1919.4126">Erstelle</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="180" x="878.5" y="1939.2017">Matrix-OpenID-Token</text><polygon fill="#000000" points="642.5,1988,632.5,1992,642.5,1996,638.5,1992" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="636.5" x2="865.5" y1="1992" y2="1992"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="180" x="679.5" y="1985.9907">Matrix-OpenID-Token</text><polygon fill="#000000" points="394.5,2021.7891,384.5,2025.7891,394.5,2029.7891,390.5,2025.7891" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="388.5" x2="625.5" y1="2025.7891" y2="2025.7891"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="142" x="477.5" y="2019.7798">HTTP(S) Forward</text><polygon fill="#000000" points="1079.5,2080.5781,1089.5,2084.5781,1079.5,2088.5781,1083.5,2084.5781" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="383.5" x2="1085.5" y1="2084.5781" y2="2084.5781"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="386" x="390.5" y="2078.5688">GET /tim-authenticate (Matrix-OpenID-Token)</text><line style="stroke:#000000;stroke-width:1.0;" x1="1101.5" x2="1143.5" y1="2177.7344" y2="2177.7344"/><line style="stroke:#000000;stroke-width:1.0;" x1="1143.5" x2="1143.5" y1="2177.7344" y2="2190.7344"/><line style="stroke:#000000;stroke-width:1.0;" x1="1102.5" x2="1143.5" y1="2190.7344" y2="2190.7344"/><polygon fill="#000000" points="1112.5,2186.7344,1102.5,2190.7344,1112.5,2194.7344,1108.5,2190.7344" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="96" x="1108.5" y="2112.3579">Prüfung, ob</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="126" x="1108.5" y="2132.147">Matrix-Domain</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="111" x="1108.5" y="2151.936">in Föderation</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="107" x="1108.5" y="2171.7251">enthalten ist</text><path d="M20,2230.7344 L84,2230.7344 L84,2237.7344 L74,2247.7344 L20,2247.7344 L20,2230.7344 " fill="#D3D3D3" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="422.2734" style="stroke:#000000;stroke-width:2.0;" width="1195.5" x="20" y="2230.7344"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="35" y="2243.8013">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="99" y="2248.7651">[</text><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="832" x="104" y="2247.5859">nicht valider Messenger-Service, da Matrix-Homeserver nicht in der Föderations enthalten ist</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="936" y="2248.7651">]</text><polygon fill="#000000" points="394.5,2318.0703,384.5,2322.0703,394.5,2326.0703,390.5,2322.0703" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="388.5" x2="1090.5" y1="2322.0703" y2="2322.0703"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="81" x="998.5" y="2296.272">HTTP 401</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="113" x="971.5" y="2316.061">Unauthorized</text><line style="stroke:#000000;stroke-width:1.0;" x1="383.5" x2="425.5" y1="2395.4375" y2="2395.4375"/><line style="stroke:#000000;stroke-width:1.0;" x1="425.5" x2="425.5" y1="2395.4375" y2="2408.4375"/><line style="stroke:#000000;stroke-width:1.0;" x1="384.5" x2="425.5" y1="2408.4375" y2="2408.4375"/><polygon fill="#000000" points="394.5,2404.4375,384.5,2408.4375,394.5,2412.4375,390.5,2408.4375" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="152" x="390.5" y="2349.8501">Abmelden Session</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="196" x="390.5" y="2369.6392">Matrix-ACCESS_TOKEN</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="63" x="390.5" y="2389.4282">löschen</text><polygon fill="#000000" points="137.5,2458.0156,127.5,2462.0156,137.5,2466.0156,133.5,2462.0156" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="131.5" x2="372.5" y1="2462.0156" y2="2462.0156"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="96" x="265.5" y="2436.2173">Anmeldung</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="136" x="230.5" y="2456.0063">nicht erfolgreich</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="20" x2="1215.5" y1="2496.0156" y2="2496.0156"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="25" y="2512.0464">[</text><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="722" x="30" y="2510.8672">valider Messenger-Service, da Matrix-Homeserver in der Föderation enthalten ist</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="752" y="2512.0464">]</text><polygon fill="#000000" points="394.5,2562.4297,384.5,2566.4297,394.5,2570.4297,390.5,2566.4297" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="388.5" x2="1095.5" y1="2566.4297" y2="2566.4297"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="81" x="1008.5" y="2560.4204">HTTP 200</text><polygon fill="#000000" points="137.5,2616.0078,127.5,2620.0078,137.5,2624.0078,133.5,2620.0078" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="131.5" x2="377.5" y1="2620.0078" y2="2620.0078"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="96" x="270.5" y="2594.2095">Anmeldung</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="89" x="282.5" y="2613.9985">erfolgreich</text><!--MD5=[554d3874f974ff1a9cde0d4aab83eb14]
@startuml
skinparam sequenceMessageAlign direction
skinparam minClassWidth 200
skinparam BoxPadding 1
skinparam sequenceReferenceHeaderBackgroundColor palegreen
scale max 2048 width

skinparam sequence {
ArrowColor black
ArrowFontSize 17
ActorBorderColor black
LifeLineBorderColor black
LifeLineBackgroundColor Gainsboro

ParticipantBorderColor Motivation
ParticipantBackgroundColor Motivation
ParticipantFontName Impact
ParticipantFontSize 20
ParticipantFontColor black
ParticipantBorderColor Black
ParticipantBackgroundColor MOTIVATION

ActorBackgroundColor Gainsboro
ActorFontColor black
ActorFontSize 20
ActorFontName Aapex
}
    actor U as "Akteur in der Rolle\nUser / User-HBA"
    participant C as "TI-Messenger-Client"
    box <size:18>Messenger-Service</size> #WhiteSmoke
      participant MP as "Messenger Proxy"
      participant MH as "Matrix-Homeserver"
    end box
    box <size:18>VZD-FHIR-Directory</size> #WhiteSmoke
      participant Auth as "Auth-Service"
    end box

|||
  U->C: Eingabe Messenger-Service 
    Activate C
  C->MP: GET /_matrix/client/login
    Activate MP
  MP->MP: TLS-Terminierung
  |||
  MP->MP: überprüfe client_id, \nclient_secret

|||
alt#LightGrey #AliceBlue <size:16>TI-Messenger Client wird vom Anbieter nicht unterstützt (kein gültiges Client-Secret)</size>
|||  

  MP- ->C: HTTP 401 Unauthroized
  C- ->U: Anmeldung \nnicht erfolgreich
  
    |||  
    else <size:16>TI-Messenger Client wird vom Anbieter unterstützt  (gültiges Client-Secret)</size>
    |||

  MP->MH: HTTP(S) Forward
   Activate MH

|||
note over U, MH: <size:17>Die Authentifizierungsverfahren werden für jeden \n<size:17>Messenger-Service durch die Organisation festgelegt</size>
|||

  MH- ->MP: unterstützte \nAuthentifizierungs-\nverfahren
    Deactivate MH
  MP- ->C: HTTP(S) Forward
    Deactivate MP
  C- ->U: Zeige \nAuthentifizierungsmaske
  |||
  U->U: Starte Authentifizierung
  U->C: Anmeldung
  C->MP: POST /_matrix/client/login
    Activate MP

    
    MP->MH: HTTP(S) Forward
      Activate MH
    MH->MH: überprüfe Client-\nCredentials
    |||
    opt#LightGrey #MistyRose <size:16>Abbruch</size>
      MH- ->MP:Fehlerhafte \nAnmeldedaten 
      MP- ->C: HTTP(S) Forward
      C- ->U: Anmeldedaten \nsind nicht korrekt
      |||
    end
    |||
    
    note over MH, MH: <size:17>Die Überprüfung ist abhängig vom \n<size:17>gewählten Authentifizierungsverfahren</size>
    
    |||
    MH->MH: erstelle \nMatrix-ACCESS_TOKEN, \ndevice_id, \nMXID
    MH- ->MP: Matrix-ACCESS_TOKEN, \ndevice_ID, MXID
      Deactivate MH
    MP- ->C: HTTP(S) Forward
      Deactivate MP
    |||
    C->C: Speichere \nMatrix-ACCESS_TOKEN
    
    |||
    C->MP: POST /_matrix/client\n/user/{userId}/\nopenid/request_token
      Activate MP
    MP->MH: HTTP(S) Forward
      Activate MH
    MH->MH: Erstelle \nMatrix-OpenID-Token
    MH- ->MP: Matrix-OpenID-Token
      Deactivate MH
    MP- ->C: HTTP(S) Forward
      Deactivate MP
    
    |||
    C->Auth: GET /tim-authenticate (Matrix-OpenID-Token)
      Activate Auth
    Auth->Auth: Prüfung, ob \nMatrix-Domain \nin Föderation \nenthalten ist

      |||
      alt#LightGrey #LightBlue <size:16>nicht valider Messenger-Service, da Matrix-Homeserver nicht in der Föderations enthalten ist</size>
      |||  

        Auth- ->C: HTTP 401 \nUnauthorized 
        C->C: Abmelden Session \nMatrix-ACCESS_TOKEN \nlöschen
        C- ->U: Anmeldung \nnicht erfolgreich
        
        |||
        else <size:16>valider Messenger-Service, da Matrix-Homeserver in der Föderation enthalten ist</size>
          |||
          Auth- ->C: HTTP 200
            Deactivate Auth
          C- ->U: Anmeldung \nerfolgreich
            Deactivate C
          |||

      end  
      |||
end
|||

@enduml

PlantUML version 1.2021.16(Wed Dec 08 17:25:22 UTC 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>