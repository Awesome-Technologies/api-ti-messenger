<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="2249px" preserveAspectRatio="none" style="width:1552px;height:2249px;background:#FFFFFF;" version="1.1" viewBox="0 0 1552 2249" width="1552px" zoomAndPan="magnify"><defs/><g><rect fill="#F5F5F5" height="2237.0781" style="stroke:#181818;stroke-width:0.5;" width="492" x="505.5" y="6"/><text fill="#000000" font-family="sans-serif" font-size="18" font-weight="bold" lengthAdjust="spacing" textLength="193" x="652.5" y="22.708">Messenger-Service</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="5" x="845.5" y="23.8872"> </text><rect fill="#F5F5F5" height="2237.0781" style="stroke:#181818;stroke-width:0.5;" width="446" x="1006.5" y="6"/><text fill="#000000" font-family="sans-serif" font-size="18" font-weight="bold" lengthAdjust="spacing" textLength="200" x="1127" y="22.708">VZD-FHIR-Directory</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="5" x="1327" y="23.8872"> </text><rect fill="#DCDCDC" height="1937.5859" style="stroke:#000000;stroke-width:1.0;" width="10" x="378.5" y="186.9297"/><rect fill="#DCDCDC" height="257.7344" style="stroke:#000000;stroke-width:1.0;" width="10" x="611.5" y="220.7188"/><rect fill="#DCDCDC" height="586.0078" style="stroke:#000000;stroke-width:1.0;" width="10" x="611.5" y="646.3984"/><rect fill="#DCDCDC" height="167.9453" style="stroke:#000000;stroke-width:1.0;" width="10" x="611.5" y="1352.5625"/><rect fill="#DCDCDC" height="143.3672" style="stroke:#000000;stroke-width:1.0;" width="10" x="881.5" y="301.2969"/><rect fill="#DCDCDC" height="266.1016" style="stroke:#000000;stroke-width:1.0;" width="10" x="881.5" y="932.5156"/><rect fill="#DCDCDC" height="100.3672" style="stroke:#000000;stroke-width:1.0;" width="10" x="881.5" y="1386.3516"/><rect fill="#DCDCDC" height="265.4922" style="stroke:#000000;stroke-width:1.0;" width="10" x="1112.5" y="1554.2969"/><rect fill="#DCDCDC" height="33.7891" style="stroke:#000000;stroke-width:1.0;" width="10" x="1112.5" y="2014.1484"/><rect fill="#DCDCDC" height="536.4297" style="stroke:#000000;stroke-width:1.0;" width="10" x="1336.5" y="1588.0859"/><rect fill="#F0F8FF" height="1363.5391" style="stroke:#000000;stroke-width:1.5;" width="1535.5" x="10" y="752.9766"/><rect fill="#F0F8FF" height="1230.4141" style="stroke:none;stroke-width:1.0;" width="1535.5" x="10" y="886.1016"/><rect fill="#ADD8E6" height="414.8516" style="stroke:#000000;stroke-width:1.5;" width="1438.5" x="20" y="1694.6641"/><rect fill="#ADD8E6" height="141.7813" style="stroke:none;stroke-width:1.0;" width="1438.5" x="20" y="1967.7344"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="126" x2="126" y1="111.5625" y2="2133.5156"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="383.5" x2="383.5" y1="111.5625" y2="2133.5156"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="616.5" x2="616.5" y1="111.5625" y2="2133.5156"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="886.5" x2="886.5" y1="111.5625" y2="2133.5156"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1117.5" x2="1117.5" y1="111.5625" y2="2133.5156"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1341.5" x2="1341.5" y1="111.5625" y2="2133.5156"/><text fill="#000000" font-family="Aapex" font-size="20" lengthAdjust="spacing" textLength="187" x="30" y="83.5645">Akteur in der Rolle</text><text fill="#000000" font-family="Aapex" font-size="20" lengthAdjust="spacing" textLength="159" x="44" y="106.8457">User / User-HBA</text><ellipse cx="126.5" cy="13.5" fill="#DCDCDC" rx="8" ry="8" style="stroke:#000000;stroke-width:0.5;"/><path d="M126.5,21.5 L126.5,48.5 M113.5,29.5 L139.5,29.5 M126.5,48.5 L113.5,63.5 M126.5,48.5 L139.5,63.5 " fill="none" style="stroke:#000000;stroke-width:0.5;"/><text fill="#000000" font-family="Aapex" font-size="20" lengthAdjust="spacing" textLength="187" x="30" y="2151.0801">Akteur in der Rolle</text><text fill="#000000" font-family="Aapex" font-size="20" lengthAdjust="spacing" textLength="159" x="44" y="2174.3613">User / User-HBA</text><ellipse cx="126.5" cy="2187.5781" fill="#DCDCDC" rx="8" ry="8" style="stroke:#000000;stroke-width:0.5;"/><path d="M126.5,2195.5781 L126.5,2222.5781 M113.5,2203.5781 L139.5,2203.5781 M126.5,2222.5781 L113.5,2237.5781 M126.5,2222.5781 L139.5,2237.5781 " fill="none" style="stroke:#000000;stroke-width:0.5;"/><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="214" x="276.5" y="73.2813"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="198" x="284.5" y="98.8457">TI-Messenger-Client</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="214" x="276.5" y="2132.5156"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="198" x="284.5" y="2158.0801">TI-Messenger-Client</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="214" x="509.5" y="73.2813"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="167" x="533" y="98.8457">Messenger Proxy</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="214" x="509.5" y="2132.5156"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="167" x="533" y="2158.0801">Messenger Proxy</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="214" x="779.5" y="73.2813"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="189" x="792" y="98.8457">Matrix-Homeserver</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="214" x="779.5" y="2132.5156"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="189" x="792" y="2158.0801">Matrix-Homeserver</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="214" x="1010.5" y="73.2813"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="108" x="1063.5" y="98.8457">FHIR-Proxy</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="214" x="1010.5" y="2132.5156"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="108" x="1063.5" y="2158.0801">FHIR-Proxy</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="214" x="1234.5" y="73.2813"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="145" x="1269" y="98.8457">FHIR-Directory</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="214" x="1234.5" y="2132.5156"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="145" x="1269" y="2158.0801">FHIR-Directory</text><rect fill="#DCDCDC" height="1937.5859" style="stroke:#000000;stroke-width:1.0;" width="10" x="378.5" y="186.9297"/><rect fill="#DCDCDC" height="257.7344" style="stroke:#000000;stroke-width:1.0;" width="10" x="611.5" y="220.7188"/><rect fill="#DCDCDC" height="586.0078" style="stroke:#000000;stroke-width:1.0;" width="10" x="611.5" y="646.3984"/><rect fill="#DCDCDC" height="167.9453" style="stroke:#000000;stroke-width:1.0;" width="10" x="611.5" y="1352.5625"/><rect fill="#DCDCDC" height="143.3672" style="stroke:#000000;stroke-width:1.0;" width="10" x="881.5" y="301.2969"/><rect fill="#DCDCDC" height="266.1016" style="stroke:#000000;stroke-width:1.0;" width="10" x="881.5" y="932.5156"/><rect fill="#DCDCDC" height="100.3672" style="stroke:#000000;stroke-width:1.0;" width="10" x="881.5" y="1386.3516"/><rect fill="#DCDCDC" height="265.4922" style="stroke:#000000;stroke-width:1.0;" width="10" x="1112.5" y="1554.2969"/><rect fill="#DCDCDC" height="33.7891" style="stroke:#000000;stroke-width:1.0;" width="10" x="1112.5" y="2014.1484"/><rect fill="#DCDCDC" height="536.4297" style="stroke:#000000;stroke-width:1.0;" width="10" x="1336.5" y="1588.0859"/><polygon fill="#000000" points="366.5,182.9297,376.5,186.9297,366.5,190.9297,370.5,186.9297" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="126.5" x2="372.5" y1="186.9297" y2="186.9297"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="228" x="133.5" y="141.3423">Eingabe Messenger-Service</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="116" x="133.5" y="161.1313">(Manuell oder</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="130" x="133.5" y="180.9204">durch Auswahl)</text><polygon fill="#000000" points="599.5,216.7188,609.5,220.7188,599.5,224.7188,603.5,220.7188" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="388.5" x2="605.5" y1="220.7188" y2="220.7188"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="96" x="395.5" y="214.7095">POST /login</text><line style="stroke:#000000;stroke-width:1.0;" x1="621.5" x2="663.5" y1="254.5078" y2="254.5078"/><line style="stroke:#000000;stroke-width:1.0;" x1="663.5" x2="663.5" y1="254.5078" y2="267.5078"/><line style="stroke:#000000;stroke-width:1.0;" x1="622.5" x2="663.5" y1="267.5078" y2="267.5078"/><polygon fill="#000000" points="632.5,263.5078,622.5,267.5078,632.5,271.5078,628.5,267.5078" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="150" x="628.5" y="248.4985">TLS-Terminierung</text><polygon fill="#000000" points="869.5,297.2969,879.5,301.2969,869.5,305.2969,873.5,301.2969" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="621.5" x2="875.5" y1="301.2969" y2="301.2969"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="117" x="628.5" y="295.2876">HTTP Forward</text><path d="M27,339.2969 L27,388.2969 L985,388.2969 L985,349.2969 L975,339.2969 L27,339.2969 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M975,339.2969 L975,349.2969 L985,349.2969 L975,339.2969 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="417" x="282.75" y="360.0767">Die Authentifizierungsverfahren werden für jeden</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="438" x="282.75" y="379.8657">Messenger-Service durch die Organisation festgelegt</text><polygon fill="#000000" points="632.5,440.6641,622.5,444.6641,632.5,448.6641,628.5,444.6641" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="626.5" x2="885.5" y1="444.6641" y2="444.6641"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="236" x="643.5" y="438.6548">Authentifizierungsverfahren</text><polygon fill="#000000" points="399.5,474.4531,389.5,478.4531,399.5,482.4531,395.5,478.4531" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="393.5" x2="615.5" y1="478.4531" y2="478.4531"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="117" x="492.5" y="472.4438">HTTP Forward</text><polygon fill="#000000" points="137.5,528.0313,127.5,532.0313,137.5,536.0313,133.5,532.0313" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="131.5" x2="377.5" y1="532.0313" y2="532.0313"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="47" x="162.5" y="506.2329">Zeige</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="209" x="162.5" y="526.022">Authentifizierungsmaske</text><line style="stroke:#000000;stroke-width:1.0;" x1="126.5" x2="168.5" y1="565.8203" y2="565.8203"/><line style="stroke:#000000;stroke-width:1.0;" x1="168.5" x2="168.5" y1="565.8203" y2="578.8203"/><line style="stroke:#000000;stroke-width:1.0;" x1="127.5" x2="168.5" y1="578.8203" y2="578.8203"/><polygon fill="#000000" points="137.5,574.8203,127.5,578.8203,137.5,582.8203,133.5,578.8203" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="203" x="133.5" y="559.811">Starte Authentifizierung</text><polygon fill="#000000" points="366.5,608.6094,376.5,612.6094,366.5,616.6094,370.5,612.6094" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="126.5" x2="372.5" y1="612.6094" y2="612.6094"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="96" x="133.5" y="606.6001">Anmeldung</text><polygon fill="#000000" points="599.5,642.3984,609.5,646.3984,599.5,650.3984,603.5,646.3984" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="388.5" x2="605.5" y1="646.3984" y2="646.3984"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="96" x="395.5" y="640.3892">POST /login</text><line style="stroke:#000000;stroke-width:1.0;" x1="621.5" x2="663.5" y1="699.9766" y2="699.9766"/><line style="stroke:#000000;stroke-width:1.0;" x1="663.5" x2="663.5" y1="699.9766" y2="712.9766"/><line style="stroke:#000000;stroke-width:1.0;" x1="622.5" x2="663.5" y1="712.9766" y2="712.9766"/><polygon fill="#000000" points="632.5,708.9766,622.5,712.9766,632.5,716.9766,628.5,712.9766" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="185" x="628.5" y="674.1782">überprüfe User-Agent,</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="109" x="628.5" y="693.9673">Client-Secret</text><path d="M10,752.9766 L74,752.9766 L74,760.1094 L64,770.1094 L10,770.1094 L10,752.9766 " fill="#D3D3D3" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="1363.5391" style="stroke:#000000;stroke-width:1.5;" width="1535.5" x="10" y="752.9766"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="25" y="766.0435">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="89" y="771.0073">[</text><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="507" x="94" y="769.8281">TI-Messenger Client wird vom Anbieter nicht unterstützt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="601" y="771.0073">]</text><polygon fill="#000000" points="399.5,820.5234,389.5,824.5234,399.5,828.5234,395.5,824.5234" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="393.5" x2="610.5" y1="824.5234" y2="824.5234"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="199" x="405.5" y="818.5142">HTTP 401 Unauthroized</text><polygon fill="#000000" points="137.5,874.1016,127.5,878.1016,137.5,882.1016,133.5,878.1016" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="131.5" x2="377.5" y1="878.1016" y2="878.1016"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="96" x="235.5" y="852.3032">Anmeldung</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="136" x="235.5" y="872.0923">nicht erfolgreich</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="10" x2="1545.5" y1="887.1016" y2="887.1016"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="15" y="903.1323">[</text><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="457" x="20" y="901.9531">TI-Messenger Client wird vom Anbieter unterstützt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="477" y="903.1323">]</text><polygon fill="#000000" points="869.5,928.5156,879.5,932.5156,869.5,936.5156,873.5,932.5156" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="621.5" x2="875.5" y1="932.5156" y2="932.5156"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="117" x="628.5" y="926.5063">HTTP Forward</text><line style="stroke:#000000;stroke-width:1.0;" x1="891.5" x2="933.5" y1="966.3047" y2="966.3047"/><line style="stroke:#000000;stroke-width:1.0;" x1="933.5" x2="933.5" y1="966.3047" y2="979.3047"/><line style="stroke:#000000;stroke-width:1.0;" x1="892.5" x2="933.5" y1="979.3047" y2="979.3047"/><polygon fill="#000000" points="902.5,975.3047,892.5,979.3047,902.5,983.3047,898.5,979.3047" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="207" x="898.5" y="960.2954">überprüfe Zugangsdaten</text><path d="M711,992.3047 L711,1041.3047 L1062,1041.3047 L1062,1002.3047 L1052,992.3047 L711,992.3047 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1052,992.3047 L1052,1002.3047 L1062,1002.3047 L1052,992.3047 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="288" x="717" y="1013.0845">Die Überprüfung ist abhängig vom</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="330" x="717" y="1032.8735">gewählten Authentifizierungsverfahren</text><line style="stroke:#000000;stroke-width:1.0;" x1="891.5" x2="933.5" y1="1132.0391" y2="1132.0391"/><line style="stroke:#000000;stroke-width:1.0;" x1="933.5" x2="933.5" y1="1132.0391" y2="1145.0391"/><line style="stroke:#000000;stroke-width:1.0;" x1="892.5" x2="933.5" y1="1145.0391" y2="1145.0391"/><polygon fill="#000000" points="902.5,1141.0391,892.5,1145.0391,902.5,1149.0391,898.5,1145.0391" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="62" x="898.5" y="1066.6626">erstelle</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="201" x="898.5" y="1086.4517">Matrix-ACCESS_TOKEN,</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="82" x="898.5" y="1106.2407">device_id,</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="47" x="898.5" y="1126.0298">MXID</text><polygon fill="#000000" points="632.5,1194.6172,622.5,1198.6172,632.5,1202.6172,628.5,1198.6172" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="626.5" x2="885.5" y1="1198.6172" y2="1198.6172"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="201" x="673.5" y="1172.8188">Matrix-ACCESS_TOKEN,</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="138" x="673.5" y="1192.6079">device_ID, MXID</text><polygon fill="#000000" points="399.5,1228.4063,389.5,1232.4063,399.5,1236.4063,395.5,1232.4063" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="393.5" x2="615.5" y1="1232.4063" y2="1232.4063"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="117" x="492.5" y="1226.397">HTTP Forward</text><line style="stroke:#000000;stroke-width:1.0;" x1="388.5" x2="430.5" y1="1285.9844" y2="1285.9844"/><line style="stroke:#000000;stroke-width:1.0;" x1="430.5" x2="430.5" y1="1285.9844" y2="1298.9844"/><line style="stroke:#000000;stroke-width:1.0;" x1="389.5" x2="430.5" y1="1298.9844" y2="1298.9844"/><polygon fill="#000000" points="399.5,1294.9844,389.5,1298.9844,399.5,1302.9844,395.5,1298.9844" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="82" x="395.5" y="1260.186">Speichere</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="196" x="395.5" y="1279.9751">Matrix-ACCESS_TOKEN</text><polygon fill="#000000" points="599.5,1348.5625,609.5,1352.5625,599.5,1356.5625,603.5,1352.5625" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="388.5" x2="605.5" y1="1352.5625" y2="1352.5625"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="68" x="395.5" y="1326.7642">Request</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="180" x="395.5" y="1346.5532">Matrix-OpenID-Token</text><polygon fill="#000000" points="869.5,1382.3516,879.5,1386.3516,869.5,1390.3516,873.5,1386.3516" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="621.5" x2="875.5" y1="1386.3516" y2="1386.3516"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="117" x="628.5" y="1380.3423">HTTP Forward</text><line style="stroke:#000000;stroke-width:1.0;" x1="891.5" x2="933.5" y1="1439.9297" y2="1439.9297"/><line style="stroke:#000000;stroke-width:1.0;" x1="933.5" x2="933.5" y1="1439.9297" y2="1452.9297"/><line style="stroke:#000000;stroke-width:1.0;" x1="892.5" x2="933.5" y1="1452.9297" y2="1452.9297"/><polygon fill="#000000" points="902.5,1448.9297,892.5,1452.9297,902.5,1456.9297,898.5,1452.9297" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="63" x="898.5" y="1414.1313">Erstelle</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="180" x="898.5" y="1433.9204">Matrix-OpenID-Token</text><polygon fill="#000000" points="632.5,1482.7188,622.5,1486.7188,632.5,1490.7188,628.5,1486.7188" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="626.5" x2="885.5" y1="1486.7188" y2="1486.7188"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="180" x="699.5" y="1480.7095">Matrix-OpenID-Token</text><polygon fill="#000000" points="399.5,1516.5078,389.5,1520.5078,399.5,1524.5078,395.5,1520.5078" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="393.5" x2="615.5" y1="1520.5078" y2="1520.5078"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="117" x="492.5" y="1514.4985">HTTP Forward</text><polygon fill="#000000" points="1100.5,1550.2969,1110.5,1554.2969,1100.5,1558.2969,1104.5,1554.2969" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="388.5" x2="1106.5" y1="1554.2969" y2="1554.2969"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="386" x="395.5" y="1548.2876">GET /tim-authenticate (Matrix-OpenID-Token)</text><polygon fill="#000000" points="1324.5,1584.0859,1334.5,1588.0859,1324.5,1592.0859,1328.5,1588.0859" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="1122.5" x2="1330.5" y1="1588.0859" y2="1588.0859"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="117" x="1129.5" y="1582.0767">HTTP Forward</text><line style="stroke:#000000;stroke-width:1.0;" x1="1346.5" x2="1388.5" y1="1641.6641" y2="1641.6641"/><line style="stroke:#000000;stroke-width:1.0;" x1="1388.5" x2="1388.5" y1="1641.6641" y2="1654.6641"/><line style="stroke:#000000;stroke-width:1.0;" x1="1347.5" x2="1388.5" y1="1654.6641" y2="1654.6641"/><polygon fill="#000000" points="1357.5,1650.6641,1347.5,1654.6641,1357.5,1658.6641,1353.5,1654.6641" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="66" x="1353.5" y="1615.8657">Prüfung</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="180" x="1353.5" y="1635.6548">Matrix-OpenID-Token</text><path d="M20,1694.6641 L84,1694.6641 L84,1701.7969 L74,1711.7969 L20,1711.7969 L20,1694.6641 " fill="#D3D3D3" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="414.8516" style="stroke:#000000;stroke-width:1.5;" width="1438.5" x="20" y="1694.6641"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="35" y="1707.731">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="99" y="1712.6948">[</text><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="274" x="104" y="1711.5156">nicht valider Messenger-Srvice</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="378" y="1712.6948">]</text><polygon fill="#000000" points="1133.5,1782,1123.5,1786,1133.5,1790,1129.5,1786" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1127.5" x2="1335.5" y1="1786" y2="1786"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="81" x="1216.5" y="1760.2017">HTTP 401</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="113" x="1216.5" y="1779.9907">Unauthorized</text><polygon fill="#000000" points="399.5,1815.7891,389.5,1819.7891,399.5,1823.7891,395.5,1819.7891" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="393.5" x2="1116.5" y1="1819.7891" y2="1819.7891"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="117" x="993.5" y="1813.7798">HTTP Forward</text><line style="stroke:#000000;stroke-width:1.0;" x1="388.5" x2="430.5" y1="1893.1563" y2="1893.1563"/><line style="stroke:#000000;stroke-width:1.0;" x1="430.5" x2="430.5" y1="1893.1563" y2="1906.1563"/><line style="stroke:#000000;stroke-width:1.0;" x1="389.5" x2="430.5" y1="1906.1563" y2="1906.1563"/><polygon fill="#000000" points="399.5,1902.1563,389.5,1906.1563,399.5,1910.1563,395.5,1906.1563" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="152" x="395.5" y="1847.5688">Abmelden Session</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="196" x="395.5" y="1867.3579">Matrix-ACCESS_TOKEN</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="63" x="395.5" y="1887.147">löschen</text><polygon fill="#000000" points="137.5,1955.7344,127.5,1959.7344,137.5,1963.7344,133.5,1959.7344" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="131.5" x2="377.5" y1="1959.7344" y2="1959.7344"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="96" x="235.5" y="1933.936">Anmeldung</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="136" x="235.5" y="1953.7251">nicht erfolgreich</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="20" x2="1458.5" y1="1968.7344" y2="1968.7344"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="25" y="1984.7651">[</text><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="224" x="30" y="1983.5859">valider Messenger-Srvice</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="254" y="1984.7651">]</text><polygon fill="#000000" points="1133.5,2010.1484,1123.5,2014.1484,1133.5,2018.1484,1129.5,2014.1484" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1127.5" x2="1335.5" y1="2014.1484" y2="2014.1484"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="81" x="1248.5" y="2008.1392">HTTP 200</text><polygon fill="#000000" points="399.5,2043.9375,389.5,2047.9375,399.5,2051.9375,395.5,2047.9375" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="393.5" x2="1116.5" y1="2047.9375" y2="2047.9375"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="117" x="993.5" y="2041.9282">HTTP Forward</text><polygon fill="#000000" points="137.5,2097.5156,127.5,2101.5156,137.5,2105.5156,133.5,2101.5156" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="131.5" x2="377.5" y1="2101.5156" y2="2101.5156"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="96" x="270.5" y="2075.7173">Anmeldung</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="89" x="270.5" y="2095.5063">erfolgreich</text><!--MD5=[0a275ec7f6c6bc57a59c5d64dc5c6170]
@startuml
skinparam sequenceMessageAlign direction
skinparam minClassWidth 200
skinparam BoxPadding 1
skinparam sequenceReferenceHeaderBackgroundColor palegreen
scale max 2048 width

skinparam sequence {
ArrowColor black
ArrowFontSize 17
ActorBorderColor black
LifeLineBorderColor black
LifeLineBackgroundColor Gainsboro

ParticipantBorderColor Motivation
ParticipantBackgroundColor Motivation
ParticipantFontName Impact
ParticipantFontSize 20
ParticipantFontColor black
ParticipantBorderColor Black
ParticipantBackgroundColor MOTIVATION

ActorBackgroundColor Gainsboro
ActorFontColor black
ActorFontSize 20
ActorFontName Aapex
}
    actor U as "Akteur in der Rolle\nUser / User-HBA"
    participant C as "TI-Messenger-Client"
    box <size:18>Messenger-Service</size> #WhiteSmoke
      participant MP as "Messenger Proxy"
      participant MH as "Matrix-Homeserver"
    end box
    box <size:18>VZD-FHIR-Directory</size> #WhiteSmoke
      participant FP as "FHIR-Proxy"
      participant VZD as "FHIR-Directory"
    end box

  U->C: Eingabe Messenger-Service \n(Manuell oder \ndurch Auswahl)
    Activate C
  C->MP: POST /login
    Activate MP
  MP->MP: TLS-Terminierung
  MP->MH: HTTP Forward
   Activate MH

|||
note over U, MH: <size:17>Die Authentifizierungsverfahren werden für jeden \n<size:17>Messenger-Service durch die Organisation festgelegt</size>
|||

  MH- ->MP: Authentifizierungsverfahren
    Deactivate MH
  MP- ->C: HTTP Forward
    Deactivate MP
  C- ->U: Zeige \nAuthentifizierungsmaske
  U->U: Starte Authentifizierung
  U->C: Anmeldung
  C->MP: POST /login
    Activate MP
  MP->MP: überprüfe User-Agent, \nClient-Secret

|||
alt#LightGrey #AliceBlue <size:16>TI-Messenger Client wird vom Anbieter nicht unterstützt</size>
|||  

  MP- ->C: HTTP 401 Unauthroized
  C- ->U: Anmeldung \nnicht erfolgreich
  
    else <size:16>TI-Messenger Client wird vom Anbieter unterstützt</size>
  
    MP->MH: HTTP Forward
      Activate MH
    MH->MH: überprüfe Zugangsdaten
    
    note over MH, MH: <size:17>Die Überprüfung ist abhängig vom \n<size:17>gewählten Authentifizierungsverfahren</size>
    
    MH->MH: erstelle \nMatrix-ACCESS_TOKEN, \ndevice_id, \nMXID
    MH- ->MP: Matrix-ACCESS_TOKEN, \ndevice_ID, MXID
      Deactivate MH
    MP- ->C: HTTP Forward
      Deactivate MP
    C->C: Speichere \nMatrix-ACCESS_TOKEN
    C->MP: Request \nMatrix-OpenID-Token
      Activate MP
    MP->MH: HTTP Forward
      Activate MH
    MH->MH: Erstelle \nMatrix-OpenID-Token
    MH- ->MP: Matrix-OpenID-Token
      Deactivate MH
    MP- ->C: HTTP Forward
      Deactivate MP
    
    C->FP: GET /tim-authenticate (Matrix-OpenID-Token)
      Activate FP
    FP->VZD: HTTP Forward
      Activate VZD
    VZD->VZD: Prüfung \nMatrix-OpenID-Token

      |||
      alt#LightGrey #LightBlue <size:16>nicht valider Messenger-Srvice</size>
      |||  

        VZD- ->FP: HTTP 401 \nUnauthorized 
        FP- ->C: HTTP Forward
          Deactivate FP
        C->C: Abmelden Session \nMatrix-ACCESS_TOKEN \nlöschen
        C- ->U: Anmeldung \nnicht erfolgreich
        
        else <size:16>valider Messenger-Srvice</size>
          VZD- ->FP: HTTP 200
            Activate FP
          FP- ->C: HTTP Forward
            Deactivate FP
          C- ->U: Anmeldung \nerfolgreich

      end  
end

@enduml

PlantUML version 1.2022.5(Sat Apr 30 10:55:52 UTC 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>