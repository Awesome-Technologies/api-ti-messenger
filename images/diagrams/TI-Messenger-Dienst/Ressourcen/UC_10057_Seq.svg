<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="2827px" preserveAspectRatio="none" style="width:1258px;height:2827px;background:#FFFFFF;" version="1.1" viewBox="0 0 1258 2827" width="1258px" zoomAndPan="magnify"><defs/><g><rect fill="#F5F5F5" height="2815.5703" style="stroke:#181818;stroke-width:0.5;" width="462" x="515.5" y="6"/><text fill="#000000" font-family="sans-serif" font-size="18" font-weight="bold" lengthAdjust="spacing" textLength="193" x="647.5" y="22.708">Messenger-Service</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="5" x="840.5" y="23.8872"> </text><rect fill="#F5F5F5" height="2815.5703" style="stroke:#181818;stroke-width:0.5;" width="222" x="985.5" y="6"/><text fill="#000000" font-family="sans-serif" font-size="18" font-weight="bold" lengthAdjust="spacing" textLength="200" x="994" y="22.708">VZD-FHIR-Directory</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="5" x="1194" y="23.8872"> </text><rect fill="#DCDCDC" height="2432.6563" style="stroke:#000000;stroke-width:1.0;" width="10" x="373.5" y="172.3516"/><rect fill="#DCDCDC" height="624.6406" style="stroke:#000000;stroke-width:1.0;" width="10" x="621.5" y="206.1406"/><rect fill="#DCDCDC" height="629.1719" style="stroke:#000000;stroke-width:1.0;" width="10" x="621.5" y="1023.7266"/><rect fill="#DCDCDC" height="167.9453" style="stroke:#000000;stroke-width:1.0;" width="10" x="621.5" y="1842.8438"/><rect fill="#DCDCDC" height="182.9453" style="stroke:#000000;stroke-width:1.0;" width="10" x="861.5" y="614.0469"/><rect fill="#DCDCDC" height="561.5938" style="stroke:#000000;stroke-width:1.0;" width="10" x="861.5" y="1057.5156"/><rect fill="#DCDCDC" height="100.3672" style="stroke:#000000;stroke-width:1.0;" width="10" x="861.5" y="1876.6328"/><rect fill="#DCDCDC" height="481.8516" style="stroke:#000000;stroke-width:1.0;" width="10" x="1091.5" y="2069.5781"/><rect fill="#F0F8FF" height="2285.5" style="stroke:#000000;stroke-width:1.5;" width="1241.5" x="10" y="384.5078"/><rect fill="#F0F8FF" height="2127.375" style="stroke:none;stroke-width:1.0;" width="1241.5" x="10" y="542.6328"/><rect fill="#FFE4E1" height="186.7031" style="stroke:#000000;stroke-width:1.5;" width="963.5" x="20" y="1164.0938"/><rect fill="#ADD8E6" height="422.2734" style="stroke:#000000;stroke-width:1.5;" width="1193.5" x="20" y="2215.7344"/><rect fill="#ADD8E6" height="157.9922" style="stroke:none;stroke-width:1.0;" width="1193.5" x="20" y="2480.0156"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="126" x2="126" y1="111.5625" y2="2712.0078"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="378.5" x2="378.5" y1="111.5625" y2="2712.0078"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="626.5" x2="626.5" y1="111.5625" y2="2712.0078"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="866.5" x2="866.5" y1="111.5625" y2="2712.0078"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1096.5" x2="1096.5" y1="111.5625" y2="2712.0078"/><text fill="#000000" font-family="Aapex" font-size="20" lengthAdjust="spacing" textLength="187" x="30" y="83.5645">Akteur in der Rolle</text><text fill="#000000" font-family="Aapex" font-size="20" lengthAdjust="spacing" textLength="159" x="44" y="106.8457">User / User-HBA</text><ellipse cx="126.5" cy="13.5" fill="#DCDCDC" rx="8" ry="8" style="stroke:#000000;stroke-width:0.5;"/><path d="M126.5,21.5 L126.5,48.5 M113.5,29.5 L139.5,29.5 M126.5,48.5 L113.5,63.5 M126.5,48.5 L139.5,63.5 " fill="none" style="stroke:#000000;stroke-width:0.5;"/><text fill="#000000" font-family="Aapex" font-size="20" lengthAdjust="spacing" textLength="187" x="30" y="2729.5723">Akteur in der Rolle</text><text fill="#000000" font-family="Aapex" font-size="20" lengthAdjust="spacing" textLength="159" x="44" y="2752.8535">User / User-HBA</text><ellipse cx="126.5" cy="2766.0703" fill="#DCDCDC" rx="8" ry="8" style="stroke:#000000;stroke-width:0.5;"/><path d="M126.5,2774.0703 L126.5,2801.0703 M113.5,2782.0703 L139.5,2782.0703 M126.5,2801.0703 L113.5,2816.0703 M126.5,2801.0703 L139.5,2816.0703 " fill="none" style="stroke:#000000;stroke-width:0.5;"/><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="214" x="271.5" y="73.2813"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="198" x="279.5" y="98.8457">TI-Messenger-Client</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="214" x="271.5" y="2711.0078"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="198" x="279.5" y="2736.5723">TI-Messenger-Client</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="214" x="519.5" y="73.2813"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="167" x="543" y="98.8457">Messenger Proxy</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="214" x="519.5" y="2711.0078"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="167" x="543" y="2736.5723">Messenger Proxy</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="214" x="759.5" y="73.2813"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="189" x="772" y="98.8457">Matrix-Homeserver</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="214" x="759.5" y="2711.0078"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="189" x="772" y="2736.5723">Matrix-Homeserver</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="214" x="989.5" y="73.2813"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="128" x="1032.5" y="98.8457">Auth-Service</text><rect fill="#EFEFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="214" x="989.5" y="2711.0078"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="128" x="1032.5" y="2736.5723">Auth-Service</text><rect fill="#DCDCDC" height="2432.6563" style="stroke:#000000;stroke-width:1.0;" width="10" x="373.5" y="172.3516"/><rect fill="#DCDCDC" height="624.6406" style="stroke:#000000;stroke-width:1.0;" width="10" x="621.5" y="206.1406"/><rect fill="#DCDCDC" height="629.1719" style="stroke:#000000;stroke-width:1.0;" width="10" x="621.5" y="1023.7266"/><rect fill="#DCDCDC" height="167.9453" style="stroke:#000000;stroke-width:1.0;" width="10" x="621.5" y="1842.8438"/><rect fill="#DCDCDC" height="182.9453" style="stroke:#000000;stroke-width:1.0;" width="10" x="861.5" y="614.0469"/><rect fill="#DCDCDC" height="561.5938" style="stroke:#000000;stroke-width:1.0;" width="10" x="861.5" y="1057.5156"/><rect fill="#DCDCDC" height="100.3672" style="stroke:#000000;stroke-width:1.0;" width="10" x="861.5" y="1876.6328"/><rect fill="#DCDCDC" height="481.8516" style="stroke:#000000;stroke-width:1.0;" width="10" x="1091.5" y="2069.5781"/><polygon fill="#000000" points="361.5,168.3516,371.5,172.3516,361.5,176.3516,365.5,172.3516" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="126.5" x2="367.5" y1="172.3516" y2="172.3516"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="228" x="133.5" y="166.3423">Eingabe Messenger-Service</text><polygon fill="#000000" points="609.5,202.1406,619.5,206.1406,609.5,210.1406,613.5,206.1406" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="383.5" x2="615.5" y1="206.1406" y2="206.1406"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="209" x="390.5" y="200.1313">GET /_matrix/client/login</text><line style="stroke:#000000;stroke-width:1.0;" x1="631.5" x2="673.5" y1="239.9297" y2="239.9297"/><line style="stroke:#000000;stroke-width:1.0;" x1="673.5" x2="673.5" y1="239.9297" y2="252.9297"/><line style="stroke:#000000;stroke-width:1.0;" x1="632.5" x2="673.5" y1="252.9297" y2="252.9297"/><polygon fill="#000000" points="642.5,248.9297,632.5,252.9297,642.5,256.9297,638.5,252.9297" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="150" x="638.5" y="233.9204">TLS-Terminierung</text><line style="stroke:#000000;stroke-width:1.0;" x1="631.5" x2="673.5" y1="331.5078" y2="331.5078"/><line style="stroke:#000000;stroke-width:1.0;" x1="673.5" x2="673.5" y1="331.5078" y2="344.5078"/><line style="stroke:#000000;stroke-width:1.0;" x1="632.5" x2="673.5" y1="344.5078" y2="344.5078"/><polygon fill="#000000" points="642.5,340.5078,632.5,344.5078,642.5,348.5078,638.5,344.5078" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="156" x="638.5" y="305.7095">prüfe client_id und</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="105" x="638.5" y="325.4985">client_secret</text><path d="M10,384.5078 L74,384.5078 L74,391.6406 L64,401.6406 L10,401.6406 L10,384.5078 " fill="#D3D3D3" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="2285.5" style="stroke:#000000;stroke-width:1.5;" width="1241.5" x="10" y="384.5078"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="25" y="397.5747">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="89" y="402.5386">[</text><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="760" x="94" y="401.3594">TI-Messenger Client wird vom Anbieter nicht unterstützt (kein gültiges client_secret)</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="854" y="402.5386">]</text><polygon fill="#000000" points="394.5,452.0547,384.5,456.0547,394.5,460.0547,390.5,456.0547" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="388.5" x2="620.5" y1="456.0547" y2="456.0547"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="199" x="415.5" y="450.0454">HTTP 401 Unauthroized</text><polygon fill="#000000" points="137.5,505.6328,127.5,509.6328,137.5,513.6328,133.5,509.6328" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="131.5" x2="372.5" y1="509.6328" y2="509.6328"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="96" x="230.5" y="483.8345">Anmeldung</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="136" x="230.5" y="503.6235">nicht erfolgreich</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="10" x2="1251.5" y1="543.6328" y2="543.6328"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="15" y="559.6636">[</text><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="673" x="20" y="558.4844">TI-Messenger Client wird vom Anbieter unterstützt  (gültiges client_secret)</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="693" y="559.6636">]</text><polygon fill="#000000" points="849.5,610.0469,859.5,614.0469,849.5,618.0469,853.5,614.0469" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="631.5" x2="855.5" y1="614.0469" y2="614.0469"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="142" x="638.5" y="608.0376">HTTP(S) Forward</text><path d="M27,652.0469 L27,701.0469 L965,701.0469 L965,662.0469 L955,652.0469 L27,652.0469 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M955,652.0469 L955,662.0469 L965,662.0469 L955,652.0469 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="417" x="272.75" y="672.8267">Die Authentifizierungsverfahren werden für jeden</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="438" x="272.75" y="692.6157">Messenger-Service durch die Organisation festgelegt</text><polygon fill="#000000" points="642.5,792.9922,632.5,796.9922,642.5,800.9922,638.5,796.9922" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="636.5" x2="865.5" y1="796.9922" y2="796.9922"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="104" x="699.5" y="751.4048">unterstützte</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="160" x="699.5" y="771.1938">Authentifizierungs-</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="82" x="699.5" y="790.9829">verfahren</text><polygon fill="#000000" points="394.5,826.7813,384.5,830.7813,394.5,834.7813,390.5,830.7813" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="388.5" x2="625.5" y1="830.7813" y2="830.7813"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="142" x="477.5" y="824.772">HTTP(S) Forward</text><polygon fill="#000000" points="137.5,880.3594,127.5,884.3594,137.5,888.3594,133.5,884.3594" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="131.5" x2="372.5" y1="884.3594" y2="884.3594"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="47" x="157.5" y="858.561">Zeige</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="209" x="157.5" y="878.3501">Authentifizierungsmaske</text><line style="stroke:#000000;stroke-width:1.0;" x1="126.5" x2="168.5" y1="943.1484" y2="943.1484"/><line style="stroke:#000000;stroke-width:1.0;" x1="168.5" x2="168.5" y1="943.1484" y2="956.1484"/><line style="stroke:#000000;stroke-width:1.0;" x1="127.5" x2="168.5" y1="956.1484" y2="956.1484"/><polygon fill="#000000" points="137.5,952.1484,127.5,956.1484,137.5,960.1484,133.5,956.1484" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="203" x="133.5" y="937.1392">Starte Authentifizierung</text><polygon fill="#000000" points="361.5,985.9375,371.5,989.9375,361.5,993.9375,365.5,989.9375" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="126.5" x2="367.5" y1="989.9375" y2="989.9375"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="96" x="133.5" y="983.9282">Anmeldung</text><polygon fill="#000000" points="609.5,1019.7266,619.5,1023.7266,609.5,1027.7266,613.5,1023.7266" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="383.5" x2="615.5" y1="1023.7266" y2="1023.7266"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="219" x="390.5" y="1017.7173">POST /_matrix/client/login</text><polygon fill="#000000" points="849.5,1053.5156,859.5,1057.5156,849.5,1061.5156,853.5,1057.5156" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="631.5" x2="855.5" y1="1057.5156" y2="1057.5156"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="142" x="638.5" y="1051.5063">HTTP(S) Forward</text><line style="stroke:#000000;stroke-width:1.0;" x1="871.5" x2="913.5" y1="1111.0938" y2="1111.0938"/><line style="stroke:#000000;stroke-width:1.0;" x1="913.5" x2="913.5" y1="1111.0938" y2="1124.0938"/><line style="stroke:#000000;stroke-width:1.0;" x1="872.5" x2="913.5" y1="1124.0938" y2="1124.0938"/><polygon fill="#000000" points="882.5,1120.0938,872.5,1124.0938,882.5,1128.0938,878.5,1124.0938" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="44" x="878.5" y="1085.2954">prüfe</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="151" x="878.5" y="1105.0845">Client-Credentials</text><path d="M20,1164.0938 L90,1164.0938 L90,1171.2266 L80,1181.2266 L20,1181.2266 L20,1164.0938 " fill="#D3D3D3" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="186.7031" style="stroke:#000000;stroke-width:1.5;" width="963.5" x="20" y="1164.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="25" x="35" y="1177.1606">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="105" y="1182.1245">[</text><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="74" x="110" y="1180.9453">Abbruch</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="184" y="1182.1245">]</text><polygon fill="#000000" points="642.5,1226.4297,632.5,1230.4297,642.5,1234.4297,638.5,1230.4297" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="636.5" x2="860.5" y1="1230.4297" y2="1230.4297"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="97" x="732.5" y="1204.6313">Fehlerhafte</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="122" x="732.5" y="1224.4204">Anmeldedaten</text><polygon fill="#000000" points="394.5,1260.2188,384.5,1264.2188,394.5,1268.2188,390.5,1264.2188" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="388.5" x2="620.5" y1="1264.2188" y2="1264.2188"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="142" x="472.5" y="1258.2095">HTTP(S) Forward</text><polygon fill="#000000" points="137.5,1313.7969,127.5,1317.7969,137.5,1321.7969,133.5,1317.7969" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="131.5" x2="372.5" y1="1317.7969" y2="1317.7969"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="122" x="219.5" y="1291.9985">Anmeldedaten</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="147" x="219.5" y="1311.7876">sind nicht korrekt</text><path d="M691,1387.7969 L691,1436.7969 L1042,1436.7969 L1042,1397.7969 L1032,1387.7969 L691,1387.7969 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1032,1387.7969 L1032,1397.7969 L1042,1397.7969 L1032,1387.7969 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="288" x="697" y="1408.5767">Die Überprüfung ist abhängig vom</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="330" x="697" y="1428.3657">gewählten Authentifizierungsverfahren</text><line style="stroke:#000000;stroke-width:1.0;" x1="871.5" x2="913.5" y1="1552.5313" y2="1552.5313"/><line style="stroke:#000000;stroke-width:1.0;" x1="913.5" x2="913.5" y1="1552.5313" y2="1565.5313"/><line style="stroke:#000000;stroke-width:1.0;" x1="872.5" x2="913.5" y1="1565.5313" y2="1565.5313"/><polygon fill="#000000" points="882.5,1561.5313,872.5,1565.5313,882.5,1569.5313,878.5,1565.5313" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="62" x="878.5" y="1487.1548">erstelle</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="201" x="878.5" y="1506.9438">Matrix-ACCESS_TOKEN,</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="82" x="878.5" y="1526.7329">device_id,</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="47" x="878.5" y="1546.522">MXID</text><polygon fill="#000000" points="642.5,1615.1094,632.5,1619.1094,642.5,1623.1094,638.5,1619.1094" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="636.5" x2="865.5" y1="1619.1094" y2="1619.1094"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="201" x="653.5" y="1593.311">Matrix-ACCESS_TOKEN,</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="138" x="653.5" y="1613.1001">device_ID, MXID</text><polygon fill="#000000" points="394.5,1648.8984,384.5,1652.8984,394.5,1656.8984,390.5,1652.8984" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="388.5" x2="625.5" y1="1652.8984" y2="1652.8984"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="142" x="477.5" y="1646.8892">HTTP(S) Forward</text><line style="stroke:#000000;stroke-width:1.0;" x1="383.5" x2="425.5" y1="1731.4766" y2="1731.4766"/><line style="stroke:#000000;stroke-width:1.0;" x1="425.5" x2="425.5" y1="1731.4766" y2="1744.4766"/><line style="stroke:#000000;stroke-width:1.0;" x1="384.5" x2="425.5" y1="1744.4766" y2="1744.4766"/><polygon fill="#000000" points="394.5,1740.4766,384.5,1744.4766,394.5,1748.4766,390.5,1744.4766" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="82" x="390.5" y="1705.6782">Speichere</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="196" x="390.5" y="1725.4673">Matrix-ACCESS_TOKEN</text><polygon fill="#000000" points="609.5,1838.8438,619.5,1842.8438,609.5,1846.8438,613.5,1842.8438" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="383.5" x2="615.5" y1="1842.8438" y2="1842.8438"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="172" x="390.5" y="1797.2563">POST /_matrix/client</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="128" x="390.5" y="1817.0454">/user/{userId}/</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="182" x="390.5" y="1836.8345">openid/request_token</text><polygon fill="#000000" points="849.5,1872.6328,859.5,1876.6328,849.5,1880.6328,853.5,1876.6328" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="631.5" x2="855.5" y1="1876.6328" y2="1876.6328"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="142" x="638.5" y="1870.6235">HTTP(S) Forward</text><line style="stroke:#000000;stroke-width:1.0;" x1="871.5" x2="913.5" y1="1930.2109" y2="1930.2109"/><line style="stroke:#000000;stroke-width:1.0;" x1="913.5" x2="913.5" y1="1930.2109" y2="1943.2109"/><line style="stroke:#000000;stroke-width:1.0;" x1="872.5" x2="913.5" y1="1943.2109" y2="1943.2109"/><polygon fill="#000000" points="882.5,1939.2109,872.5,1943.2109,882.5,1947.2109,878.5,1943.2109" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="63" x="878.5" y="1904.4126">Erstelle</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="180" x="878.5" y="1924.2017">Matrix-OpenID-Token</text><polygon fill="#000000" points="642.5,1973,632.5,1977,642.5,1981,638.5,1977" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="636.5" x2="865.5" y1="1977" y2="1977"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="180" x="679.5" y="1970.9907">Matrix-OpenID-Token</text><polygon fill="#000000" points="394.5,2006.7891,384.5,2010.7891,394.5,2014.7891,390.5,2010.7891" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="388.5" x2="625.5" y1="2010.7891" y2="2010.7891"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="142" x="477.5" y="2004.7798">HTTP(S) Forward</text><polygon fill="#000000" points="1079.5,2065.5781,1089.5,2069.5781,1079.5,2073.5781,1083.5,2069.5781" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="383.5" x2="1085.5" y1="2069.5781" y2="2069.5781"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="386" x="390.5" y="2063.5688">GET /tim-authenticate (Matrix-OpenID-Token)</text><line style="stroke:#000000;stroke-width:1.0;" x1="1101.5" x2="1143.5" y1="2162.7344" y2="2162.7344"/><line style="stroke:#000000;stroke-width:1.0;" x1="1143.5" x2="1143.5" y1="2162.7344" y2="2175.7344"/><line style="stroke:#000000;stroke-width:1.0;" x1="1102.5" x2="1143.5" y1="2175.7344" y2="2175.7344"/><polygon fill="#000000" points="1112.5,2171.7344,1102.5,2175.7344,1112.5,2179.7344,1108.5,2175.7344" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="96" x="1108.5" y="2097.3579">Prüfung, ob</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="126" x="1108.5" y="2117.147">Matrix-Domain</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="111" x="1108.5" y="2136.936">in Föderation</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="107" x="1108.5" y="2156.7251">enthalten ist</text><path d="M20,2215.7344 L84,2215.7344 L84,2222.8672 L74,2232.8672 L20,2232.8672 L20,2215.7344 " fill="#D3D3D3" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="422.2734" style="stroke:#000000;stroke-width:1.5;" width="1193.5" x="20" y="2215.7344"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="35" y="2228.8013">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="99" y="2233.7651">[</text><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="832" x="104" y="2232.5859">nicht valider Messenger-Service, da Matrix-Homeserver nicht in der Föderations enthalten ist</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="936" y="2233.7651">]</text><polygon fill="#000000" points="394.5,2303.0703,384.5,2307.0703,394.5,2311.0703,390.5,2307.0703" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="388.5" x2="1090.5" y1="2307.0703" y2="2307.0703"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="81" x="971.5" y="2281.272">HTTP 401</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="113" x="971.5" y="2301.061">Unauthorized</text><line style="stroke:#000000;stroke-width:1.0;" x1="383.5" x2="425.5" y1="2380.4375" y2="2380.4375"/><line style="stroke:#000000;stroke-width:1.0;" x1="425.5" x2="425.5" y1="2380.4375" y2="2393.4375"/><line style="stroke:#000000;stroke-width:1.0;" x1="384.5" x2="425.5" y1="2393.4375" y2="2393.4375"/><polygon fill="#000000" points="394.5,2389.4375,384.5,2393.4375,394.5,2397.4375,390.5,2393.4375" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="152" x="390.5" y="2334.8501">Abmelden Session</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="196" x="390.5" y="2354.6392">Matrix-ACCESS_TOKEN</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="63" x="390.5" y="2374.4282">löschen</text><polygon fill="#000000" points="137.5,2443.0156,127.5,2447.0156,137.5,2451.0156,133.5,2447.0156" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="131.5" x2="372.5" y1="2447.0156" y2="2447.0156"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="96" x="230.5" y="2421.2173">Anmeldung</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="136" x="230.5" y="2441.0063">nicht erfolgreich</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="20" x2="1213.5" y1="2481.0156" y2="2481.0156"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="25" y="2497.0464">[</text><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="722" x="30" y="2495.8672">valider Messenger-Service, da Matrix-Homeserver in der Föderation enthalten ist</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="752" y="2497.0464">]</text><polygon fill="#000000" points="394.5,2547.4297,384.5,2551.4297,394.5,2555.4297,390.5,2551.4297" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="388.5" x2="1095.5" y1="2551.4297" y2="2551.4297"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="81" x="1008.5" y="2545.4204">HTTP 200</text><polygon fill="#000000" points="137.5,2601.0078,127.5,2605.0078,137.5,2609.0078,133.5,2605.0078" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="131.5" x2="377.5" y1="2605.0078" y2="2605.0078"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="96" x="270.5" y="2579.2095">Anmeldung</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="89" x="270.5" y="2598.9985">erfolgreich</text><!--MD5=[a70ef3fce43db7252a12e1391d1efb68]
@startuml
skinparam sequenceMessageAlign direction
skinparam minClassWidth 200
skinparam BoxPadding 1
skinparam sequenceReferenceHeaderBackgroundColor palegreen
scale max 2048 width

skinparam sequence {
ArrowColor black
ArrowFontSize 17
ActorBorderColor black
LifeLineBorderColor black
LifeLineBackgroundColor Gainsboro

ParticipantBorderColor Motivation
ParticipantBackgroundColor Motivation
ParticipantFontName Impact
ParticipantFontSize 20
ParticipantFontColor black
ParticipantBorderColor Black
ParticipantBackgroundColor MOTIVATION

ActorBackgroundColor Gainsboro
ActorFontColor black
ActorFontSize 20
ActorFontName Aapex
}
    actor U as "Akteur in der Rolle\nUser / User-HBA"
    participant C as "TI-Messenger-Client"
    box <size:18>Messenger-Service</size> #WhiteSmoke
      participant MP as "Messenger Proxy"
      participant MH as "Matrix-Homeserver"
    end box
    box <size:18>VZD-FHIR-Directory</size> #WhiteSmoke
      participant Auth as "Auth-Service"
    end box

|||
  U->C: Eingabe Messenger-Service 
    Activate C
  C->MP: GET /_matrix/client/login
    Activate MP
  MP->MP: TLS-Terminierung
  |||
  MP->MP: prüfe client_id und \nclient_secret

|||
alt#LightGrey #AliceBlue <size:16>TI-Messenger Client wird vom Anbieter nicht unterstützt (kein gültiges client_secret)</size>
|||  

  MP- ->C: HTTP 401 Unauthroized
  C- ->U: Anmeldung \nnicht erfolgreich
  
    |||  
    else <size:16>TI-Messenger Client wird vom Anbieter unterstützt  (gültiges client_secret)</size>
    |||

  MP->MH: HTTP(S) Forward
   Activate MH

|||
note over U, MH: <size:17>Die Authentifizierungsverfahren werden für jeden \n<size:17>Messenger-Service durch die Organisation festgelegt</size>
|||

  MH- ->MP: unterstützte \nAuthentifizierungs-\nverfahren
    Deactivate MH
  MP- ->C: HTTP(S) Forward
    Deactivate MP
  C- ->U: Zeige \nAuthentifizierungsmaske
  |||
  U->U: Starte Authentifizierung
  U->C: Anmeldung
  C->MP: POST /_matrix/client/login
    Activate MP

    
    MP->MH: HTTP(S) Forward
      Activate MH
    MH->MH: prüfe \nClient-Credentials
    |||
    opt#LightGrey #MistyRose <size:16>Abbruch</size>
      MH- ->MP:Fehlerhafte \nAnmeldedaten 
      MP- ->C: HTTP(S) Forward
      C- ->U: Anmeldedaten \nsind nicht korrekt
      |||
    end
    |||
    
    note over MH, MH: <size:17>Die Überprüfung ist abhängig vom \n<size:17>gewählten Authentifizierungsverfahren</size>
    
    |||
    MH->MH: erstelle \nMatrix-ACCESS_TOKEN, \ndevice_id, \nMXID
    MH- ->MP: Matrix-ACCESS_TOKEN, \ndevice_ID, MXID
      Deactivate MH
    MP- ->C: HTTP(S) Forward
      Deactivate MP
    |||
    C->C: Speichere \nMatrix-ACCESS_TOKEN
    
    |||
    C->MP: POST /_matrix/client\n/user/{userId}/\nopenid/request_token
      Activate MP
    MP->MH: HTTP(S) Forward
      Activate MH
    MH->MH: Erstelle \nMatrix-OpenID-Token
    MH- ->MP: Matrix-OpenID-Token
      Deactivate MH
    MP- ->C: HTTP(S) Forward
      Deactivate MP
    
    |||
    C->Auth: GET /tim-authenticate (Matrix-OpenID-Token)
      Activate Auth
    Auth->Auth: Prüfung, ob \nMatrix-Domain \nin Föderation \nenthalten ist

      |||
      alt#LightGrey #LightBlue <size:16>nicht valider Messenger-Service, da Matrix-Homeserver nicht in der Föderations enthalten ist</size>
      |||  

        Auth- ->C: HTTP 401 \nUnauthorized 
        C->C: Abmelden Session \nMatrix-ACCESS_TOKEN \nlöschen
        C- ->U: Anmeldung \nnicht erfolgreich
        
        |||
        else <size:16>valider Messenger-Service, da Matrix-Homeserver in der Föderation enthalten ist</size>
          |||
          Auth- ->C: HTTP 200
            Deactivate Auth
          C- ->U: Anmeldung \nerfolgreich
            Deactivate C
          |||

      end  
      |||
end
|||

@enduml

PlantUML version 1.2022.5(Sat Apr 30 10:55:52 UTC 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>